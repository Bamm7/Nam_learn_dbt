[0m23:03:46.742085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E920922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E928BF580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E945A1D00>]}


============================== 23:03:46.752085 | 1fec1599-65d6-43c0-894e-426370f66e89 ==============================
[0m23:03:46.752085 [info ] [MainThread]: Running with dbt=1.7.18
[0m23:03:46.754061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:03:46.755050 [info ] [MainThread]: dbt version: 1.7.18
[0m23:03:46.756056 [info ] [MainThread]: python version: 3.9.13
[0m23:03:46.757064 [info ] [MainThread]: python path: E:\ChuyenMon\Nam_learn_dbt\venv\dbt-env\Scripts\python.exe
[0m23:03:46.757064 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m23:03:46.991048 [info ] [MainThread]: Using profiles dir at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres
[0m23:03:46.992050 [info ] [MainThread]: Using profiles.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\profiles.yml
[0m23:03:46.992050 [info ] [MainThread]: Using dbt_project.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\dbt_project.yml
[0m23:03:46.998050 [info ] [MainThread]: adapter type: postgres
[0m23:03:46.999060 [info ] [MainThread]: adapter version: 1.7.18
[0m23:03:47.095049 [info ] [MainThread]: Configuration:
[0m23:03:47.096049 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:03:47.096655 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:03:47.097669 [info ] [MainThread]: Required dependencies:
[0m23:03:47.097669 [debug] [MainThread]: Executing "git --help"
[0m23:03:47.143675 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:03:47.144700 [debug] [MainThread]: STDERR: "b''"
[0m23:03:47.145673 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:03:47.145673 [info ] [MainThread]: Connection:
[0m23:03:47.146663 [info ] [MainThread]:   host: postgres
[0m23:03:47.146663 [info ] [MainThread]:   port: 5432
[0m23:03:47.147671 [info ] [MainThread]:   user: nam
[0m23:03:47.148663 [info ] [MainThread]:   database: Cafe_rewards_offers
[0m23:03:47.149665 [info ] [MainThread]:   schema: Cafe_rewards_offers
[0m23:03:47.150664 [info ] [MainThread]:   connect_timeout: 10
[0m23:03:47.150664 [info ] [MainThread]:   role: None
[0m23:03:47.151662 [info ] [MainThread]:   search_path: None
[0m23:03:47.152668 [info ] [MainThread]:   keepalives_idle: 0
[0m23:03:47.152668 [info ] [MainThread]:   sslmode: None
[0m23:03:47.153663 [info ] [MainThread]:   sslcert: None
[0m23:03:47.154663 [info ] [MainThread]:   sslkey: None
[0m23:03:47.155663 [info ] [MainThread]:   sslrootcert: None
[0m23:03:47.156662 [info ] [MainThread]:   application_name: dbt
[0m23:03:47.157662 [info ] [MainThread]:   retries: 1
[0m23:03:47.158662 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m23:03:47.160663 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:03:47.161662 [debug] [MainThread]: Using postgres connection "debug"
[0m23:03:47.161662 [debug] [MainThread]: On debug: select 1 as id
[0m23:03:47.162667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:49.459340 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: No such host is known. 

[0m23:03:51.745724 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m23:03:51.748691 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m23:03:51.749987 [debug] [MainThread]: On debug: No close available on handle
[0m23:03:51.750929 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m23:03:51.751921 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:03:51.752938 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: No such host is known. 
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m23:03:51.753928 [debug] [MainThread]: Command `dbt debug` failed at 23:03:51.753928 after 5.11 seconds
[0m23:03:51.754938 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:03:51.754938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E920922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E94789130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9458F640>]}
[0m23:03:51.755950 [debug] [MainThread]: Flushing usage events
[0m23:04:59.561879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6AFFDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6C0505B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6D922BB0>]}


============================== 23:04:59.564879 | df9b05ee-12ca-46e0-8dca-f8148abc2a54 ==============================
[0m23:04:59.564879 [info ] [MainThread]: Running with dbt=1.7.18
[0m23:04:59.565879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:59.566880 [info ] [MainThread]: dbt version: 1.7.18
[0m23:04:59.567909 [info ] [MainThread]: python version: 3.9.13
[0m23:04:59.568881 [info ] [MainThread]: python path: E:\ChuyenMon\Nam_learn_dbt\venv\dbt-env\Scripts\python.exe
[0m23:04:59.569910 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m23:04:59.631917 [info ] [MainThread]: Using profiles dir at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres
[0m23:04:59.632889 [info ] [MainThread]: Using profiles.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\profiles.yml
[0m23:04:59.633887 [info ] [MainThread]: Using dbt_project.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\dbt_project.yml
[0m23:04:59.634880 [info ] [MainThread]: adapter type: postgres
[0m23:04:59.635888 [info ] [MainThread]: adapter version: 1.7.18
[0m23:04:59.720908 [info ] [MainThread]: Configuration:
[0m23:04:59.722879 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:04:59.723890 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:04:59.724384 [info ] [MainThread]: Required dependencies:
[0m23:04:59.725398 [debug] [MainThread]: Executing "git --help"
[0m23:04:59.766340 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:04:59.767379 [debug] [MainThread]: STDERR: "b''"
[0m23:04:59.768349 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:04:59.769355 [info ] [MainThread]: Connection:
[0m23:04:59.770341 [info ] [MainThread]:   host: localhost
[0m23:04:59.771108 [info ] [MainThread]:   port: 5432
[0m23:04:59.772116 [info ] [MainThread]:   user: postgres
[0m23:04:59.772116 [info ] [MainThread]:   database: Cafe_rewards_offers
[0m23:04:59.773128 [info ] [MainThread]:   schema: Cafe_rewards_offers
[0m23:04:59.774117 [info ] [MainThread]:   connect_timeout: 10
[0m23:04:59.775116 [info ] [MainThread]:   role: None
[0m23:04:59.776118 [info ] [MainThread]:   search_path: None
[0m23:04:59.777117 [info ] [MainThread]:   keepalives_idle: 0
[0m23:04:59.778116 [info ] [MainThread]:   sslmode: None
[0m23:04:59.778116 [info ] [MainThread]:   sslcert: None
[0m23:04:59.779115 [info ] [MainThread]:   sslkey: None
[0m23:04:59.780115 [info ] [MainThread]:   sslrootcert: None
[0m23:04:59.780115 [info ] [MainThread]:   application_name: dbt
[0m23:04:59.781350 [info ] [MainThread]:   retries: 1
[0m23:04:59.782359 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m23:04:59.782359 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:04:59.783395 [debug] [MainThread]: Using postgres connection "debug"
[0m23:04:59.784375 [debug] [MainThread]: On debug: select 1 as id
[0m23:04:59.784375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:59.826366 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:04:59.827363 [debug] [MainThread]: On debug: Close
[0m23:04:59.828357 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:04:59.829360 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:04:59.831359 [debug] [MainThread]: Command `dbt debug` succeeded at 23:04:59.831359 after 0.35 seconds
[0m23:04:59.832359 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:04:59.832359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6AFFDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6D922A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6DABB9A0>]}
[0m23:04:59.833357 [debug] [MainThread]: Flushing usage events
[0m23:06:04.390117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564A6922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564AEBD580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564CBA2BB0>]}


============================== 23:06:04.394081 | 32d4b973-a1f3-4c13-a9dc-de6f21f688c5 ==============================
[0m23:06:04.394081 [info ] [MainThread]: Running with dbt=1.7.18
[0m23:06:04.395082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:06:04.395082 [info ] [MainThread]: dbt version: 1.7.18
[0m23:06:04.396082 [info ] [MainThread]: python version: 3.9.13
[0m23:06:04.397092 [info ] [MainThread]: python path: E:\ChuyenMon\Nam_learn_dbt\venv\dbt-env\Scripts\python.exe
[0m23:06:04.398094 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m23:06:04.460117 [info ] [MainThread]: Using profiles dir at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres
[0m23:06:04.461116 [info ] [MainThread]: Using profiles.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\profiles.yml
[0m23:06:04.462081 [info ] [MainThread]: Using dbt_project.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\dbt_project.yml
[0m23:06:04.463081 [info ] [MainThread]: adapter type: postgres
[0m23:06:04.464080 [info ] [MainThread]: adapter version: 1.7.18
[0m23:06:04.555081 [info ] [MainThread]: Configuration:
[0m23:06:04.556089 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:06:04.557089 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:06:04.558089 [info ] [MainThread]: Required dependencies:
[0m23:06:04.559102 [debug] [MainThread]: Executing "git --help"
[0m23:06:04.602397 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:06:04.604390 [debug] [MainThread]: STDERR: "b''"
[0m23:06:04.604390 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:06:04.605398 [info ] [MainThread]: Connection:
[0m23:06:04.607396 [info ] [MainThread]:   host: localhost
[0m23:06:04.607396 [info ] [MainThread]:   port: 5432
[0m23:06:04.608405 [info ] [MainThread]:   user: postgres
[0m23:06:04.609389 [info ] [MainThread]:   database: Cafe_rewards_offers
[0m23:06:04.610390 [info ] [MainThread]:   schema: Cafe_rewards_offers
[0m23:06:04.610390 [info ] [MainThread]:   connect_timeout: 10
[0m23:06:04.611389 [info ] [MainThread]:   role: None
[0m23:06:04.612390 [info ] [MainThread]:   search_path: None
[0m23:06:04.612390 [info ] [MainThread]:   keepalives_idle: 0
[0m23:06:04.613390 [info ] [MainThread]:   sslmode: None
[0m23:06:04.614397 [info ] [MainThread]:   sslcert: None
[0m23:06:04.615389 [info ] [MainThread]:   sslkey: None
[0m23:06:04.615389 [info ] [MainThread]:   sslrootcert: None
[0m23:06:04.616427 [info ] [MainThread]:   application_name: dbt
[0m23:06:04.617389 [info ] [MainThread]:   retries: 1
[0m23:06:04.617389 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m23:06:04.618390 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:06:04.619429 [debug] [MainThread]: Using postgres connection "debug"
[0m23:06:04.620390 [debug] [MainThread]: On debug: select 1 as id
[0m23:06:04.621392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:04.665396 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:06:04.667427 [debug] [MainThread]: On debug: Close
[0m23:06:04.667427 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:06:04.668397 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:06:04.671420 [debug] [MainThread]: Command `dbt debug` succeeded at 23:06:04.671420 after 0.36 seconds
[0m23:06:04.672391 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:06:04.672391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564A6922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564CBA2A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564CD3B9A0>]}
[0m23:06:04.673396 [debug] [MainThread]: Flushing usage events
[0m23:06:14.826496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002792161FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027923B37910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027923B37400>]}


============================== 23:06:14.830481 | 4c426de6-c72a-45c1-b541-affcdcd0e83f ==============================
[0m23:06:14.830481 [info ] [MainThread]: Running with dbt=1.7.18
[0m23:06:14.831491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:06:14.832483 [info ] [MainThread]: dbt version: 1.7.18
[0m23:06:14.833482 [info ] [MainThread]: python version: 3.9.13
[0m23:06:14.833482 [info ] [MainThread]: python path: E:\ChuyenMon\Nam_learn_dbt\venv\dbt-env\Scripts\python.exe
[0m23:06:14.834490 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m23:06:14.897520 [info ] [MainThread]: Using profiles dir at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres
[0m23:06:14.899482 [info ] [MainThread]: Using profiles.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\profiles.yml
[0m23:06:14.899482 [info ] [MainThread]: Using dbt_project.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\dbt_project.yml
[0m23:06:14.901482 [info ] [MainThread]: adapter type: postgres
[0m23:06:14.902490 [info ] [MainThread]: adapter version: 1.7.18
[0m23:06:14.992482 [info ] [MainThread]: Configuration:
[0m23:06:14.994483 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:06:14.995481 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:06:14.995481 [info ] [MainThread]: Required dependencies:
[0m23:06:14.996482 [debug] [MainThread]: Executing "git --help"
[0m23:06:15.040490 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:06:15.041482 [debug] [MainThread]: STDERR: "b''"
[0m23:06:15.042483 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:06:15.043523 [info ] [MainThread]: Connection:
[0m23:06:15.044482 [info ] [MainThread]:   host: localhost
[0m23:06:15.045482 [info ] [MainThread]:   port: 5432
[0m23:06:15.045482 [info ] [MainThread]:   user: postgres
[0m23:06:15.046519 [info ] [MainThread]:   database: Cafe_rewards_offers
[0m23:06:15.047481 [info ] [MainThread]:   schema: Cafe_rewards_offers
[0m23:06:15.048501 [info ] [MainThread]:   connect_timeout: 10
[0m23:06:15.048501 [info ] [MainThread]:   role: None
[0m23:06:15.049483 [info ] [MainThread]:   search_path: None
[0m23:06:15.050488 [info ] [MainThread]:   keepalives_idle: 0
[0m23:06:15.050488 [info ] [MainThread]:   sslmode: None
[0m23:06:15.051513 [info ] [MainThread]:   sslcert: None
[0m23:06:15.052481 [info ] [MainThread]:   sslkey: None
[0m23:06:15.052481 [info ] [MainThread]:   sslrootcert: None
[0m23:06:15.053511 [info ] [MainThread]:   application_name: dbt
[0m23:06:15.055485 [info ] [MainThread]:   retries: 1
[0m23:06:15.056484 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m23:06:15.057483 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:06:15.058484 [debug] [MainThread]: Using postgres connection "debug"
[0m23:06:15.059488 [debug] [MainThread]: On debug: select 1 as id
[0m23:06:15.059488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:15.105485 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:06:15.106483 [debug] [MainThread]: On debug: Close
[0m23:06:15.107482 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:06:15.108484 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:06:15.110483 [debug] [MainThread]: Command `dbt debug` succeeded at 23:06:15.110483 after 0.36 seconds
[0m23:06:15.111482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:06:15.111482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002792161FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027923CC7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027923C68790>]}
[0m23:06:15.112482 [debug] [MainThread]: Flushing usage events
[0m14:13:26.314921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B2192D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B4AC4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B4AB7940>]}


============================== 14:13:26.329922 | 3a9249b2-503f-407f-9cd5-0f05eb8cc4ad ==============================
[0m14:13:26.329922 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:13:26.330924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:26.331924 [info ] [MainThread]: dbt version: 1.7.18
[0m14:13:26.332922 [info ] [MainThread]: python version: 3.9.13
[0m14:13:26.334923 [info ] [MainThread]: python path: E:\ChuyenMon\Nam_learn_dbt\venv\dbt-env\Scripts\python.exe
[0m14:13:26.335923 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:13:26.571921 [info ] [MainThread]: Using profiles dir at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres
[0m14:13:26.572929 [info ] [MainThread]: Using profiles.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\profiles.yml
[0m14:13:26.573929 [info ] [MainThread]: Using dbt_project.yml file at E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\dbt_project.yml
[0m14:13:26.579960 [info ] [MainThread]: adapter type: postgres
[0m14:13:26.580922 [info ] [MainThread]: adapter version: 1.7.18
[0m14:13:26.673966 [info ] [MainThread]: Configuration:
[0m14:13:26.674965 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:13:26.675965 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:13:26.677003 [info ] [MainThread]: Required dependencies:
[0m14:13:26.677965 [debug] [MainThread]: Executing "git --help"
[0m14:13:26.718972 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:13:26.719965 [debug] [MainThread]: STDERR: "b''"
[0m14:13:26.720967 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:13:26.721970 [info ] [MainThread]: Connection:
[0m14:13:26.722983 [info ] [MainThread]:   host: localhost
[0m14:13:26.723966 [info ] [MainThread]:   port: 5432
[0m14:13:26.724966 [info ] [MainThread]:   user: postgres
[0m14:13:26.724966 [info ] [MainThread]:   database: Cafe_rewards_offers
[0m14:13:26.725966 [info ] [MainThread]:   schema: Cafe_rewards_offers
[0m14:13:26.725966 [info ] [MainThread]:   connect_timeout: 10
[0m14:13:26.726965 [info ] [MainThread]:   role: None
[0m14:13:26.727965 [info ] [MainThread]:   search_path: None
[0m14:13:26.727965 [info ] [MainThread]:   keepalives_idle: 0
[0m14:13:26.728966 [info ] [MainThread]:   sslmode: None
[0m14:13:26.729965 [info ] [MainThread]:   sslcert: None
[0m14:13:26.729965 [info ] [MainThread]:   sslkey: None
[0m14:13:26.730965 [info ] [MainThread]:   sslrootcert: None
[0m14:13:26.731965 [info ] [MainThread]:   application_name: dbt
[0m14:13:26.732969 [info ] [MainThread]:   retries: 1
[0m14:13:26.733968 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:13:26.736966 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:13:26.737966 [debug] [MainThread]: Using postgres connection "debug"
[0m14:13:26.738973 [debug] [MainThread]: On debug: select 1 as id
[0m14:13:26.738973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:26.781965 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:13:26.782965 [debug] [MainThread]: On debug: Close
[0m14:13:26.783965 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:13:26.785968 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:13:26.786966 [debug] [MainThread]: Command `dbt debug` succeeded at 14:13:26.786966 after 0.56 seconds
[0m14:13:26.787965 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:13:26.788965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B2192D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B4AB7D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B4C85A60>]}
[0m14:13:26.788965 [debug] [MainThread]: Flushing usage events
[0m14:16:53.968562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC173723A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC19CA5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC19CA5310>]}


============================== 14:16:53.971561 | 93b4c281-b566-496e-8c7a-ecb46d9dacde ==============================
[0m14:16:53.971561 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:16:53.972574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:54.165035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC19CC8820>]}
[0m14:16:54.235034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC19CC34F0>]}
[0m14:16:54.235997 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:16:54.253033 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:16:54.254034 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:16:54.255004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC19ED2A30>]}
[0m14:16:56.128701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC1A5640D0>]}
[0m14:16:56.150673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC1A279790>]}
[0m14:16:56.151665 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:16:56.152667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC1A4C88B0>]}
[0m14:16:56.154664 [info ] [MainThread]: 
[0m14:16:56.155664 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:56.157665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:16:56.168701 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:16:56.168701 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:16:56.169704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:56.325954 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:16:56.327955 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:16:56.329953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers, now create_Cafe_rewards_offers_Cafe_rewards_offers)
[0m14:16:56.331957 [debug] [ThreadPool]: Creating schema "database: "Cafe_rewards_offers"
schema: "Cafe_rewards_offers"
"
[0m14:16:56.337951 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_Cafe_rewards_offers"
[0m14:16:56.338950 [debug] [ThreadPool]: On create_Cafe_rewards_offers_Cafe_rewards_offers: BEGIN
[0m14:16:56.339950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:56.376958 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:16:56.377987 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_Cafe_rewards_offers"
[0m14:16:56.378971 [debug] [ThreadPool]: On create_Cafe_rewards_offers_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_Cafe_rewards_offers_Cafe_rewards_offers"} */
create schema if not exists "Cafe_rewards_offers"
[0m14:16:56.384951 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m14:16:56.386986 [debug] [ThreadPool]: On create_Cafe_rewards_offers_Cafe_rewards_offers: COMMIT
[0m14:16:56.386986 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_Cafe_rewards_offers"
[0m14:16:56.387994 [debug] [ThreadPool]: On create_Cafe_rewards_offers_Cafe_rewards_offers: COMMIT
[0m14:16:56.388983 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m14:16:56.389957 [debug] [ThreadPool]: On create_Cafe_rewards_offers_Cafe_rewards_offers: Close
[0m14:16:56.392953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_Cafe_rewards_offers'
[0m14:16:56.399951 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_Cafe_rewards_offers"
[0m14:16:56.399951 [debug] [ThreadPool]: On list_Cafe_rewards_offers_Cafe_rewards_offers: BEGIN
[0m14:16:56.400951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:56.436953 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:16:56.437992 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_Cafe_rewards_offers"
[0m14:16:56.438987 [debug] [ThreadPool]: On list_Cafe_rewards_offers_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_Cafe_rewards_offers"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'Cafe_rewards_offers'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'Cafe_rewards_offers'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'Cafe_rewards_offers'
  
[0m14:16:56.449999 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:16:56.450964 [debug] [ThreadPool]: On list_Cafe_rewards_offers_Cafe_rewards_offers: ROLLBACK
[0m14:16:56.451989 [debug] [ThreadPool]: On list_Cafe_rewards_offers_Cafe_rewards_offers: Close
[0m14:16:56.457963 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.458953 [debug] [MainThread]: On master: BEGIN
[0m14:16:56.459954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:56.496330 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:56.497366 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.498330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:56.511589 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:16:56.512570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC1A5F8550>]}
[0m14:16:56.513570 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:56.514588 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.514588 [debug] [MainThread]: On master: BEGIN
[0m14:16:56.515569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:56.516569 [debug] [MainThread]: On master: COMMIT
[0m14:16:56.516569 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.517569 [debug] [MainThread]: On master: COMMIT
[0m14:16:56.517569 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:16:56.518569 [debug] [MainThread]: On master: Close
[0m14:16:56.519570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:56.520589 [info ] [MainThread]: 
[0m14:16:56.529686 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:16:56.529686 [info ] [Thread-1  ]: 1 of 2 START sql table model Cafe_rewards_offers.my_first_dbt_model ............ [RUN]
[0m14:16:56.531673 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:16:56.532671 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:16:56.540709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:16:56.544675 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:16:56.532671 => 14:16:56.543671
[0m14:16:56.545681 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:16:56.589214 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:16:56.592203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:16:56.593180 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:16:56.594186 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:16:56.630186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:16:56.631214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:16:56.632179 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."Cafe_rewards_offers"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:16:56.651179 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m14:16:56.658180 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:16:56.659217 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."Cafe_rewards_offers"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:16:56.660181 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:16:56.679178 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:16:56.680178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:16:56.681179 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:16:56.683294 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:16:56.690216 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."Cafe_rewards_offers"."my_first_dbt_model__dbt_backup"
[0m14:16:56.696178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:16:56.697193 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."Cafe_rewards_offers"."my_first_dbt_model__dbt_backup" cascade
[0m14:16:56.698589 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:16:56.700634 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:16:56.545681 => 14:16:56.699637
[0m14:16:56.700634 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:16:56.702598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC1AA0BAC0>]}
[0m14:16:56.703598 [info ] [Thread-1  ]: 1 of 2 OK created sql table model Cafe_rewards_offers.my_first_dbt_model ....... [[32mSELECT 2[0m in 0.17s]
[0m14:16:56.704613 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:16:56.706634 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:16:56.707603 [info ] [Thread-1  ]: 2 of 2 START sql view model Cafe_rewards_offers.my_second_dbt_model ............ [RUN]
[0m14:16:56.708597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.my_second_dbt_model)
[0m14:16:56.709635 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m14:16:56.713634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:16:56.715607 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 14:16:56.709635 => 14:16:56.714634
[0m14:16:56.715607 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m14:16:56.736634 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:16:56.737599 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:16:56.738612 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m14:16:56.739597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:16:56.785642 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:16:56.786682 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:16:56.787680 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."Cafe_rewards_offers"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."Cafe_rewards_offers"."my_first_dbt_model"
where id = 1
  );
[0m14:16:56.796650 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:16:56.800678 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:16:56.801649 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."Cafe_rewards_offers"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:16:56.802679 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:16:56.804678 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:16:56.804678 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:16:56.805678 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:16:56.807644 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:16:56.810678 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."Cafe_rewards_offers"."my_second_dbt_model__dbt_backup"
[0m14:16:56.814678 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:16:56.814678 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."Cafe_rewards_offers"."my_second_dbt_model__dbt_backup" cascade
[0m14:16:56.815680 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:16:56.817679 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 14:16:56.716634 => 14:16:56.817679
[0m14:16:56.817679 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m14:16:56.819642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b4c281-b566-496e-8c7a-ecb46d9dacde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC1A5F78E0>]}
[0m14:16:56.820657 [info ] [Thread-1  ]: 2 of 2 OK created sql view model Cafe_rewards_offers.my_second_dbt_model ....... [[32mCREATE VIEW[0m in 0.11s]
[0m14:16:56.822657 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:16:56.825647 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.826643 [debug] [MainThread]: On master: BEGIN
[0m14:16:56.826643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:56.864642 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:56.865648 [debug] [MainThread]: On master: COMMIT
[0m14:16:56.865648 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:56.866679 [debug] [MainThread]: On master: COMMIT
[0m14:16:56.866679 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:16:56.867642 [debug] [MainThread]: On master: Close
[0m14:16:56.868643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:56.869651 [debug] [MainThread]: Connection 'create_Cafe_rewards_offers_Cafe_rewards_offers' was properly closed.
[0m14:16:56.870642 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_Cafe_rewards_offers' was properly closed.
[0m14:16:56.870642 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m14:16:56.871679 [info ] [MainThread]: 
[0m14:16:56.872648 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m14:16:56.874647 [debug] [MainThread]: Command end result
[0m14:16:56.884479 [info ] [MainThread]: 
[0m14:16:56.885479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:56.886479 [info ] [MainThread]: 
[0m14:16:56.886479 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:16:56.888514 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:56.888514 after 3.00 seconds
[0m14:16:56.889485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC173723A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC1A495D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC1A3CB340>]}
[0m14:16:56.889485 [debug] [MainThread]: Flushing usage events
[0m14:19:07.392611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16D77DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16E3CF5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16FEA51C0>]}


============================== 14:19:07.396619 | acdc820e-5cf4-431e-bcd9-572b723de864 ==============================
[0m14:19:07.396619 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:19:07.396978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:07.565968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16E3CF5B0>]}
[0m14:19:07.632997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17011ED90>]}
[0m14:19:07.633978 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:19:07.641967 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:19:07.659004 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:19:07.660000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E170085CD0>]}
[0m14:19:08.761969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1709CE0D0>]}
[0m14:19:08.774969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E170946B50>]}
[0m14:19:08.775969 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:19:08.777970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1708B22B0>]}
[0m14:19:08.779967 [info ] [MainThread]: 
[0m14:19:08.780969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:19:08.782968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:19:08.793967 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:19:08.793967 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:19:08.794968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:08.839968 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:19:08.840968 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:19:08.842970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers, now create_Cafe_rewards_offers_intro_dbt)
[0m14:19:08.843970 [debug] [ThreadPool]: Creating schema "database: "Cafe_rewards_offers"
schema: "intro_dbt"
"
[0m14:19:08.849967 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_intro_dbt"
[0m14:19:08.850969 [debug] [ThreadPool]: On create_Cafe_rewards_offers_intro_dbt: BEGIN
[0m14:19:08.850969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:08.887968 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:19:08.888968 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_intro_dbt"
[0m14:19:08.888968 [debug] [ThreadPool]: On create_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_Cafe_rewards_offers_intro_dbt"} */
create schema if not exists "intro_dbt"
[0m14:19:08.890968 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m14:19:08.891968 [debug] [ThreadPool]: On create_Cafe_rewards_offers_intro_dbt: COMMIT
[0m14:19:08.891968 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_intro_dbt"
[0m14:19:08.892968 [debug] [ThreadPool]: On create_Cafe_rewards_offers_intro_dbt: COMMIT
[0m14:19:08.893967 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m14:19:08.894968 [debug] [ThreadPool]: On create_Cafe_rewards_offers_intro_dbt: Close
[0m14:19:08.897970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m14:19:08.904968 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:19:08.905980 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m14:19:08.905980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:08.940967 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:19:08.941968 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:19:08.942969 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m14:19:08.948968 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:19:08.949973 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m14:19:08.950968 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m14:19:08.955968 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:08.956968 [debug] [MainThread]: On master: BEGIN
[0m14:19:08.957968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:09.098975 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:09.098975 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:09.100005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:19:09.112002 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:19:09.114005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E170973E50>]}
[0m14:19:09.114005 [debug] [MainThread]: On master: ROLLBACK
[0m14:19:09.115005 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:09.115968 [debug] [MainThread]: On master: BEGIN
[0m14:19:09.115968 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:09.116968 [debug] [MainThread]: On master: COMMIT
[0m14:19:09.117968 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:09.117968 [debug] [MainThread]: On master: COMMIT
[0m14:19:09.118968 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:19:09.119968 [debug] [MainThread]: On master: Close
[0m14:19:09.120978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:09.121968 [info ] [MainThread]: 
[0m14:19:09.126782 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:19:09.127810 [info ] [Thread-1  ]: 1 of 2 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m14:19:09.129783 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:19:09.129783 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:19:09.138811 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:19:09.140774 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:19:09.130782 => 14:19:09.139810
[0m14:19:09.140774 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:19:09.180802 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:19:09.182774 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:19:09.182774 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:19:09.183810 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:19:09.357806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:19:09.357806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:19:09.358804 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:19:09.364835 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m14:19:09.370833 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:19:09.371835 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:19:09.372855 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:19:09.391833 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:19:09.392849 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:19:09.392849 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:19:09.394836 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:19:09.401835 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m14:19:09.406833 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:19:09.407815 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m14:19:09.408804 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:19:09.409836 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:19:09.141813 => 14:19:09.409836
[0m14:19:09.410833 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:19:09.412811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E170C21E20>]}
[0m14:19:09.413798 [info ] [Thread-1  ]: 1 of 2 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.28s]
[0m14:19:09.414801 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:19:09.416804 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:19:09.416804 [info ] [Thread-1  ]: 2 of 2 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m14:19:09.418833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.my_second_dbt_model)
[0m14:19:09.418833 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m14:19:09.422833 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:19:09.424804 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 14:19:09.419832 => 14:19:09.423833
[0m14:19:09.424804 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m14:19:09.444796 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:19:09.445797 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:19:09.446798 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m14:19:09.446798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:09.605922 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:19:09.606962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:19:09.607962 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m14:19:09.614932 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:19:09.618957 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:19:09.619959 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:19:09.620924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:19:09.622921 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:19:09.623957 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:19:09.624920 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:19:09.625959 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:19:09.629957 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m14:19:09.632960 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:19:09.632960 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m14:19:09.633928 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:19:09.635958 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 14:19:09.425796 => 14:19:09.635958
[0m14:19:09.636957 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m14:19:09.637930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdc820e-5cf4-431e-bcd9-572b723de864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1709FFB20>]}
[0m14:19:09.639924 [info ] [Thread-1  ]: 2 of 2 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.22s]
[0m14:19:09.641922 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:19:09.643878 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:09.643878 [debug] [MainThread]: On master: BEGIN
[0m14:19:09.644878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:09.681602 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:09.682604 [debug] [MainThread]: On master: COMMIT
[0m14:19:09.682604 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:09.683604 [debug] [MainThread]: On master: COMMIT
[0m14:19:09.683604 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:19:09.684633 [debug] [MainThread]: On master: Close
[0m14:19:09.685596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:09.686605 [debug] [MainThread]: Connection 'create_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m14:19:09.686605 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m14:19:09.687597 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m14:19:09.688596 [info ] [MainThread]: 
[0m14:19:09.688997 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m14:19:09.691043 [debug] [MainThread]: Command end result
[0m14:19:09.700005 [info ] [MainThread]: 
[0m14:19:09.701005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:19:09.702011 [info ] [MainThread]: 
[0m14:19:09.703014 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:19:09.705038 [debug] [MainThread]: Command `dbt run` succeeded at 14:19:09.703992 after 2.39 seconds
[0m14:19:09.705038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E16D77DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1705CF610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1700E1B50>]}
[0m14:19:09.706049 [debug] [MainThread]: Flushing usage events
[0m14:21:19.787551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028503A937F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285061691F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028506169D30>]}


============================== 14:21:19.791587 | 0dd0bcbd-8f42-4328-ae90-947892484bd0 ==============================
[0m14:21:19.791587 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:21:19.792580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target uat', 'send_anonymous_usage_stats': 'True'}
[0m14:21:19.795627 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_postgres' does not have a target named 'uat'. The valid target names for this profile are:
   - dev
[0m14:21:19.797597 [debug] [MainThread]: Command `dbt run` failed at 14:21:19.797597 after 0.08 seconds
[0m14:21:19.798619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028503A937F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850098EE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002850613E9A0>]}
[0m14:21:19.798619 [debug] [MainThread]: Flushing usage events
[0m14:21:42.060307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021414BFDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021415A4F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214173251C0>]}


============================== 14:21:42.064346 | ff0505d3-f247-4a79-9f92-968c08d0eb9f ==============================
[0m14:21:42.064346 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:21:42.065327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target uat', 'send_anonymous_usage_stats': 'True'}
[0m14:21:42.069315 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_postgres' does not have a target named 'uat'. The valid target names for this profile are:
   - dev
[0m14:21:42.070318 [debug] [MainThread]: Command `dbt run` failed at 14:21:42.070318 after 0.08 seconds
[0m14:21:42.071345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021414BFDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214156F33D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214172FE820>]}
[0m14:21:42.072314 [debug] [MainThread]: Flushing usage events
[0m14:22:36.449552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539C6D22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539D0C8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539EDA5F40>]}


============================== 14:22:36.453540 | 8c51aff8-9149-4cc5-8303-8cf7e248ec1b ==============================
[0m14:22:36.453540 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:22:36.454540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'fail_fast': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --target uat', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:22:36.458540 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_postgres' does not have a target named 'uat'. The valid target names for this profile are:
   - dev
[0m14:22:36.459557 [debug] [MainThread]: Command `dbt run` failed at 14:22:36.459557 after 0.08 seconds
[0m14:22:36.460576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539C6D22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539D191BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001539ED7E850>]}
[0m14:22:36.461547 [debug] [MainThread]: Flushing usage events
[0m14:24:19.727980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE61522E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE6D64580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE8A65F40>]}


============================== 14:24:19.731980 | e12442f8-aa5f-4391-abfc-9ad47838bad9 ==============================
[0m14:24:19.731980 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:24:19.732984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --target uat', 'send_anonymous_usage_stats': 'True'}
[0m14:24:19.735979 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_postgres' does not have a target named 'uat'. The valid target names for this profile are:
   - dev
[0m14:24:19.737981 [debug] [MainThread]: Command `dbt run` failed at 14:24:19.737981 after 0.09 seconds
[0m14:24:19.738980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE61522E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE7051BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE8A3E850>]}
[0m14:24:19.738980 [debug] [MainThread]: Flushing usage events
[0m14:25:46.503084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D12BDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D1F03A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D35E41C0>]}


============================== 14:25:46.507085 | ce5251be-d90c-4722-9ebd-0fe0807d5af7 ==============================
[0m14:25:46.507085 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:25:46.508086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:46.763085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce5251be-d90c-4722-9ebd-0fe0807d5af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D1F03A60>]}
[0m14:25:46.874084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce5251be-d90c-4722-9ebd-0fe0807d5af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3A5ED90>]}
[0m14:25:46.878085 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:25:46.890085 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:25:46.973085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:46.974086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:46.981083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce5251be-d90c-4722-9ebd-0fe0807d5af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3E200D0>]}
[0m14:25:46.996086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce5251be-d90c-4722-9ebd-0fe0807d5af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3B4C400>]}
[0m14:25:46.996086 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:25:46.997085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce5251be-d90c-4722-9ebd-0fe0807d5af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3B4C6D0>]}
[0m14:25:46.999087 [info ] [MainThread]: 
[0m14:25:47.001085 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:47.002085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:25:47.016083 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:25:47.016083 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:25:47.017084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:47.065086 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:25:47.067085 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:25:47.069086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m14:25:47.077088 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:25:47.078086 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m14:25:47.079085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:47.117084 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:25:47.118085 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:25:47.119088 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m14:25:47.125085 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:25:47.127087 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m14:25:47.128087 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m14:25:47.134084 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:47.135084 [debug] [MainThread]: On master: BEGIN
[0m14:25:47.135084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:47.175084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:47.177088 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:47.178086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:47.190084 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:25:47.192084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce5251be-d90c-4722-9ebd-0fe0807d5af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3A1EBB0>]}
[0m14:25:47.193085 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:47.194088 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:47.195088 [debug] [MainThread]: On master: BEGIN
[0m14:25:47.196085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:47.196085 [debug] [MainThread]: On master: COMMIT
[0m14:25:47.197085 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:47.197085 [debug] [MainThread]: On master: COMMIT
[0m14:25:47.198084 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:25:47.198084 [debug] [MainThread]: On master: Close
[0m14:25:47.199084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:47.200085 [info ] [MainThread]: 
[0m14:25:47.204086 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:25:47.206088 [info ] [Thread-1  ]: 1 of 2 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m14:25:47.207087 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:25:47.208086 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:25:47.218084 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:25:47.219084 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:25:47.208086 => 14:25:47.219084
[0m14:25:47.220085 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:25:47.268085 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:25:47.270088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:25:47.270088 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:25:47.271085 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:25:47.419084 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:47.420085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:25:47.420085 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:25:47.426084 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m14:25:47.435085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:25:47.435085 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:25:47.436085 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:47.440083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:25:47.441083 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:25:47.442084 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:47.467084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:25:47.468088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:25:47.469087 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:25:47.471084 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:47.481092 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m14:25:47.486083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:25:47.487085 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m14:25:47.491088 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:25:47.494088 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:25:47.220085 => 14:25:47.494088
[0m14:25:47.495085 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:25:47.496087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5251be-d90c-4722-9ebd-0fe0807d5af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3E59B20>]}
[0m14:25:47.498090 [info ] [Thread-1  ]: 1 of 2 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.29s]
[0m14:25:47.499092 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:25:47.500085 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:25:47.501084 [info ] [Thread-1  ]: 2 of 2 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m14:25:47.502085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.my_second_dbt_model)
[0m14:25:47.503084 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m14:25:47.506083 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:25:47.507084 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 14:25:47.503084 => 14:25:47.507084
[0m14:25:47.508085 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m14:25:47.530085 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:25:47.532086 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:25:47.533087 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m14:25:47.534089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:25:47.573086 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:25:47.574085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:25:47.575085 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m14:25:47.580085 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:47.583083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:25:47.584083 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:25:47.585085 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:47.587086 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:25:47.588085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:25:47.589088 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:25:47.591087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:25:47.595085 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m14:25:47.598083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:25:47.599083 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m14:25:47.600084 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:47.602084 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 14:25:47.508085 => 14:25:47.602084
[0m14:25:47.602084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m14:25:47.604085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce5251be-d90c-4722-9ebd-0fe0807d5af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3EA8850>]}
[0m14:25:47.605086 [info ] [Thread-1  ]: 2 of 2 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.10s]
[0m14:25:47.607087 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:25:47.610088 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:47.612088 [debug] [MainThread]: On master: BEGIN
[0m14:25:47.612088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:47.652085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:47.653085 [debug] [MainThread]: On master: COMMIT
[0m14:25:47.653085 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:47.654086 [debug] [MainThread]: On master: COMMIT
[0m14:25:47.654086 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:25:47.655084 [debug] [MainThread]: On master: Close
[0m14:25:47.656087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:47.657084 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m14:25:47.657084 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m14:25:47.658085 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m14:25:47.658085 [info ] [MainThread]: 
[0m14:25:47.659085 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m14:25:47.661087 [debug] [MainThread]: Command end result
[0m14:25:47.672087 [info ] [MainThread]: 
[0m14:25:47.673087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:47.673087 [info ] [MainThread]: 
[0m14:25:47.674086 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:25:47.676086 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:47.675088 after 1.28 seconds
[0m14:25:47.677086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D12BDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D3A5ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5D39CC550>]}
[0m14:25:47.678085 [debug] [MainThread]: Flushing usage events
[0m14:27:47.016752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA24D22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA2CA6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA49A41C0>]}


============================== 14:27:47.019782 | c1349acf-3b5b-4002-9dc1-a978051e51e2 ==============================
[0m14:27:47.019782 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:27:47.021747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:27:47.190781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1349acf-3b5b-4002-9dc1-a978051e51e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA2CA6580>]}
[0m14:27:47.257774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1349acf-3b5b-4002-9dc1-a978051e51e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA4C2FD90>]}
[0m14:27:47.259752 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:27:47.268783 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:27:47.332781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:47.333782 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\example\my_first_dbt_model.sql
[0m14:27:47.627781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1349acf-3b5b-4002-9dc1-a978051e51e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA54DEEB0>]}
[0m14:27:47.640751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1349acf-3b5b-4002-9dc1-a978051e51e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA4D1C550>]}
[0m14:27:47.641750 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:27:47.642747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1349acf-3b5b-4002-9dc1-a978051e51e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA4D1C6D0>]}
[0m14:27:47.644784 [info ] [MainThread]: 
[0m14:27:47.645745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:47.647746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:27:47.658745 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:27:47.659745 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:27:47.659745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:47.701859 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:27:47.703897 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:27:47.705859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m14:27:47.712896 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:27:47.712896 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m14:27:47.713860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:47.750769 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:27:47.750769 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:27:47.751797 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m14:27:47.757761 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:27:47.759761 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m14:27:47.760760 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m14:27:47.766760 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:47.767777 [debug] [MainThread]: On master: BEGIN
[0m14:27:47.767777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:47.946711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:47.947734 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:47.948763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:47.963210 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:27:47.965218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1349acf-3b5b-4002-9dc1-a978051e51e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA4D1C400>]}
[0m14:27:47.965218 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:47.966218 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:47.967222 [debug] [MainThread]: On master: BEGIN
[0m14:27:47.968227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:47.968227 [debug] [MainThread]: On master: COMMIT
[0m14:27:47.969218 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:47.969218 [debug] [MainThread]: On master: COMMIT
[0m14:27:47.970218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:27:47.971226 [debug] [MainThread]: On master: Close
[0m14:27:47.972219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:47.973224 [info ] [MainThread]: 
[0m14:27:48.017218 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:27:48.018217 [info ] [Thread-1  ]: 1 of 2 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m14:27:48.019218 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:27:48.020217 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:27:48.029254 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:27:48.031227 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:27:48.020217 => 14:27:48.030255
[0m14:27:48.032226 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:27:48.076259 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:27:48.078225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:27:48.078225 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:27:48.079254 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:27:48.115218 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:27:48.116268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:27:48.116268 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1,2 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:27:48.123218 [debug] [Thread-1  ]: Postgres adapter: Postgres error: each UNION query must have the same number of columns
LINE 26:     select null as id
                    ^

[0m14:27:48.124226 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: ROLLBACK
[0m14:27:48.125251 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:27:48.032226 => 14:27:48.124226
[0m14:27:48.125251 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:27:48.238219 [debug] [Thread-1  ]: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  each UNION query must have the same number of columns
  LINE 26:     select null as id
                      ^
  compiled Code at target\run\dbt_postgres_demo\models\example\my_first_dbt_model.sql
[0m14:27:48.239218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1349acf-3b5b-4002-9dc1-a978051e51e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA5511820>]}
[0m14:27:48.240220 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model intro_dbt.my_first_dbt_model ............. [[31mERROR[0m in 0.22s]
[0m14:27:48.241250 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:27:48.242218 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:27:48.243253 [info ] [Thread-1  ]: 2 of 2 SKIP relation intro_dbt.my_second_dbt_model ............................. [[33mSKIP[0m]
[0m14:27:48.244218 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:27:48.246255 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:48.247225 [debug] [MainThread]: On master: BEGIN
[0m14:27:48.247225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:48.285217 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:48.285217 [debug] [MainThread]: On master: COMMIT
[0m14:27:48.286218 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:48.287217 [debug] [MainThread]: On master: COMMIT
[0m14:27:48.287217 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:27:48.288228 [debug] [MainThread]: On master: Close
[0m14:27:48.289219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:48.289219 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m14:27:48.290219 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m14:27:48.290219 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_first_dbt_model' was properly closed.
[0m14:27:48.291218 [info ] [MainThread]: 
[0m14:27:48.292218 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m14:27:48.293219 [debug] [MainThread]: Command end result
[0m14:27:48.303218 [info ] [MainThread]: 
[0m14:27:48.304218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:27:48.304218 [info ] [MainThread]: 
[0m14:27:48.305226 [error] [MainThread]:   Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  each UNION query must have the same number of columns
  LINE 26:     select null as id
                      ^
  compiled Code at target\run\dbt_postgres_demo\models\example\my_first_dbt_model.sql
[0m14:27:48.306226 [info ] [MainThread]: 
[0m14:27:48.307220 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m14:27:48.308219 [debug] [MainThread]: Command `dbt run` failed at 14:27:48.308219 after 1.37 seconds
[0m14:27:48.309256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA24D22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA4C2FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA54DEAC0>]}
[0m14:27:48.310218 [debug] [MainThread]: Flushing usage events
[0m14:28:16.333436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCE0FDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD05F38E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD05F3B50>]}


============================== 14:28:16.336438 | 8e751908-1030-4b24-a330-5a8317a40edd ==============================
[0m14:28:16.336438 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:28:16.337400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:16.507428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e751908-1030-4b24-a330-5a8317a40edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB00EE50>]}
[0m14:28:16.573429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e751908-1030-4b24-a330-5a8317a40edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCFFA7520>]}
[0m14:28:16.574407 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:28:16.582407 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:28:16.653023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:28:16.654023 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\example\my_first_dbt_model.sql
[0m14:28:16.950062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e751908-1030-4b24-a330-5a8317a40edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD131EE80>]}
[0m14:28:16.963025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e751908-1030-4b24-a330-5a8317a40edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD0B61520>]}
[0m14:28:16.964025 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:28:16.965025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e751908-1030-4b24-a330-5a8317a40edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD0B616A0>]}
[0m14:28:16.967065 [info ] [MainThread]: 
[0m14:28:16.968031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:16.969038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:28:16.980060 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:28:16.981034 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:28:16.982023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:17.130633 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:28:17.132626 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:28:17.134627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m14:28:17.141664 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:28:17.141664 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m14:28:17.142662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:17.298511 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:28:17.299557 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:28:17.299557 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m14:28:17.306519 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:28:17.307519 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m14:28:17.308557 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m14:28:17.315557 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.316527 [debug] [MainThread]: On master: BEGIN
[0m14:28:17.316527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:17.352295 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:28:17.353335 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.353335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:17.366302 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:28:17.368339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e751908-1030-4b24-a330-5a8317a40edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD0A2E820>]}
[0m14:28:17.369339 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:17.370303 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.370303 [debug] [MainThread]: On master: BEGIN
[0m14:28:17.371304 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:28:17.372312 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.372312 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.373342 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.374302 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:28:17.374302 [debug] [MainThread]: On master: Close
[0m14:28:17.375309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:17.376304 [info ] [MainThread]: 
[0m14:28:17.420339 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:28:17.420339 [info ] [Thread-1  ]: 1 of 2 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m14:28:17.422303 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:28:17.422303 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:28:17.432311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:28:17.434304 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:28:17.423303 => 14:28:17.433313
[0m14:28:17.434304 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:28:17.475320 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:28:17.476304 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:28:17.477305 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:28:17.478304 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:28:17.646080 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:17.646080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:28:17.647062 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 2 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:28:17.652062 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m14:28:17.660094 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:28:17.661063 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:28:17.662091 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:17.665091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:28:17.666092 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:28:17.667092 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:17.689053 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:28:17.690054 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:28:17.691054 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:28:17.692536 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:17.700544 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m14:28:17.705543 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:28:17.706543 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m14:28:17.709505 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:28:17.711513 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:28:17.435304 => 14:28:17.711513
[0m14:28:17.712513 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:28:17.713514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e751908-1030-4b24-a330-5a8317a40edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD0E420A0>]}
[0m14:28:17.714521 [info ] [Thread-1  ]: 1 of 2 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.29s]
[0m14:28:17.716521 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:28:17.717513 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:28:17.718515 [info ] [Thread-1  ]: 2 of 2 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m14:28:17.719513 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.my_second_dbt_model)
[0m14:28:17.720514 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m14:28:17.723513 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:28:17.724513 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 14:28:17.720514 => 14:28:17.724513
[0m14:28:17.725522 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m14:28:17.746513 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:28:17.747513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:28:17.748552 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m14:28:17.749522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:28:17.785520 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:28:17.786514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:28:17.786514 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m14:28:17.792513 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:28:17.795513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:28:17.796513 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:28:17.797521 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:28:17.799513 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:28:17.800513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:28:17.801513 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:28:17.802513 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:28:17.805548 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m14:28:17.809513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:28:17.809513 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m14:28:17.810551 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:28:17.812549 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 14:28:17.726514 => 14:28:17.812549
[0m14:28:17.813549 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m14:28:17.814520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e751908-1030-4b24-a330-5a8317a40edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD16045E0>]}
[0m14:28:17.815514 [info ] [Thread-1  ]: 2 of 2 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.10s]
[0m14:28:17.817529 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:28:17.819548 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.820515 [debug] [MainThread]: On master: BEGIN
[0m14:28:17.820515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:17.856548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:28:17.856548 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.857520 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.857520 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.858519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:28:17.859517 [debug] [MainThread]: On master: Close
[0m14:28:17.860524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:17.861514 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m14:28:17.861514 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m14:28:17.862552 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m14:28:17.862552 [info ] [MainThread]: 
[0m14:28:17.863520 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m14:28:17.864551 [debug] [MainThread]: Command end result
[0m14:28:17.873514 [info ] [MainThread]: 
[0m14:28:17.874513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:17.875514 [info ] [MainThread]: 
[0m14:28:17.876520 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:28:17.877513 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:17.877513 after 1.62 seconds
[0m14:28:17.878513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCE0FDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD0E5A9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FD0938DF0>]}
[0m14:28:17.878513 [debug] [MainThread]: Flushing usage events
[0m14:29:00.306883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A96D23A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AA491490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281ABBE5F40>]}


============================== 14:29:00.309883 | 95bff571-4cb3-463f-b466-5e78b98ac69e ==============================
[0m14:29:00.309883 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:29:00.310882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target uat', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:00.314882 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_postgres' does not have a target named 'uat'. The valid target names for this profile are:
   - dev
[0m14:29:00.315882 [debug] [MainThread]: Command `dbt run` failed at 14:29:00.315882 after 0.08 seconds
[0m14:29:00.316895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A96D23A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AA537A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281ABBBE850>]}
[0m14:29:00.316895 [debug] [MainThread]: Flushing usage events
[0m14:34:04.243164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB58922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB60C76A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB7DA41C0>]}


============================== 14:34:04.247192 | 2d1fb856-9694-40d3-b788-41d7cb9d0339 ==============================
[0m14:34:04.247192 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:34:04.248157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:34:04.416184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d1fb856-9694-40d3-b788-41d7cb9d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB60C76A0>]}
[0m14:34:04.483156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d1fb856-9694-40d3-b788-41d7cb9d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB821FD90>]}
[0m14:34:04.484157 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:34:04.493156 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:34:04.563157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:04.564171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:04.570157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d1fb856-9694-40d3-b788-41d7cb9d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB83E10D0>]}
[0m14:34:04.582167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d1fb856-9694-40d3-b788-41d7cb9d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB830C550>]}
[0m14:34:04.582167 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:34:04.583192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d1fb856-9694-40d3-b788-41d7cb9d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB830C6D0>]}
[0m14:34:04.585164 [info ] [MainThread]: 
[0m14:34:04.587158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:34:04.588164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:34:04.599156 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:34:04.600162 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:34:04.600162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:04.642585 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:34:04.644609 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:34:04.647573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m14:34:04.654569 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:34:04.654569 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m14:34:04.655569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:04.691594 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:34:04.691594 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:34:04.692623 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m14:34:04.699638 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:34:04.700594 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m14:34:04.701624 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m14:34:04.708587 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:04.709586 [debug] [MainThread]: On master: BEGIN
[0m14:34:04.710587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:04.747594 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:04.747594 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:04.748625 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:34:04.761624 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:04.763623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d1fb856-9694-40d3-b788-41d7cb9d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB7FDEBB0>]}
[0m14:34:04.764594 [debug] [MainThread]: On master: ROLLBACK
[0m14:34:04.764594 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:04.765624 [debug] [MainThread]: On master: BEGIN
[0m14:34:04.766600 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:04.766600 [debug] [MainThread]: On master: COMMIT
[0m14:34:04.767587 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:04.767587 [debug] [MainThread]: On master: COMMIT
[0m14:34:04.768586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:34:04.769586 [debug] [MainThread]: On master: Close
[0m14:34:04.770595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:04.771589 [info ] [MainThread]: 
[0m14:34:04.775594 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:34:04.776623 [info ] [Thread-1  ]: 1 of 2 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m14:34:04.778624 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:34:04.778624 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:34:04.786622 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:04.788587 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:34:04.779594 => 14:34:04.788587
[0m14:34:04.789588 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:34:04.828586 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:04.829586 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:04.830586 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:34:04.831600 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:34:04.989408 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:34:04.990408 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:04.990408 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 2 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:34:04.995406 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m14:34:05.003399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:05.004399 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:34:05.005399 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:34:05.009398 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:05.009398 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:34:05.010399 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:34:05.031435 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:34:05.032438 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:05.033399 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:34:05.035357 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:34:05.042356 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m14:34:05.048394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:05.048394 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m14:34:05.052002 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:34:05.053992 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:34:04.789588 => 14:34:05.053992
[0m14:34:05.054992 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:34:05.055992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1fb856-9694-40d3-b788-41d7cb9d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB8418B20>]}
[0m14:34:05.056994 [info ] [Thread-1  ]: 1 of 2 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.28s]
[0m14:34:05.057992 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:34:05.060008 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:34:05.061000 [info ] [Thread-1  ]: 2 of 2 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m14:34:05.061993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.my_second_dbt_model)
[0m14:34:05.063001 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m14:34:05.066006 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:05.067014 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 14:34:05.063001 => 14:34:05.067014
[0m14:34:05.067992 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m14:34:05.087028 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:05.088000 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:05.088992 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m14:34:05.088992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:05.259815 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:34:05.260846 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:05.261805 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m14:34:05.267805 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:34:05.271814 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:05.272813 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:34:05.273812 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:34:05.275841 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:34:05.275841 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:05.276842 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:34:05.278804 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:34:05.281841 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m14:34:05.284842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:05.285805 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m14:34:05.286815 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:34:05.287841 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 14:34:05.067992 => 14:34:05.287841
[0m14:34:05.288841 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m14:34:05.289805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1fb856-9694-40d3-b788-41d7cb9d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB846ACA0>]}
[0m14:34:05.291814 [info ] [Thread-1  ]: 2 of 2 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.23s]
[0m14:34:05.292806 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:34:05.294805 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:05.295805 [debug] [MainThread]: On master: BEGIN
[0m14:34:05.295805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:34:05.462202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:05.463210 [debug] [MainThread]: On master: COMMIT
[0m14:34:05.463210 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:05.464210 [debug] [MainThread]: On master: COMMIT
[0m14:34:05.464210 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:34:05.465210 [debug] [MainThread]: On master: Close
[0m14:34:05.466210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:05.467233 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m14:34:05.467233 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m14:34:05.468210 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m14:34:05.469210 [info ] [MainThread]: 
[0m14:34:05.470213 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m14:34:05.471219 [debug] [MainThread]: Command end result
[0m14:34:05.480231 [info ] [MainThread]: 
[0m14:34:05.480960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:05.481969 [info ] [MainThread]: 
[0m14:34:05.482976 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:34:05.484005 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:05.484005 after 1.32 seconds
[0m14:34:05.484980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB58922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB821FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DBB7F8D550>]}
[0m14:34:05.485976 [debug] [MainThread]: Flushing usage events
[0m14:34:37.184692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EC8937F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1ED191790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EEDB43D0>]}


============================== 14:34:37.188657 | 7ee86218-dec8-4c73-b2dd-5360a1300e6f ==============================
[0m14:34:37.188657 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:34:37.189659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:34:37.360685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EBFB8850>]}
[0m14:34:37.427686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EEF22130>]}
[0m14:34:37.428685 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:34:37.436686 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:34:37.445689 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:34:37.446976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EEFA51C0>]}
[0m14:34:38.538021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EF8CE0D0>]}
[0m14:34:38.550013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EF840220>]}
[0m14:34:38.550991 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:34:38.552013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EF5895E0>]}
[0m14:34:38.554984 [info ] [MainThread]: 
[0m14:34:38.555983 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:34:38.557984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:34:38.568984 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:34:38.569984 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:34:38.569984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:38.613022 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:34:38.613998 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:34:38.616985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_public'
[0m14:34:38.624021 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_public"
[0m14:34:38.624021 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public: BEGIN
[0m14:34:38.624991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:38.794654 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:34:38.794654 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_public"
[0m14:34:38.795640 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "connection_name": "list_Cafe_rewards_offers_public"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:34:38.801676 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:34:38.803677 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public: ROLLBACK
[0m14:34:38.804663 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public: Close
[0m14:34:38.810676 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:38.811640 [debug] [MainThread]: On master: BEGIN
[0m14:34:38.811640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:38.847647 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:38.848641 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:38.849656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:34:38.862676 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:38.864681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EF8C56D0>]}
[0m14:34:38.865647 [debug] [MainThread]: On master: ROLLBACK
[0m14:34:38.865647 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:38.866677 [debug] [MainThread]: On master: BEGIN
[0m14:34:38.867645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:38.867645 [debug] [MainThread]: On master: COMMIT
[0m14:34:38.868650 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:38.869654 [debug] [MainThread]: On master: COMMIT
[0m14:34:38.869654 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:34:38.870676 [debug] [MainThread]: On master: Close
[0m14:34:38.871654 [info ] [MainThread]: Concurrency: 1 threads (target='uat')
[0m14:34:38.872655 [info ] [MainThread]: 
[0m14:34:38.876647 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:34:38.877690 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:34:38.879652 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:34:38.880647 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:34:38.888639 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:38.890654 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:34:38.880647 => 14:34:38.889640
[0m14:34:38.891640 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:34:38.930668 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:38.931640 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:38.932660 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:34:38.932660 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:34:39.109958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:34:39.109958 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:39.110988 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 2 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:34:39.114965 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m14:34:39.121950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:39.122950 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:34:39.123961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:34:39.142951 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:34:39.142951 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:39.143951 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:34:39.145958 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:34:39.152950 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."public"."my_first_dbt_model__dbt_backup"
[0m14:34:39.157951 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:34:39.157951 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:34:39.158951 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:34:39.160951 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:34:38.891640 => 14:34:39.160951
[0m14:34:39.161950 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:34:39.163951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EF920E80>]}
[0m14:34:39.164952 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.28s]
[0m14:34:39.165953 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:34:39.166952 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:34:39.167951 [info ] [Thread-1  ]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:34:39.168950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.my_second_dbt_model)
[0m14:34:39.169951 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m14:34:39.172950 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:39.174951 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 14:34:39.169951 => 14:34:39.173950
[0m14:34:39.174951 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m14:34:39.196951 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:39.197952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:39.198952 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m14:34:39.198952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:34:39.236952 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:34:39.236952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:39.237951 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:34:39.242951 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:34:39.246950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:39.246950 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:34:39.247950 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:34:39.249950 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:34:39.250950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:39.251951 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:34:39.252951 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:34:39.255950 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."public"."my_second_dbt_model__dbt_backup"
[0m14:34:39.259949 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:34:39.260951 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:34:39.261959 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:34:39.263988 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 14:34:39.175952 => 14:34:39.262950
[0m14:34:39.263988 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m14:34:39.265952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee86218-dec8-4c73-b2dd-5360a1300e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EF920E80>]}
[0m14:34:39.266955 [info ] [Thread-1  ]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.10s]
[0m14:34:39.267953 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:34:39.269982 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:39.270951 [debug] [MainThread]: On master: BEGIN
[0m14:34:39.270951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:34:39.307933 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:39.308941 [debug] [MainThread]: On master: COMMIT
[0m14:34:39.308941 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:39.309947 [debug] [MainThread]: On master: COMMIT
[0m14:34:39.309947 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:34:39.310933 [debug] [MainThread]: On master: Close
[0m14:34:39.311933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:39.312933 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m14:34:39.313933 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_public' was properly closed.
[0m14:34:39.313933 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m14:34:39.314933 [info ] [MainThread]: 
[0m14:34:39.315933 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m14:34:39.316933 [debug] [MainThread]: Command end result
[0m14:34:39.325932 [info ] [MainThread]: 
[0m14:34:39.326933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:34:39.327934 [info ] [MainThread]: 
[0m14:34:39.328933 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:34:39.329932 [debug] [MainThread]: Command `dbt run` succeeded at 14:34:39.329932 after 2.22 seconds
[0m14:34:39.330933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EC8937F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EF4B8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1EF4D0550>]}
[0m14:34:39.331933 [debug] [MainThread]: Flushing usage events
[0m14:35:13.769859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF7D122E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF873F580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DFA4231C0>]}


============================== 14:35:13.773860 | 715c38b8-b750-4519-a25b-0329718abff9 ==============================
[0m14:35:13.773860 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:35:13.774859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:13.777896 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_postgres'
[0m14:35:13.779896 [debug] [MainThread]: Command `dbt run` failed at 14:35:13.778859 after 0.08 seconds
[0m14:35:13.779896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF7D122E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DF8811BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DFA1FE820>]}
[0m14:35:13.780896 [debug] [MainThread]: Flushing usage events
[0m14:37:35.589071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E8C523A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E9811490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EB165F40>]}


============================== 14:37:35.592100 | 05a7c944-fe35-48f2-9492-d822ecb509fc ==============================
[0m14:37:35.592100 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:37:35.594065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target uat', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:35.763090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E9811490>]}
[0m14:37:35.828091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EB199B80>]}
[0m14:37:35.829078 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:37:35.839099 [debug] [MainThread]: checksum: e2723433ebee8da41c0c154568d2f9be8cd9ec64d43ccd90d7f24366937cb13a, vars: {}, profile: , target: uat, version: 1.7.18
[0m14:37:35.854100 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:37:35.855098 [debug] [MainThread]: previous checksum: e2723433ebee8da41c0c154568d2f9be8cd9ec64d43ccd90d7f24366937cb13a, current checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08
[0m14:37:35.856101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EB2B3AF0>]}
[0m14:37:36.950101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EBC8E0D0>]}
[0m14:37:36.962075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EBC0E430>]}
[0m14:37:36.963100 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:37:36.964063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EB93B910>]}
[0m14:37:36.966100 [info ] [MainThread]: 
[0m14:37:36.968189 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:36.969189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:37:36.979216 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:37:36.980217 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:37:36.981221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:37.024189 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:37:37.026220 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:37:37.029184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_public'
[0m14:37:37.035219 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_public"
[0m14:37:37.036191 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public: BEGIN
[0m14:37:37.037183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:37.073221 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:37:37.074183 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_public"
[0m14:37:37.074183 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "connection_name": "list_Cafe_rewards_offers_public"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:37:37.081219 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:37:37.083220 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public: ROLLBACK
[0m14:37:37.083220 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public: Close
[0m14:37:37.090219 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:37.091188 [debug] [MainThread]: On master: BEGIN
[0m14:37:37.091188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:37.127190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:37:37.128183 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:37.129182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:37.143182 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m14:37:37.145220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EBC316D0>]}
[0m14:37:37.146182 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:37.146182 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:37.147220 [debug] [MainThread]: On master: BEGIN
[0m14:37:37.148189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:37:37.148189 [debug] [MainThread]: On master: COMMIT
[0m14:37:37.149183 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:37.150183 [debug] [MainThread]: On master: COMMIT
[0m14:37:37.150183 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:37:37.151183 [debug] [MainThread]: On master: Close
[0m14:37:37.152184 [info ] [MainThread]: Concurrency: 1 threads (target='uat')
[0m14:37:37.153183 [info ] [MainThread]: 
[0m14:37:37.157190 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:37:37.158223 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m14:37:37.159183 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:37:37.160183 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:37:37.169183 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:37:37.171183 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:37:37.160183 => 14:37:37.170199
[0m14:37:37.171183 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:37:37.211213 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:37:37.213183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:37:37.213183 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:37:37.214219 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:37:37.385099 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:37:37.386072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:37:37.386072 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:37:37.391080 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m14:37:37.398072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:37:37.399073 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:37:37.400110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:37:37.404072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:37:37.405073 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:37:37.406073 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:37:37.426111 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:37:37.427079 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:37:37.427079 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:37:37.429025 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:37:37.436069 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."public"."my_first_dbt_model__dbt_backup"
[0m14:37:37.441032 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:37:37.442033 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."public"."my_first_dbt_model__dbt_backup" cascade
[0m14:37:37.445032 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:37:37.447070 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:37:37.172213 => 14:37:37.447070
[0m14:37:37.448033 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:37:37.449039 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EBCCABE0>]}
[0m14:37:37.450034 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.29s]
[0m14:37:37.452042 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:37:37.453033 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:37:37.454070 [info ] [Thread-1  ]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m14:37:37.455040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.my_second_dbt_model)
[0m14:37:37.456069 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m14:37:37.459068 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:37:37.460042 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 14:37:37.456069 => 14:37:37.460042
[0m14:37:37.461036 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m14:37:37.481070 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:37:37.483033 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:37:37.483033 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m14:37:37.484068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:37:37.521041 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:37:37.522049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:37:37.522049 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."public"."my_first_dbt_model"
where id = 1
  );
[0m14:37:37.527669 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:37:37.530705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:37:37.531707 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:37:37.532706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:37:37.535706 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:37:37.535706 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:37:37.536704 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:37:37.537690 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:37:37.541705 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."public"."my_second_dbt_model__dbt_backup"
[0m14:37:37.544705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:37:37.545672 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "uat", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."public"."my_second_dbt_model__dbt_backup" cascade
[0m14:37:37.546678 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:37:37.548669 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 14:37:37.461036 => 14:37:37.547705
[0m14:37:37.548669 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m14:37:37.550670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05a7c944-fe35-48f2-9492-d822ecb509fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EBD1B190>]}
[0m14:37:37.551669 [info ] [Thread-1  ]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m14:37:37.552673 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:37:37.554668 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:37.554668 [debug] [MainThread]: On master: BEGIN
[0m14:37:37.555667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:37.591669 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:37:37.591669 [debug] [MainThread]: On master: COMMIT
[0m14:37:37.592677 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:37.592677 [debug] [MainThread]: On master: COMMIT
[0m14:37:37.593676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:37:37.594669 [debug] [MainThread]: On master: Close
[0m14:37:37.595669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:37.596671 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m14:37:37.596671 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_public' was properly closed.
[0m14:37:37.597670 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m14:37:37.597670 [info ] [MainThread]: 
[0m14:37:37.598668 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m14:37:37.600705 [debug] [MainThread]: Command end result
[0m14:37:37.609669 [info ] [MainThread]: 
[0m14:37:37.610671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:37.611671 [info ] [MainThread]: 
[0m14:37:37.612669 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:37:37.613669 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:37.613669 after 2.10 seconds
[0m14:37:37.614676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230E8C523A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EB199B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230EB2FE220>]}
[0m14:37:37.614676 [debug] [MainThread]: Flushing usage events
[0m14:38:11.441655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D765FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D9B51C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D9B51A00>]}


============================== 14:38:11.445639 | 813e15a8-30b6-4a25-a7b8-8adb294bb778 ==============================
[0m14:38:11.445639 [info ] [MainThread]: Running with dbt=1.7.18
[0m14:38:11.446639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:11.617670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D9B51BB0>]}
[0m14:38:11.684682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D9CB97C0>]}
[0m14:38:11.685670 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m14:38:11.694639 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m14:38:11.710639 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:38:11.711639 [debug] [MainThread]: previous checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, current checksum: e2723433ebee8da41c0c154568d2f9be8cd9ec64d43ccd90d7f24366937cb13a
[0m14:38:11.712648 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:38:11.713640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D9DAF130>]}
[0m14:38:12.802652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157DA68F0D0>]}
[0m14:38:12.815640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157DA606700>]}
[0m14:38:12.815640 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:38:12.816640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157DA34D7F0>]}
[0m14:38:12.818641 [info ] [MainThread]: 
[0m14:38:12.820640 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:38:12.821641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m14:38:12.832640 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m14:38:12.833640 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m14:38:12.833640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:13.014853 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:38:13.015883 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m14:38:13.018846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m14:38:13.024882 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:38:13.025877 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m14:38:13.026875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:13.062717 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:38:13.062717 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m14:38:13.063755 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m14:38:13.069717 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:38:13.071753 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m14:38:13.072754 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m14:38:13.078753 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:13.079722 [debug] [MainThread]: On master: BEGIN
[0m14:38:13.079722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:13.243614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:38:13.244651 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:13.245614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:38:13.259650 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m14:38:13.261614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157DA648940>]}
[0m14:38:13.262623 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:13.263613 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:13.263613 [debug] [MainThread]: On master: BEGIN
[0m14:38:13.264620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:38:13.265619 [debug] [MainThread]: On master: COMMIT
[0m14:38:13.265619 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:13.266640 [debug] [MainThread]: On master: COMMIT
[0m14:38:13.267628 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:38:13.267628 [debug] [MainThread]: On master: Close
[0m14:38:13.268614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:13.270617 [info ] [MainThread]: 
[0m14:38:13.274768 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:38:13.275770 [info ] [Thread-1  ]: 1 of 2 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m14:38:13.276799 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m14:38:13.276799 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m14:38:13.285799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:38:13.287762 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 14:38:13.277798 => 14:38:13.286769
[0m14:38:13.287762 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m14:38:13.327799 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:38:13.328768 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:38:13.329763 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m14:38:13.330819 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:38:13.505072 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:38:13.506074 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:38:13.506074 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:38:13.512073 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m14:38:13.519034 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:38:13.519034 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:38:13.520034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:38:13.524071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:38:13.525056 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:38:13.526041 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:38:13.546032 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:38:13.547033 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:38:13.547033 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m14:38:13.549034 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:38:13.556063 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m14:38:13.561070 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m14:38:13.562071 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m14:38:13.565042 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:38:13.567045 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 14:38:13.288770 => 14:38:13.567045
[0m14:38:13.568071 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m14:38:13.570036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157DA633280>]}
[0m14:38:13.571043 [info ] [Thread-1  ]: 1 of 2 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.29s]
[0m14:38:13.572036 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m14:38:13.574071 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:38:13.574071 [info ] [Thread-1  ]: 2 of 2 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m14:38:13.576034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.my_second_dbt_model)
[0m14:38:13.576034 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m14:38:13.580034 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:38:13.581043 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 14:38:13.577034 => 14:38:13.580034
[0m14:38:13.582035 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m14:38:13.602072 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:38:13.603045 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:38:13.604043 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m14:38:13.605042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:13.641034 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:38:13.642071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:38:13.643043 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m14:38:13.648034 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:38:13.652071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:38:13.652071 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:38:13.654034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:38:13.656033 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:38:13.656033 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:38:13.657046 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m14:38:13.658039 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:38:13.662070 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m14:38:13.665071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m14:38:13.666033 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m14:38:13.667071 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:38:13.668070 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 14:38:13.582035 => 14:38:13.668070
[0m14:38:13.669071 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m14:38:13.671035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813e15a8-30b6-4a25-a7b8-8adb294bb778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157DA730A00>]}
[0m14:38:13.672035 [info ] [Thread-1  ]: 2 of 2 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.10s]
[0m14:38:13.673036 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m14:38:13.675035 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:13.676035 [debug] [MainThread]: On master: BEGIN
[0m14:38:13.676035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:13.711042 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:38:13.712034 [debug] [MainThread]: On master: COMMIT
[0m14:38:13.712034 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:13.713034 [debug] [MainThread]: On master: COMMIT
[0m14:38:13.714042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:38:13.714042 [debug] [MainThread]: On master: Close
[0m14:38:13.715034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:13.716035 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m14:38:13.717035 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m14:38:13.717035 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m14:38:13.718034 [info ] [MainThread]: 
[0m14:38:13.719039 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m14:38:13.721034 [debug] [MainThread]: Command end result
[0m14:38:13.729033 [info ] [MainThread]: 
[0m14:38:13.730058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:13.731034 [info ] [MainThread]: 
[0m14:38:13.732064 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:38:13.733042 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:13.733042 after 2.37 seconds
[0m14:38:13.734073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D765FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157DA6335B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157DA2A47F0>]}
[0m14:38:13.734073 [debug] [MainThread]: Flushing usage events
[0m17:21:40.206423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AA752D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281ACE74BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281ACE64D00>]}


============================== 17:21:40.217422 | f2b18325-269a-4962-863d-6facd6daf65d ==============================
[0m17:21:40.217422 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:21:40.218423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:40.550458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AA097880>]}
[0m17:21:40.623422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281ACFB57C0>]}
[0m17:21:40.630422 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:21:40.646459 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:21:41.430602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:21:41.431607 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:21:41.432572 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_demo://models\Cafe_rewards_offers\schema.yml
[0m17:21:41.683602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD6E00D0>]}
[0m17:21:41.704577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD617FA0>]}
[0m17:21:41.705565 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:21:41.706573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD463E50>]}
[0m17:21:41.710577 [info ] [MainThread]: 
[0m17:21:41.712066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:41.713573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:21:41.724564 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:21:41.724564 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:21:41.725564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:41.772599 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:21:41.773599 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:21:41.777568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:21:41.784600 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:21:41.785565 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:21:41.785565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:41.824565 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:21:41.824565 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:21:41.825571 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:21:41.833600 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:21:41.834599 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:21:41.835578 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:21:41.841600 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:41.842565 [debug] [MainThread]: On master: BEGIN
[0m17:21:41.843568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:41.882564 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:41.883600 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:41.884574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:21:41.897599 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:21:41.899564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281ADA06BB0>]}
[0m17:21:41.900564 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:41.901564 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:41.901564 [debug] [MainThread]: On master: BEGIN
[0m17:21:41.902565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:41.903564 [debug] [MainThread]: On master: COMMIT
[0m17:21:41.903564 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:41.904564 [debug] [MainThread]: On master: COMMIT
[0m17:21:41.904564 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:21:41.905564 [debug] [MainThread]: On master: Close
[0m17:21:41.906564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:41.908565 [info ] [MainThread]: 
[0m17:21:41.913565 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:21:41.914600 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:21:41.915564 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:21:41.916600 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:21:41.925600 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:21:41.927569 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:21:41.916600 => 17:21:41.926568
[0m17:21:41.928575 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:21:42.014594 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:21:42.015572 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:21:42.016577 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:21:42.016577 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:21:42.056854 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:21:42.057856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:21:42.058852 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:21:42.064980 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:21:42.072009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:21:42.072972 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:21:42.074024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:42.077971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:21:42.078971 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:21:42.079971 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:42.102007 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:21:42.102971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:21:42.102971 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:21:42.104729 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:21:42.113768 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:21:42.118767 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:21:42.119738 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:21:42.122662 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:21:42.124700 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:21:41.928575 => 17:21:42.124700
[0m17:21:42.125670 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:21:42.127668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD770A60>]}
[0m17:21:42.128668 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.21s]
[0m17:21:42.130665 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:21:42.130665 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:21:42.131663 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:21:42.132663 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:21:42.133700 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:21:42.136699 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:21:42.138674 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:21:42.134663 => 17:21:42.137699
[0m17:21:42.139662 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:21:42.161672 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:21:42.162667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:21:42.163663 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:21:42.164664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:42.202167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:21:42.203202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:21:42.204167 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
)

SELECT * FROM final
  );
[0m17:21:42.211168 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:42.215167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:21:42.215167 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp" rename to "postgress__customers_as_c"
[0m17:21:42.217168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:42.219167 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:21:42.219167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:21:42.220167 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:21:42.221167 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:21:42.225166 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_backup"
[0m17:21:42.229168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:21:42.230167 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_backup" cascade
[0m17:21:42.231167 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:42.233167 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:21:42.139662 => 17:21:42.232168
[0m17:21:42.233167 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:21:42.234167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD48E700>]}
[0m17:21:42.236168 [info ] [Thread-1  ]: 2 of 3 OK created sql view model intro_dbt.postgress__customers_as_c ........... [[32mCREATE VIEW[0m in 0.10s]
[0m17:21:42.237172 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:21:42.238169 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:21:42.239167 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:21:42.240167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:21:42.241177 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:21:42.245168 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:21:42.247168 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:21:42.241177 => 17:21:42.246167
[0m17:21:42.247168 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:21:42.253169 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:21:42.254170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:21:42.255179 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:21:42.255179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:42.295168 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:21:42.296169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:21:42.296169 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:21:42.301167 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:42.305166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:21:42.305166 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:21:42.306167 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:42.310170 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:21:42.311176 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:21:42.311176 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:21:42.313167 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:21:42.316167 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:21:42.317168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:21:42.318167 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:21:42.319177 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:42.321166 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:21:42.248168 => 17:21:42.320167
[0m17:21:42.321166 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:21:42.323168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2b18325-269a-4962-863d-6facd6daf65d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD77B8B0>]}
[0m17:21:42.324168 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.08s]
[0m17:21:42.326168 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:21:42.329204 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:42.329204 [debug] [MainThread]: On master: BEGIN
[0m17:21:42.330204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:42.368923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:42.369923 [debug] [MainThread]: On master: COMMIT
[0m17:21:42.370926 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:42.370926 [debug] [MainThread]: On master: COMMIT
[0m17:21:42.371924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:21:42.371924 [debug] [MainThread]: On master: Close
[0m17:21:42.373924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:42.373924 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:21:42.374927 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:21:42.375925 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:21:42.376928 [info ] [MainThread]: 
[0m17:21:42.377925 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m17:21:42.379927 [debug] [MainThread]: Command end result
[0m17:21:42.390924 [info ] [MainThread]: 
[0m17:21:42.391924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:42.393925 [info ] [MainThread]: 
[0m17:21:42.394924 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:21:42.396924 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:42.396924 after 2.29 seconds
[0m17:21:42.397923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AA752D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281ACFB57C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281AD496E50>]}
[0m17:21:42.397923 [debug] [MainThread]: Flushing usage events
[0m17:23:46.274166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A07E523A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A365490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A365310>]}


============================== 17:23:46.278195 | 6b7db686-dda9-4867-8ecb-beae6104ce1a ==============================
[0m17:23:46.278195 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:23:46.279160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:23:46.454185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A3A53A0>]}
[0m17:23:46.523157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A4F7220>]}
[0m17:23:46.525158 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:23:46.534157 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:23:46.609157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:23:46.610158 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\schema.yml
[0m17:23:46.611158 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:23:46.848159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0ABE20D0>]}
[0m17:23:46.862166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A972190>]}
[0m17:23:46.862166 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:23:46.865170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A5E8190>]}
[0m17:23:46.866197 [info ] [MainThread]: 
[0m17:23:46.868160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:23:46.870159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:23:46.880158 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:23:46.881161 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:23:46.882184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:46.925158 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:23:46.927196 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:23:46.930211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:23:46.938158 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:23:46.939158 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:23:46.939158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:46.977169 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:23:46.977169 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:23:46.978196 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:23:46.985196 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:23:46.986166 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:23:46.987195 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:23:46.993194 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:46.994196 [debug] [MainThread]: On master: BEGIN
[0m17:23:46.994196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:47.031160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:23:47.032166 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:47.032166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:23:47.045194 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:23:47.047189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0AF0CAF0>]}
[0m17:23:47.048159 [debug] [MainThread]: On master: ROLLBACK
[0m17:23:47.049211 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:47.049211 [debug] [MainThread]: On master: BEGIN
[0m17:23:47.050166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:23:47.051159 [debug] [MainThread]: On master: COMMIT
[0m17:23:47.051159 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:47.052158 [debug] [MainThread]: On master: COMMIT
[0m17:23:47.053166 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:23:47.053166 [debug] [MainThread]: On master: Close
[0m17:23:47.054172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:47.056159 [info ] [MainThread]: 
[0m17:23:47.060167 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:23:47.061166 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:23:47.062167 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:23:47.063165 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:23:47.071158 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:23:47.072158 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:23:47.063165 => 17:23:47.072158
[0m17:23:47.073165 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:23:47.155158 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:23:47.156158 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:23:47.157172 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:23:47.158158 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:23:47.194038 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:23:47.195046 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:23:47.195046 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:23:47.200493 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:23:47.207538 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:23:47.208501 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:23:47.209538 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:47.212539 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:23:47.213555 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:23:47.215503 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:47.236500 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:23:47.237500 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:23:47.238514 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:23:47.240073 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:23:47.247080 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:23:47.253118 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:23:47.253118 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:23:47.257081 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:23:47.258081 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:23:47.074158 => 17:23:47.258081
[0m17:23:47.259081 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:23:47.260081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0AE758B0>]}
[0m17:23:47.261095 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.20s]
[0m17:23:47.263114 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:23:47.264083 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:23:47.265086 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:23:47.267117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:23:47.267117 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:23:47.271118 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:23:47.272088 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:23:47.268116 => 17:23:47.271118
[0m17:23:47.273081 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:23:47.294120 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:23:47.295082 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:23:47.296103 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:23:47.296103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:47.334081 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:23:47.334081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:23:47.335081 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
SELECT * FROM "Cafe_rewards_offers"."Practice_with_source"."customers";
)
, final AS (
    SELECT * FROM source_customer
    limit 10;
)

SELECT * FROM final;
  );
[0m17:23:47.336088 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: ...OM "Cafe_rewards_offers"."Practice_with_source"."customers";
                                                                      ^

[0m17:23:47.337081 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: ROLLBACK
[0m17:23:47.338081 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:23:47.273081 => 17:23:47.338081
[0m17:23:47.339090 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:23:47.412081 [debug] [Thread-1  ]: Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near ";"
  LINE 8: ...OM "Cafe_rewards_offers"."Practice_with_source"."customers";
                                                                        ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:23:47.413081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A9A1B20>]}
[0m17:23:47.414085 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model intro_dbt.postgress__customers_as_c ....... [[31mERROR[0m in 0.15s]
[0m17:23:47.416082 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:23:47.417088 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:23:47.417088 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:23:47.419118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:23:47.419118 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:23:47.422120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:23:47.424088 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:23:47.420119 => 17:23:47.423116
[0m17:23:47.424088 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:23:47.429116 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:23:47.431084 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:23:47.432083 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:23:47.433118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:47.471100 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:23:47.472081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:23:47.472081 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:23:47.477080 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:23:47.482088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:23:47.482088 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:23:47.483088 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:47.486120 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:23:47.486120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:23:47.487117 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:23:47.488088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:23:47.491080 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:23:47.495081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:23:47.495081 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:23:47.496081 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:23:47.499080 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:23:47.425098 => 17:23:47.498084
[0m17:23:47.499080 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:23:47.501089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7db686-dda9-4867-8ecb-beae6104ce1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0AE567C0>]}
[0m17:23:47.502082 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.08s]
[0m17:23:47.503085 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:23:47.505089 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:47.506112 [debug] [MainThread]: On master: BEGIN
[0m17:23:47.506112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:47.545119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:23:47.545119 [debug] [MainThread]: On master: COMMIT
[0m17:23:47.546133 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:47.546133 [debug] [MainThread]: On master: COMMIT
[0m17:23:47.547082 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:23:47.548081 [debug] [MainThread]: On master: Close
[0m17:23:47.550083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:47.550083 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:23:47.551081 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:23:47.552082 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:23:47.552082 [info ] [MainThread]: 
[0m17:23:47.553081 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m17:23:47.555117 [debug] [MainThread]: Command end result
[0m17:23:47.564082 [info ] [MainThread]: 
[0m17:23:47.565084 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:23:47.566091 [info ] [MainThread]: 
[0m17:23:47.567080 [error] [MainThread]:   Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near ";"
  LINE 8: ...OM "Cafe_rewards_offers"."Practice_with_source"."customers";
                                                                        ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:23:47.568100 [info ] [MainThread]: 
[0m17:23:47.568100 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:23:47.570117 [debug] [MainThread]: Command `dbt run` failed at 17:23:47.569116 after 1.37 seconds
[0m17:23:47.571082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A07E523A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A4F7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0ABED9A0>]}
[0m17:23:47.571082 [debug] [MainThread]: Flushing usage events
[0m17:24:12.158832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A35923A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A5EA4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A5EA4310>]}


============================== 17:24:12.162832 | 781db00b-0653-465f-90a8-f4d9098a3233 ==============================
[0m17:24:12.162832 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:24:12.163460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:12.337506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A5EE43A0>]}
[0m17:24:12.408515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A6038220>]}
[0m17:24:12.409498 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:24:12.418507 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:24:12.494484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:12.495485 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\schema.yml
[0m17:24:12.736483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A67220D0>]}
[0m17:24:12.750494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A665F0D0>]}
[0m17:24:12.751487 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:24:12.752495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A64B2130>]}
[0m17:24:12.754485 [info ] [MainThread]: 
[0m17:24:12.756485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:24:12.757488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:24:12.769524 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:24:12.769524 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:24:12.770492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:12.931522 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:24:12.933519 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:24:12.936520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:24:12.943554 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:24:12.944525 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:24:12.944525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:12.983531 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:24:12.983531 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:24:12.984526 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:24:12.990555 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:24:12.992555 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:24:12.993526 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:24:12.999519 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:13.000519 [debug] [MainThread]: On master: BEGIN
[0m17:24:13.000519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:13.038526 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:24:13.039555 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:13.039555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:24:13.053517 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:24:13.055556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A6A4BAF0>]}
[0m17:24:13.055556 [debug] [MainThread]: On master: ROLLBACK
[0m17:24:13.056555 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:13.057530 [debug] [MainThread]: On master: BEGIN
[0m17:24:13.058518 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:24:13.058518 [debug] [MainThread]: On master: COMMIT
[0m17:24:13.059533 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:13.059533 [debug] [MainThread]: On master: COMMIT
[0m17:24:13.060518 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:24:13.060518 [debug] [MainThread]: On master: Close
[0m17:24:13.062519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:13.063522 [info ] [MainThread]: 
[0m17:24:13.067526 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:24:13.068556 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:24:13.070555 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:24:13.070555 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:24:13.079555 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:24:13.081520 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:24:13.071555 => 17:24:13.080554
[0m17:24:13.082522 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:24:13.165527 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:24:13.166518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:24:13.167519 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:24:13.168525 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:24:13.205554 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:24:13.206519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:24:13.206519 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:24:13.211525 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:24:13.219553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:24:13.220525 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:24:13.221525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:24:13.224557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:24:13.225532 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:24:13.226530 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:24:13.247555 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:24:13.248521 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:24:13.249519 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:24:13.251569 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:24:13.258554 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:24:13.263554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:24:13.264518 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:24:13.267556 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:24:13.269554 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:24:13.082522 => 17:24:13.269554
[0m17:24:13.270555 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:24:13.271522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A67B48B0>]}
[0m17:24:13.273528 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.20s]
[0m17:24:13.274521 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:24:13.275525 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:24:13.276540 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:24:13.277519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:24:13.278518 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:24:13.282534 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:24:13.283558 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:24:13.278518 => 17:24:13.283558
[0m17:24:13.284526 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:24:13.306518 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:24:13.307518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:24:13.308538 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:24:13.308538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:13.345518 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:24:13.346557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:24:13.347539 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
SELECT * FROM "Cafe_rewards_offers"."public"."customers";
)
, final AS (
    SELECT * FROM source_customer
    limit 10;
)

SELECT * FROM final;
  );
[0m17:24:13.348521 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 8: SELECT * FROM "Cafe_rewards_offers"."public"."customers";
                                                                ^

[0m17:24:13.349557 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: ROLLBACK
[0m17:24:13.350525 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:24:13.285559 => 17:24:13.350525
[0m17:24:13.351524 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:24:13.355518 [debug] [Thread-1  ]: Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near ";"
  LINE 8: SELECT * FROM "Cafe_rewards_offers"."public"."customers";
                                                                  ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:24:13.356529 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A64E3D00>]}
[0m17:24:13.357518 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model intro_dbt.postgress__customers_as_c ....... [[31mERROR[0m in 0.08s]
[0m17:24:13.358519 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:24:13.359518 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:24:13.360518 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:24:13.361518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:24:13.361518 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:24:13.365520 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:24:13.366560 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:24:13.362518 => 17:24:13.366560
[0m17:24:13.367518 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:24:13.372555 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:24:13.374533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:24:13.374533 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:24:13.375561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:24:13.413131 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:24:13.414138 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:24:13.415135 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:24:13.420137 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:24:13.424166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:24:13.425133 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:24:13.426167 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:24:13.428130 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:24:13.429131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:24:13.429131 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:24:13.431131 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:24:13.435130 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:24:13.438130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:24:13.439131 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:24:13.440131 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:24:13.442130 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:24:13.368518 => 17:24:13.441131
[0m17:24:13.442130 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:24:13.443131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781db00b-0653-465f-90a8-f4d9098a3233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A6547490>]}
[0m17:24:13.445139 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.08s]
[0m17:24:13.446135 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:24:13.448132 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:13.449138 [debug] [MainThread]: On master: BEGIN
[0m17:24:13.450136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:13.486130 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:24:13.487131 [debug] [MainThread]: On master: COMMIT
[0m17:24:13.488144 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:13.488144 [debug] [MainThread]: On master: COMMIT
[0m17:24:13.489130 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:24:13.489130 [debug] [MainThread]: On master: Close
[0m17:24:13.491131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:13.491131 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:24:13.492130 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:24:13.492130 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:24:13.493132 [info ] [MainThread]: 
[0m17:24:13.494131 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m17:24:13.496131 [debug] [MainThread]: Command end result
[0m17:24:13.505130 [info ] [MainThread]: 
[0m17:24:13.505130 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:13.506131 [info ] [MainThread]: 
[0m17:24:13.507130 [error] [MainThread]:   Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near ";"
  LINE 8: SELECT * FROM "Cafe_rewards_offers"."public"."customers";
                                                                  ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:24:13.508130 [info ] [MainThread]: 
[0m17:24:13.508130 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:24:13.510130 [debug] [MainThread]: Command `dbt run` failed at 17:24:13.510130 after 1.43 seconds
[0m17:24:13.510130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A35923A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A6038220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0A6746FA0>]}
[0m17:24:13.511130 [debug] [MainThread]: Flushing usage events
[0m17:25:00.043965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F21ED23A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F243E4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F243E4310>]}


============================== 17:25:00.046964 | fd06ec8d-7c44-4a40-a86a-90673f1405f1 ==============================
[0m17:25:00.046964 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:25:00.047964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:25:00.251967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F246243A0>]}
[0m17:25:00.329965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F24777220>]}
[0m17:25:00.330965 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:25:00.341965 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:25:00.428966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:00.428966 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:25:00.612965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F24D57F40>]}
[0m17:25:00.627966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F24624550>]}
[0m17:25:00.628967 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:25:00.630967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F249F20D0>]}
[0m17:25:00.634968 [info ] [MainThread]: 
[0m17:25:00.636969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:00.638966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:25:00.651967 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:25:00.652965 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:25:00.653966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:00.698965 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:25:00.700968 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:25:00.703969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:25:00.711966 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:25:00.711966 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:25:00.712966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:00.752966 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:25:00.752966 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:25:00.753966 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:25:00.759965 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:25:00.760965 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:25:00.761964 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:25:00.768965 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:00.768965 [debug] [MainThread]: On master: BEGIN
[0m17:25:00.769965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:00.806965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:25:00.807967 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:00.807967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:25:00.820967 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:25:00.822965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F24DA8940>]}
[0m17:25:00.823965 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:00.824967 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:00.824967 [debug] [MainThread]: On master: BEGIN
[0m17:25:00.825967 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:25:00.826965 [debug] [MainThread]: On master: COMMIT
[0m17:25:00.826965 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:00.827965 [debug] [MainThread]: On master: COMMIT
[0m17:25:00.827965 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:25:00.828965 [debug] [MainThread]: On master: Close
[0m17:25:00.829967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:00.830972 [info ] [MainThread]: 
[0m17:25:00.836966 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:25:00.837966 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:25:00.838965 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:25:00.839966 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:25:00.848964 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:00.850971 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:25:00.839966 => 17:25:00.850971
[0m17:25:00.851968 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:25:00.899966 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:00.900967 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:00.901969 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:25:00.902966 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:25:00.938966 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:25:00.939967 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:00.940966 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:25:00.943964 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:25:00.951967 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:00.952965 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:25:00.953965 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:25:00.957964 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:00.957964 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:25:00.958965 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:25:00.981964 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:25:00.981964 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:00.982965 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:25:00.984966 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:25:00.992964 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:25:00.997964 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:00.997964 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:25:01.001969 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:25:01.003965 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:25:00.851968 => 17:25:01.002966
[0m17:25:01.004966 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:25:01.005967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F24DD4BE0>]}
[0m17:25:01.006967 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.17s]
[0m17:25:01.008968 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:25:01.008968 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:25:01.009966 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:25:01.011966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:25:01.011966 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:25:01.015966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:25:01.017967 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:25:01.012966 => 17:25:01.016970
[0m17:25:01.018967 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:25:01.039964 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:25:01.040965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:25:01.041968 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:25:01.041968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:01.077965 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:25:01.078965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:25:01.079966 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10;
)

SELECT * FROM final;
  );
[0m17:25:01.080968 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 12:     limit 10;
                     ^

[0m17:25:01.081968 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: ROLLBACK
[0m17:25:01.082967 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:25:01.019968 => 17:25:01.081968
[0m17:25:01.083967 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:25:01.087966 [debug] [Thread-1  ]: Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near ";"
  LINE 12:     limit 10;
                       ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:25:01.088966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F25007BE0>]}
[0m17:25:01.088966 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model intro_dbt.postgress__customers_as_c ....... [[31mERROR[0m in 0.08s]
[0m17:25:01.090967 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:25:01.090967 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:25:01.091965 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:25:01.092965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:25:01.093965 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:25:01.096967 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:01.097964 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:25:01.093965 => 17:25:01.097964
[0m17:25:01.098965 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:25:01.145964 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:01.146965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:01.147966 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:25:01.147966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:01.183972 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:25:01.184966 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:01.185966 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:25:01.189965 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:25:01.193965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:01.194965 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:25:01.195966 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:25:01.197965 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:25:01.198966 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:01.198966 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:25:01.200968 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:25:01.203964 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:25:01.206965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:01.207966 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:25:01.208965 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:25:01.210965 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:25:01.098965 => 17:25:01.210965
[0m17:25:01.210965 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:25:01.211994 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd06ec8d-7c44-4a40-a86a-90673f1405f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F24DD4D90>]}
[0m17:25:01.212968 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:25:01.214967 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:25:01.216967 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:01.217969 [debug] [MainThread]: On master: BEGIN
[0m17:25:01.218968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:01.254997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:25:01.254997 [debug] [MainThread]: On master: COMMIT
[0m17:25:01.255967 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:01.256978 [debug] [MainThread]: On master: COMMIT
[0m17:25:01.256978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:25:01.257966 [debug] [MainThread]: On master: Close
[0m17:25:01.258966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:01.259967 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:25:01.259967 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:25:01.260966 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:25:01.260966 [info ] [MainThread]: 
[0m17:25:01.261965 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m17:25:01.263966 [debug] [MainThread]: Command end result
[0m17:25:01.272966 [info ] [MainThread]: 
[0m17:25:01.273966 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:25:01.273966 [info ] [MainThread]: 
[0m17:25:01.274966 [error] [MainThread]:   Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near ";"
  LINE 12:     limit 10;
                       ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:25:01.275966 [info ] [MainThread]: 
[0m17:25:01.275966 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:25:01.277965 [debug] [MainThread]: Command `dbt run` failed at 17:25:01.277965 after 1.32 seconds
[0m17:25:01.277965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F21ED23A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F2481ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F2502C2B0>]}
[0m17:25:01.278966 [debug] [MainThread]: Flushing usage events
[0m17:25:43.006490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C812D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49ED36BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49ED24D00>]}


============================== 17:25:43.010525 | 7a97c0ec-7add-4367-80bd-8255e2dfb8b0 ==============================
[0m17:25:43.010525 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:25:43.011496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:25:43.188518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49BD48880>]}
[0m17:25:43.258518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49EE797C0>]}
[0m17:25:43.259526 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:25:43.269490 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:25:43.343526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:43.344496 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:25:43.497525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49F49BE80>]}
[0m17:25:43.510491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49EF525E0>]}
[0m17:25:43.511497 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:25:43.512491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49F338190>]}
[0m17:25:43.514528 [info ] [MainThread]: 
[0m17:25:43.516489 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:43.518490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:25:43.529525 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:25:43.529525 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:25:43.530497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:43.574400 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:25:43.575363 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:25:43.578366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:25:43.585364 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:25:43.586373 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:25:43.586373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:43.623379 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:25:43.624364 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:25:43.625364 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:25:43.631400 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:25:43.633400 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:25:43.634364 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:25:43.640400 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:43.640400 [debug] [MainThread]: On master: BEGIN
[0m17:25:43.641371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:43.678403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:25:43.679364 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:43.679364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:25:43.692393 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:25:43.694402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49F285040>]}
[0m17:25:43.695365 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:43.695365 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:43.696400 [debug] [MainThread]: On master: BEGIN
[0m17:25:43.697388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:25:43.697388 [debug] [MainThread]: On master: COMMIT
[0m17:25:43.698374 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:43.698374 [debug] [MainThread]: On master: COMMIT
[0m17:25:43.699373 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:25:43.700383 [debug] [MainThread]: On master: Close
[0m17:25:43.701366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:43.702366 [info ] [MainThread]: 
[0m17:25:43.706375 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:25:43.707364 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:25:43.708364 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:25:43.709400 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:25:43.717400 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:43.719365 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:25:43.709400 => 17:25:43.718367
[0m17:25:43.720365 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:25:43.762393 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:43.763363 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:43.763363 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:25:43.764393 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:25:43.802365 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:25:43.803373 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:43.803373 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:25:43.808418 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:25:43.814399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:43.815399 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:25:43.816399 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:25:43.820403 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:43.821401 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:25:43.822401 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:25:43.843390 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:25:43.844392 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:43.844392 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:25:43.846392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:25:43.854398 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:25:43.859399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:25:43.859399 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:25:43.862399 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:25:43.864364 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:25:43.720365 => 17:25:43.864364
[0m17:25:43.865364 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:25:43.866373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49F514B20>]}
[0m17:25:43.868367 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.16s]
[0m17:25:43.869368 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:25:43.870366 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:25:43.871401 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:25:43.872364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:25:43.873400 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:25:43.876399 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:25:43.877407 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:25:43.873400 => 17:25:43.877407
[0m17:25:43.878370 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:25:43.898363 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:25:43.899392 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:25:43.900363 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:25:43.901364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:43.938364 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:25:43.938364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:25:43.939364 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final;
  );
[0m17:25:43.940378 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: SELECT * FROM final;
                            ^

[0m17:25:43.941363 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: ROLLBACK
[0m17:25:43.942399 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:25:43.878370 => 17:25:43.941363
[0m17:25:43.942399 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:25:43.947398 [debug] [Thread-1  ]: Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near ";"
  LINE 15: SELECT * FROM final;
                              ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:25:43.947398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49F5A1040>]}
[0m17:25:43.948401 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model intro_dbt.postgress__customers_as_c ....... [[31mERROR[0m in 0.08s]
[0m17:25:43.950364 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:25:43.951365 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:25:43.952363 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:25:43.953379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:25:43.954408 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:25:43.957401 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:43.958375 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:25:43.954408 => 17:25:43.958375
[0m17:25:43.959363 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:25:44.005402 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:44.007372 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:44.007372 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:25:44.008371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:25:44.046363 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:25:44.047371 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:44.047371 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:25:44.053418 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:25:44.057363 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:44.058364 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:25:44.059364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:25:44.061363 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:25:44.061363 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:44.062363 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:25:44.063371 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:25:44.067363 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:25:44.071401 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:25:44.071401 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:25:44.072377 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:25:44.074364 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:25:43.959363 => 17:25:44.074364
[0m17:25:44.075363 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:25:44.076363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a97c0ec-7add-4367-80bd-8255e2dfb8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49F5F17F0>]}
[0m17:25:44.077364 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:25:44.079366 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:25:44.081401 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:44.081401 [debug] [MainThread]: On master: BEGIN
[0m17:25:44.082371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:44.120364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:25:44.120364 [debug] [MainThread]: On master: COMMIT
[0m17:25:44.121365 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:44.121365 [debug] [MainThread]: On master: COMMIT
[0m17:25:44.122363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:25:44.123371 [debug] [MainThread]: On master: Close
[0m17:25:44.124365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:44.124365 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:25:44.125373 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:25:44.126364 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:25:44.126364 [info ] [MainThread]: 
[0m17:25:44.127363 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m17:25:44.129374 [debug] [MainThread]: Command end result
[0m17:25:44.140374 [info ] [MainThread]: 
[0m17:25:44.141365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:25:44.141365 [info ] [MainThread]: 
[0m17:25:44.142371 [error] [MainThread]:   Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near ";"
  LINE 15: SELECT * FROM final;
                              ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:25:44.143400 [info ] [MainThread]: 
[0m17:25:44.144364 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:25:44.145371 [debug] [MainThread]: Command `dbt run` failed at 17:25:44.145371 after 1.22 seconds
[0m17:25:44.146414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C812D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49EE797C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49F860E50>]}
[0m17:25:44.146414 [debug] [MainThread]: Flushing usage events
[0m17:27:03.088521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A72D37F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A97E81F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A97E8D30>]}


============================== 17:27:03.091520 | b605c06e-027c-4954-b446-5897e915d8ad ==============================
[0m17:27:03.091520 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:27:03.092519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:27:03.268519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A6BE8850>]}
[0m17:27:03.340520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A9B34820>]}
[0m17:27:03.341520 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:27:03.350542 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:27:03.425850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:03.425850 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:27:03.578849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AA15BE50>]}
[0m17:27:03.591821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A9B7C070>]}
[0m17:27:03.592813 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:27:03.593824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A9DF8160>]}
[0m17:27:03.596850 [info ] [MainThread]: 
[0m17:27:03.597813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:27:03.599852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:27:03.610853 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:27:03.611826 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:27:03.611826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:03.654814 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:27:03.656813 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:27:03.659821 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:27:03.665849 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:27:03.666844 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:27:03.666844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:03.704816 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:27:03.705820 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:27:03.705820 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:27:03.712850 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:27:03.713853 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:27:03.714850 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:27:03.721815 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:03.722817 [debug] [MainThread]: On master: BEGIN
[0m17:27:03.723815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:03.760823 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:27:03.760823 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:03.761821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:27:03.772812 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:27:03.774849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A9DE9D60>]}
[0m17:27:03.775852 [debug] [MainThread]: On master: ROLLBACK
[0m17:27:03.776830 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:03.776830 [debug] [MainThread]: On master: BEGIN
[0m17:27:03.777813 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:27:03.777813 [debug] [MainThread]: On master: COMMIT
[0m17:27:03.778814 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:03.778814 [debug] [MainThread]: On master: COMMIT
[0m17:27:03.779813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:27:03.780812 [debug] [MainThread]: On master: Close
[0m17:27:03.781822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:03.782815 [info ] [MainThread]: 
[0m17:27:03.787815 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:27:03.788817 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:27:03.790814 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:27:03.791813 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:27:03.801849 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:27:03.802851 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:27:03.791813 => 17:27:03.802851
[0m17:27:03.803814 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:27:03.846851 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:27:03.847821 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:27:03.848816 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:27:03.849821 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:27:03.887815 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:27:03.888816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:27:03.888816 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:27:03.893833 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:27:03.900813 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:27:03.900813 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:27:03.901814 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:27:03.906850 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:27:03.906850 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:27:03.907850 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:27:03.929850 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:27:03.929850 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:27:03.930829 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:27:03.932864 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:27:03.939813 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:27:03.945813 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:27:03.945813 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:27:03.949253 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:27:03.951283 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:27:03.804822 => 17:27:03.951283
[0m17:27:03.951283 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:27:03.953254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AA1D4AF0>]}
[0m17:27:03.954249 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.16s]
[0m17:27:03.956248 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:27:03.957247 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:27:03.958245 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:27:03.959247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:27:03.960259 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:27:03.963246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:27:03.964254 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:27:03.960259 => 17:27:03.964254
[0m17:27:03.965246 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:27:03.984282 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:27:03.986245 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:27:03.987246 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:27:03.987246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:27:04.026159 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:27:04.027133 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:27:04.027133 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final
  );
[0m17:27:04.033159 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:27:04.036159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:27:04.037159 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp" rename to "postgress__customers_as_c"
[0m17:27:04.039167 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:27:04.041159 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:27:04.042140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:27:04.042140 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:27:04.044160 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:27:04.088131 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_backup"
[0m17:27:04.091128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:27:04.092128 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_backup" cascade
[0m17:27:04.093129 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:27:04.095152 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:27:03.965246 => 17:27:04.095152
[0m17:27:04.095152 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:27:04.097130 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AA486910>]}
[0m17:27:04.098130 [info ] [Thread-1  ]: 2 of 3 OK created sql view model intro_dbt.postgress__customers_as_c ........... [[32mCREATE VIEW[0m in 0.14s]
[0m17:27:04.099132 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:27:04.100129 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:27:04.101129 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:27:04.102128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:27:04.103131 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:27:04.107129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:27:04.108129 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:27:04.103131 => 17:27:04.107129
[0m17:27:04.109128 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:27:04.113128 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:27:04.114128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:27:04.115129 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:27:04.116129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:27:04.152160 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:27:04.153159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:27:04.154130 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:27:04.160158 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:27:04.163157 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:27:04.164158 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:27:04.165129 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:27:04.167158 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:27:04.168129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:27:04.168129 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:27:04.170130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:27:04.174157 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:27:04.175160 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:27:04.176129 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:27:04.176129 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:27:04.178159 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:27:04.109128 => 17:27:04.178159
[0m17:27:04.179158 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:27:04.180131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b605c06e-027c-4954-b446-5897e915d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AA4B19A0>]}
[0m17:27:04.182130 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.08s]
[0m17:27:04.183130 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:27:04.185129 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:04.186136 [debug] [MainThread]: On master: BEGIN
[0m17:27:04.186136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:27:04.224220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:27:04.225220 [debug] [MainThread]: On master: COMMIT
[0m17:27:04.225220 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:04.226257 [debug] [MainThread]: On master: COMMIT
[0m17:27:04.227220 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:27:04.227220 [debug] [MainThread]: On master: Close
[0m17:27:04.228227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:04.229221 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:27:04.230221 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:27:04.230221 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:27:04.231226 [info ] [MainThread]: 
[0m17:27:04.232221 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m17:27:04.233221 [debug] [MainThread]: Command end result
[0m17:27:04.244220 [info ] [MainThread]: 
[0m17:27:04.245221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:04.246221 [info ] [MainThread]: 
[0m17:27:04.246221 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:27:04.248257 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:04.248257 after 1.24 seconds
[0m17:27:04.248257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A72D37F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A9C1E2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A9B8C9A0>]}
[0m17:27:04.249255 [debug] [MainThread]: Flushing usage events
[0m17:28:21.285496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F28523A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F4D64490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F4D64310>]}


============================== 17:28:21.289496 | 1fbed156-5c5e-4ef0-86ea-69057e5b1442 ==============================
[0m17:28:21.289496 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:28:21.291499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:28:21.466496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F4DA43A0>]}
[0m17:28:21.535496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F4EF7220>]}
[0m17:28:21.537497 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:28:21.546527 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:28:21.620260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:21.621260 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:28:21.774273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F54DBF40>]}
[0m17:28:21.787260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F4DA4550>]}
[0m17:28:21.788260 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:28:21.789262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F53720D0>]}
[0m17:28:21.792268 [info ] [MainThread]: 
[0m17:28:21.794297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:28:21.795297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:28:21.806297 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:28:21.807273 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:28:21.807273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:21.856271 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:28:21.858269 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:28:21.861260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:28:21.867296 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:28:21.868295 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:28:21.869261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:21.906261 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:28:21.907263 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:28:21.908261 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:28:21.915081 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:28:21.916110 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:28:21.917084 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:28:21.923109 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:21.924076 [debug] [MainThread]: On master: BEGIN
[0m17:28:21.925076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:21.962073 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:28:21.962073 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:21.963081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:28:21.977110 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:28:21.979073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F54EBC70>]}
[0m17:28:21.980074 [debug] [MainThread]: On master: ROLLBACK
[0m17:28:21.980074 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:21.981073 [debug] [MainThread]: On master: BEGIN
[0m17:28:21.982082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:28:21.982082 [debug] [MainThread]: On master: COMMIT
[0m17:28:21.983081 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:21.983081 [debug] [MainThread]: On master: COMMIT
[0m17:28:21.984081 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:28:21.985074 [debug] [MainThread]: On master: Close
[0m17:28:21.986073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:21.987074 [info ] [MainThread]: 
[0m17:28:21.992074 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:28:21.993074 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:28:21.994110 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:28:21.994110 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:28:22.005101 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:22.007075 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:28:21.995081 => 17:28:22.006082
[0m17:28:22.007075 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:28:22.050111 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:22.051110 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:22.052084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:28:22.053088 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:28:22.089073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:28:22.090082 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:22.091077 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:28:22.096073 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:28:22.103073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:22.103073 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:28:22.104110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:28:22.109073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:22.110073 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:28:22.111082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:28:22.132111 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:28:22.133110 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:22.134086 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:28:22.135614 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:28:22.142658 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:28:22.147629 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:22.148622 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:28:22.151687 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:28:22.153726 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:28:22.008075 => 17:28:22.153726
[0m17:28:22.154693 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:28:22.155891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F5554D90>]}
[0m17:28:22.156688 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.16s]
[0m17:28:22.158690 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:28:22.159688 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:28:22.160696 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:28:22.161687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:28:22.162687 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:28:22.165686 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:28:22.166686 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:28:22.162687 => 17:28:22.166686
[0m17:28:22.167696 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:28:22.187724 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:28:22.189695 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:28:22.190689 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:28:22.190689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:28:22.229316 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:28:22.230316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:28:22.231317 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
    union all
    select 1, 2, 'f', 3, 4
)

SELECT * FROM final
  );
[0m17:28:22.232316 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "union"
LINE 13:     union all
             ^

[0m17:28:22.232316 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: ROLLBACK
[0m17:28:22.233316 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:28:22.167696 => 17:28:22.233316
[0m17:28:22.234352 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:28:22.238316 [debug] [Thread-1  ]: Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near "union"
  LINE 13:     union all
               ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:28:22.239352 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F5585520>]}
[0m17:28:22.241326 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model intro_dbt.postgress__customers_as_c ....... [[31mERROR[0m in 0.08s]
[0m17:28:22.242317 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:28:22.243316 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:28:22.244325 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:28:22.245316 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:28:22.246323 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:28:22.249326 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:22.251347 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:28:22.246323 => 17:28:22.250353
[0m17:28:22.252316 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:28:22.299316 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:22.300315 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:22.301316 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:28:22.302316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:28:22.338187 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:28:22.339176 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:22.340146 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:28:22.345182 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:28:22.349182 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:22.350153 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:28:22.351182 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:28:22.353182 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:28:22.353182 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:22.354183 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:28:22.355146 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:28:22.359147 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:28:22.363182 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:22.363182 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:28:22.364182 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:28:22.366184 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:28:22.252316 => 17:28:22.366184
[0m17:28:22.367145 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:28:22.368196 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fbed156-5c5e-4ef0-86ea-69057e5b1442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F581E2E0>]}
[0m17:28:22.369146 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:28:22.371178 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:28:22.372155 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:22.374148 [debug] [MainThread]: On master: BEGIN
[0m17:28:22.374148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:22.414158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:28:22.415182 [debug] [MainThread]: On master: COMMIT
[0m17:28:22.416145 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:22.416145 [debug] [MainThread]: On master: COMMIT
[0m17:28:22.417153 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:28:22.417153 [debug] [MainThread]: On master: Close
[0m17:28:22.419146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:22.419146 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:28:22.420147 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:28:22.420147 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:28:22.421154 [info ] [MainThread]: 
[0m17:28:22.422145 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m17:28:22.424147 [debug] [MainThread]: Command end result
[0m17:28:22.434147 [info ] [MainThread]: 
[0m17:28:22.436148 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:28:22.437148 [info ] [MainThread]: 
[0m17:28:22.438146 [error] [MainThread]:   Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  syntax error at or near "union"
  LINE 13:     union all
               ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:28:22.439147 [info ] [MainThread]: 
[0m17:28:22.440147 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:28:22.442147 [debug] [MainThread]: Command `dbt run` failed at 17:28:22.441149 after 1.23 seconds
[0m17:28:22.443146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F28523A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F4F9ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F58A7F70>]}
[0m17:28:22.443146 [debug] [MainThread]: Flushing usage events
[0m17:28:58.893677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001632FD522E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633073D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332425F40>]}


============================== 17:28:58.897670 | 823ba2f2-a672-478c-bbad-890577fe2105 ==============================
[0m17:28:58.897670 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:28:58.898670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:28:59.076893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633073D580>]}
[0m17:28:59.144926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633260BDC0>]}
[0m17:28:59.145923 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:28:59.154892 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:28:59.229892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:59.230893 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:28:59.382920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332C24F10>]}
[0m17:28:59.396893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332459AF0>]}
[0m17:28:59.397893 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:28:59.398893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163327910A0>]}
[0m17:28:59.401932 [info ] [MainThread]: 
[0m17:28:59.402900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:28:59.404929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:28:59.415929 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:28:59.416900 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:28:59.416900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:59.460362 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:28:59.462347 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:28:59.465311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:28:59.471346 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:28:59.472346 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:28:59.473330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:59.511211 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:28:59.512231 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:28:59.512231 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:28:59.519220 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:28:59.520228 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:28:59.521261 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:28:59.528256 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:59.529255 [debug] [MainThread]: On master: BEGIN
[0m17:28:59.530219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:59.568219 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:28:59.568219 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:59.569219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:28:59.582218 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:28:59.584219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332C06C70>]}
[0m17:28:59.585218 [debug] [MainThread]: On master: ROLLBACK
[0m17:28:59.586219 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:59.586219 [debug] [MainThread]: On master: BEGIN
[0m17:28:59.587219 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:28:59.587219 [debug] [MainThread]: On master: COMMIT
[0m17:28:59.588219 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:59.589231 [debug] [MainThread]: On master: COMMIT
[0m17:28:59.589231 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:28:59.590219 [debug] [MainThread]: On master: Close
[0m17:28:59.591219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:59.593222 [info ] [MainThread]: 
[0m17:28:59.597219 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:28:59.597219 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:28:59.599219 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:28:59.599219 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:28:59.608221 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:59.609222 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:28:59.600219 => 17:28:59.609222
[0m17:28:59.610221 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:28:59.652218 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:59.653229 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:59.654232 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:28:59.655219 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:28:59.691220 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:28:59.692222 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:59.693220 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:28:59.697234 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:28:59.703218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:59.704219 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:28:59.705220 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:28:59.710220 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:59.710220 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:28:59.711219 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:28:59.732218 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:28:59.733219 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:59.734219 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:28:59.735220 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:28:59.743221 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:28:59.748218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:28:59.748218 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:28:59.751219 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:28:59.753219 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:28:59.611221 => 17:28:59.753219
[0m17:28:59.754218 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:28:59.755233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332C54D60>]}
[0m17:28:59.756219 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.16s]
[0m17:28:59.759222 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:28:59.759222 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:28:59.760220 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:28:59.762257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:28:59.762257 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:28:59.765258 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:28:59.767220 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:28:59.763258 => 17:28:59.766256
[0m17:28:59.767220 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:28:59.787256 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:28:59.788256 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:28:59.789219 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:28:59.790220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:28:59.827054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:28:59.828062 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:28:59.828062 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final
union all
select 1, 2, 'f', 3, 4
  );
[0m17:28:59.830076 [debug] [Thread-1  ]: Postgres adapter: Postgres error: UNION types character varying and integer cannot be matched
LINE 17: select 1, 2, 'f', 3, 4
                ^

[0m17:28:59.830076 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: ROLLBACK
[0m17:28:59.831266 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:28:59.768257 => 17:28:59.831266
[0m17:28:59.832274 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:28:59.836274 [debug] [Thread-1  ]: Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  UNION types character varying and integer cannot be matched
  LINE 17: select 1, 2, 'f', 3, 4
                  ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:28:59.837275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332C884C0>]}
[0m17:28:59.838274 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model intro_dbt.postgress__customers_as_c ....... [[31mERROR[0m in 0.08s]
[0m17:28:59.839274 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:28:59.839274 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:28:59.841273 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:28:59.842277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:28:59.843307 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:28:59.846311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:59.848281 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:28:59.844325 => 17:28:59.847310
[0m17:28:59.848281 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:28:59.895310 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:59.896328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:59.897273 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:28:59.898282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:28:59.935275 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:28:59.936276 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:59.937276 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:28:59.942284 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:28:59.946275 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:59.947275 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:28:59.948283 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:28:59.950275 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:28:59.951275 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:59.951275 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:28:59.952941 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:28:59.955985 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:28:59.959959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:28:59.960988 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:28:59.961962 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:28:59.963987 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:28:59.849312 => 17:28:59.962956
[0m17:28:59.963987 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:28:59.965950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '823ba2f2-a672-478c-bbad-890577fe2105', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332D1E490>]}
[0m17:28:59.966986 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:28:59.967952 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:28:59.969964 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:59.970948 [debug] [MainThread]: On master: BEGIN
[0m17:28:59.970948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:00.008952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:29:00.009954 [debug] [MainThread]: On master: COMMIT
[0m17:29:00.009954 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:00.010949 [debug] [MainThread]: On master: COMMIT
[0m17:29:00.010949 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:29:00.011949 [debug] [MainThread]: On master: Close
[0m17:29:00.012949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:00.013951 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:29:00.014950 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:29:00.014950 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:29:00.015950 [info ] [MainThread]: 
[0m17:29:00.016958 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m17:29:00.018988 [debug] [MainThread]: Command end result
[0m17:29:00.028949 [info ] [MainThread]: 
[0m17:29:00.029948 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:29:00.030982 [info ] [MainThread]: 
[0m17:29:00.031957 [error] [MainThread]:   Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  UNION types character varying and integer cannot be matched
  LINE 17: select 1, 2, 'f', 3, 4
                  ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:29:00.031957 [info ] [MainThread]: 
[0m17:29:00.033957 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:29:00.034949 [debug] [MainThread]: Command `dbt run` failed at 17:29:00.034949 after 1.22 seconds
[0m17:29:00.035992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001632FD522E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633260BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332CA1790>]}
[0m17:29:00.036966 [debug] [MainThread]: Flushing usage events
[0m17:29:25.469427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26A8DFDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26CBE4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26CBD2940>]}


============================== 17:29:25.473464 | 634ae1f5-97c1-471b-9a13-91d14e1ccaa4 ==============================
[0m17:29:25.473464 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:29:25.474427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:25.648428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26CBE46A0>]}
[0m17:29:25.716427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26C5A74F0>]}
[0m17:29:25.717464 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:29:25.726429 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:29:25.801084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:25.802078 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:29:25.953053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26D55BEB0>]}
[0m17:29:25.967061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26D145F10>]}
[0m17:29:25.967061 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:29:25.969055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26CF711F0>]}
[0m17:29:25.971085 [info ] [MainThread]: 
[0m17:29:25.973054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:29:25.974054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:29:25.986084 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:29:25.986084 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:29:25.987086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:26.030290 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:29:26.032314 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:29:26.035285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:29:26.041277 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:29:26.042291 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:29:26.043279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:26.080659 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:29:26.081698 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:29:26.081698 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:29:26.088785 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:29:26.089746 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:29:26.090769 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:29:26.097768 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:26.098748 [debug] [MainThread]: On master: BEGIN
[0m17:29:26.098748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:26.135585 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:29:26.136566 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:26.136566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:29:26.150595 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:29:26.152597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26CFCC2B0>]}
[0m17:29:26.153565 [debug] [MainThread]: On master: ROLLBACK
[0m17:29:26.153565 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:26.154596 [debug] [MainThread]: On master: BEGIN
[0m17:29:26.155558 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:29:26.155558 [debug] [MainThread]: On master: COMMIT
[0m17:29:26.156595 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:26.157580 [debug] [MainThread]: On master: COMMIT
[0m17:29:26.157580 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:29:26.158595 [debug] [MainThread]: On master: Close
[0m17:29:26.159561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:26.161561 [info ] [MainThread]: 
[0m17:29:26.165566 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:29:26.166566 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:29:26.167566 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:29:26.168565 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:29:26.176559 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:26.178558 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:29:26.168565 => 17:29:26.177569
[0m17:29:26.178558 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:29:26.220596 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:26.221558 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:26.222558 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:29:26.222558 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:29:26.394033 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:29:26.395049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:26.395049 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:29:26.400024 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:29:26.407060 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:26.407060 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:29:26.408059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:26.412059 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:26.413061 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:29:26.414040 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:26.435060 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:29:26.436032 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:26.436032 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:29:26.438007 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:29:26.445052 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:29:26.450051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:26.451051 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:29:26.454060 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:29:26.456014 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:29:26.179566 => 17:29:26.456014
[0m17:29:26.457014 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:29:26.458027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26D5D4D00>]}
[0m17:29:26.460028 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.29s]
[0m17:29:26.461020 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:29:26.462016 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:29:26.463015 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:29:26.464015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:29:26.465051 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:29:26.468051 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:26.470015 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:29:26.465051 => 17:29:26.469067
[0m17:29:26.470015 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:29:26.490014 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:26.492020 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:26.493018 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:29:26.494016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:29:26.532017 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:29:26.532017 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:26.533015 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final
union all
select '1', 2, 'f', 3, 4
  );
[0m17:29:26.534022 [debug] [Thread-1  ]: Postgres adapter: Postgres error: UNION types interval and integer cannot be matched
LINE 17: select '1', 2, 'f', 3, 4
                     ^

[0m17:29:26.535015 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: ROLLBACK
[0m17:29:26.536024 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:29:26.471054 => 17:29:26.535015
[0m17:29:26.536024 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:29:26.541046 [debug] [Thread-1  ]: Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  UNION types interval and integer cannot be matched
  LINE 17: select '1', 2, 'f', 3, 4
                       ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:29:26.541046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26D808460>]}
[0m17:29:26.542052 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model intro_dbt.postgress__customers_as_c ....... [[31mERROR[0m in 0.08s]
[0m17:29:26.544017 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:29:26.545023 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:29:26.546015 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:29:26.547022 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:29:26.548023 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:29:26.551045 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:26.552014 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:29:26.548023 => 17:29:26.551045
[0m17:29:26.553022 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:29:26.600042 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:26.601014 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:26.602021 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:29:26.602021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:29:26.639054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:29:26.640015 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:26.641014 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:29:26.646058 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:29:26.650014 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:26.651014 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:29:26.652025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:26.654014 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:29:26.655015 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:26.655015 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:29:26.657056 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:29:26.661015 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:29:26.664014 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:26.665015 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:29:26.666014 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:29:26.667014 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:29:26.553022 => 17:29:26.667014
[0m17:29:26.668014 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:29:26.669021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634ae1f5-97c1-471b-9a13-91d14e1ccaa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26D89E1C0>]}
[0m17:29:26.671035 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:29:26.672018 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:29:26.674015 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:26.675065 [debug] [MainThread]: On master: BEGIN
[0m17:29:26.675065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:26.713014 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:29:26.714014 [debug] [MainThread]: On master: COMMIT
[0m17:29:26.714014 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:26.715014 [debug] [MainThread]: On master: COMMIT
[0m17:29:26.716014 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:29:26.716014 [debug] [MainThread]: On master: Close
[0m17:29:26.717014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:26.718017 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:29:26.719015 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:29:26.719015 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:29:26.720014 [info ] [MainThread]: 
[0m17:29:26.721014 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m17:29:26.723015 [debug] [MainThread]: Command end result
[0m17:29:26.732015 [info ] [MainThread]: 
[0m17:29:26.734016 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:29:26.735019 [info ] [MainThread]: 
[0m17:29:26.735019 [error] [MainThread]:   Database Error in model postgress__customers_as_c (models\Cafe_rewards_offers\postgress__customers_as_c.sql)
  UNION types interval and integer cannot be matched
  LINE 17: select '1', 2, 'f', 3, 4
                       ^
  compiled Code at target\run\dbt_postgres_demo\models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:29:26.736015 [info ] [MainThread]: 
[0m17:29:26.737015 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:29:26.738016 [debug] [MainThread]: Command `dbt run` failed at 17:29:26.738016 after 1.34 seconds
[0m17:29:26.739014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26A8DFDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26C5A74F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26CF17700>]}
[0m17:29:26.739014 [debug] [MainThread]: Flushing usage events
[0m17:29:44.861150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D165CD22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1666FD580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1681E5F40>]}


============================== 17:29:44.865149 | eb1b63f8-41ac-4348-8664-c46bfd35f401 ==============================
[0m17:29:44.865149 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:29:44.866148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:29:45.046148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1666FD580>]}
[0m17:29:45.116149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1685BBDC0>]}
[0m17:29:45.117148 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:29:45.126148 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:29:45.201148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:45.202149 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\Cafe_rewards_offers\postgress__customers_as_c.sql
[0m17:29:45.359149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D168BA4F10>]}
[0m17:29:45.372149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D168419AF0>]}
[0m17:29:45.373150 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:29:45.374149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1687410A0>]}
[0m17:29:45.378150 [info ] [MainThread]: 
[0m17:29:45.379149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:29:45.381149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:29:45.392149 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:29:45.393151 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:29:45.393151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:45.437148 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:29:45.438149 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:29:45.441150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_intro_dbt'
[0m17:29:45.448147 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:29:45.449148 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: BEGIN
[0m17:29:45.450148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:45.487148 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:29:45.488149 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_intro_dbt"
[0m17:29:45.489149 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_intro_dbt"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intro_dbt'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intro_dbt'
  
[0m17:29:45.495148 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:29:45.496149 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: ROLLBACK
[0m17:29:45.497149 [debug] [ThreadPool]: On list_Cafe_rewards_offers_intro_dbt: Close
[0m17:29:45.503148 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:45.504148 [debug] [MainThread]: On master: BEGIN
[0m17:29:45.504148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:45.542149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:29:45.543151 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:45.544151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:29:45.556149 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:29:45.558149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D168B84C70>]}
[0m17:29:45.559148 [debug] [MainThread]: On master: ROLLBACK
[0m17:29:45.560152 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:45.561151 [debug] [MainThread]: On master: BEGIN
[0m17:29:45.561151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:29:45.562150 [debug] [MainThread]: On master: COMMIT
[0m17:29:45.563148 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:45.563148 [debug] [MainThread]: On master: COMMIT
[0m17:29:45.564151 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:29:45.564151 [debug] [MainThread]: On master: Close
[0m17:29:45.565148 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:45.567152 [info ] [MainThread]: 
[0m17:29:45.570148 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:29:45.571148 [info ] [Thread-1  ]: 1 of 3 START sql table model intro_dbt.my_first_dbt_model ...................... [RUN]
[0m17:29:45.572149 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:29:45.573150 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:29:45.582148 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:45.583149 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:29:45.574149 => 17:29:45.583149
[0m17:29:45.584149 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:29:45.628149 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:45.629149 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:45.630157 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:29:45.631149 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:29:45.666149 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:29:45.666149 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:45.667149 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:29:45.671148 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:29:45.677151 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:45.678150 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:29:45.679148 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:45.683149 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:45.683149 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:29:45.684148 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:45.706148 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:29:45.706148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:45.707149 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:29:45.708149 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:29:45.716147 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup"
[0m17:29:45.721148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:29:45.721148 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model__dbt_backup" cascade
[0m17:29:45.724149 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:29:45.726149 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:29:45.584149 => 17:29:45.726149
[0m17:29:45.727154 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:29:45.728155 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D168BD4D60>]}
[0m17:29:45.730152 [info ] [Thread-1  ]: 1 of 3 OK created sql table model intro_dbt.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.16s]
[0m17:29:45.731155 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:29:45.732151 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:29:45.733151 [info ] [Thread-1  ]: 2 of 3 START sql view model intro_dbt.postgress__customers_as_c ................ [RUN]
[0m17:29:45.735158 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:29:45.736150 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:29:45.739149 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:45.741150 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:29:45.736150 => 17:29:45.740149
[0m17:29:45.741150 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:29:45.763147 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:45.765150 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:45.765150 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:29:45.766148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:29:45.803148 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:29:45.804149 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:45.805148 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final
union all
select '1', '22:22:22', 'f', 3, 4
  );
[0m17:29:45.813148 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:29:45.817148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:45.817148 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c" rename to "postgress__customers_as_c__dbt_backup"
[0m17:29:45.818148 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:45.823148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:45.863148 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_tmp" rename to "postgress__customers_as_c"
[0m17:29:45.864149 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:45.867148 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:29:45.867148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:45.868148 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:29:45.869149 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:29:45.872171 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_backup"
[0m17:29:45.875148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:29:45.876149 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."postgress__customers_as_c__dbt_backup" cascade
[0m17:29:45.878182 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:29:45.880149 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:29:45.742149 => 17:29:45.880149
[0m17:29:45.881149 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:29:45.882160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D168E87B80>]}
[0m17:29:45.883151 [info ] [Thread-1  ]: 2 of 3 OK created sql view model intro_dbt.postgress__customers_as_c ........... [[32mCREATE VIEW[0m in 0.15s]
[0m17:29:45.884149 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:29:45.885150 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:29:45.886148 [info ] [Thread-1  ]: 3 of 3 START sql view model intro_dbt.my_second_dbt_model ...................... [RUN]
[0m17:29:45.887163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:29:45.888150 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:29:45.891179 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:45.892150 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:29:45.888150 => 17:29:45.892150
[0m17:29:45.893150 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:29:45.899148 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:45.900149 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:45.901148 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:29:45.902148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:29:46.068772 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:29:46.069760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:46.069760 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."intro_dbt"."my_first_dbt_model"
where id = 1
  );
[0m17:29:46.075758 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:29:46.079786 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:46.080783 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:29:46.082121 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:29:46.084129 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:29:46.084129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:46.085129 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:29:46.086605 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:29:46.089649 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup"
[0m17:29:46.090616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:29:46.091653 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."intro_dbt"."my_second_dbt_model__dbt_backup" cascade
[0m17:29:46.092620 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:29:46.094616 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:29:45.894152 => 17:29:46.094616
[0m17:29:46.095617 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:29:46.097615 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1b63f8-41ac-4348-8664-c46bfd35f401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D168B5A670>]}
[0m17:29:46.098614 [info ] [Thread-1  ]: 3 of 3 OK created sql view model intro_dbt.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.21s]
[0m17:29:46.100615 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:29:46.101620 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:46.102650 [debug] [MainThread]: On master: BEGIN
[0m17:29:46.103625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:29:46.139634 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:29:46.140634 [debug] [MainThread]: On master: COMMIT
[0m17:29:46.141636 [debug] [MainThread]: Using postgres connection "master"
[0m17:29:46.141636 [debug] [MainThread]: On master: COMMIT
[0m17:29:46.142605 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:29:46.143599 [debug] [MainThread]: On master: Close
[0m17:29:46.144609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:46.145606 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m17:29:46.146606 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_intro_dbt' was properly closed.
[0m17:29:46.146606 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:29:46.147634 [info ] [MainThread]: 
[0m17:29:46.148607 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m17:29:46.150634 [debug] [MainThread]: Command end result
[0m17:29:46.160609 [info ] [MainThread]: 
[0m17:29:46.162600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:46.162600 [info ] [MainThread]: 
[0m17:29:46.163605 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:29:46.164598 [debug] [MainThread]: Command `dbt run` succeeded at 17:29:46.164598 after 1.38 seconds
[0m17:29:46.165634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D165CD22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D16852D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D168621E20>]}
[0m17:29:46.166603 [debug] [MainThread]: Flushing usage events
[0m17:38:50.019900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF34922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF3C7D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF5965F40>]}


============================== 17:38:50.023863 | 8ccf9929-02fa-4907-ac3a-c595625d9c0f ==============================
[0m17:38:50.023863 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:38:50.024862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:38:50.198899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF3C7D580>]}
[0m17:38:50.268893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF59A76D0>]}
[0m17:38:50.269899 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:38:50.277900 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:38:50.295862 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:38:50.297864 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:38:50.298836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF5AE6700>]}
[0m17:38:51.515871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF65200D0>]}
[0m17:38:51.527851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF5BB1A90>]}
[0m17:38:51.528843 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:38:51.530846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF5E1FD00>]}
[0m17:38:51.532882 [info ] [MainThread]: 
[0m17:38:51.533858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:51.535844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:38:51.548843 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:38:51.549853 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:38:51.549853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:51.594850 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:38:51.596845 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:38:51.600843 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:38:51.600843 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:38:51.601843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:51.637843 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:38:51.639843 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:38:51.641844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers, now create_Cafe_rewards_offers_staging_bronze_layer)
[0m17:38:51.642844 [debug] [ThreadPool]: Creating schema "database: "Cafe_rewards_offers"
schema: "staging_bronze_layer"
"
[0m17:38:51.648842 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging_bronze_layer"
[0m17:38:51.649843 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_bronze_layer: BEGIN
[0m17:38:51.649843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:51.685844 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:38:51.686843 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging_bronze_layer"
[0m17:38:51.686843 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_Cafe_rewards_offers_staging_bronze_layer"} */
create schema if not exists "staging_bronze_layer"
[0m17:38:51.688843 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:38:51.689848 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_bronze_layer: COMMIT
[0m17:38:51.690843 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging_bronze_layer"
[0m17:38:51.690843 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_bronze_layer: COMMIT
[0m17:38:51.692844 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:38:51.692844 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_bronze_layer: Close
[0m17:38:51.694844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_Cafe_rewards_offers_staging_bronze_layer, now create_Cafe_rewards_offers_staging_staging)
[0m17:38:51.696847 [debug] [ThreadPool]: Creating schema "database: "Cafe_rewards_offers"
schema: "staging_staging"
"
[0m17:38:51.699842 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging_staging"
[0m17:38:51.699842 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_staging: BEGIN
[0m17:38:51.700843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:51.737843 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:38:51.738844 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging_staging"
[0m17:38:51.739844 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_Cafe_rewards_offers_staging_staging"} */
create schema if not exists "staging_staging"
[0m17:38:51.740844 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:38:51.742843 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_staging: COMMIT
[0m17:38:51.742843 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging_staging"
[0m17:38:51.743843 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_staging: COMMIT
[0m17:38:51.744843 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:38:51.745843 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging_staging: Close
[0m17:38:51.748845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_staging_bronze_layer'
[0m17:38:51.754843 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging_bronze_layer"
[0m17:38:51.755842 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging_bronze_layer: BEGIN
[0m17:38:51.756849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:51.791843 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:38:51.792843 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging_bronze_layer"
[0m17:38:51.793843 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_bronze_layer'
  
[0m17:38:51.799843 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:38:51.801843 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging_bronze_layer: ROLLBACK
[0m17:38:51.802843 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging_bronze_layer: Close
[0m17:38:51.803844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_staging_bronze_layer, now list_Cafe_rewards_offers_staging_staging)
[0m17:38:51.806843 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging_staging"
[0m17:38:51.807843 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging_staging: BEGIN
[0m17:38:51.807843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:51.844084 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:38:51.845121 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging_staging"
[0m17:38:51.846086 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m17:38:51.853091 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:38:51.854121 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging_staging: ROLLBACK
[0m17:38:51.855091 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging_staging: Close
[0m17:38:51.860120 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:51.861121 [debug] [MainThread]: On master: BEGIN
[0m17:38:51.862085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:51.900092 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:51.900092 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:51.901115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:51.915084 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:38:51.916084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF687FBB0>]}
[0m17:38:51.917084 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:51.918084 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:51.918084 [debug] [MainThread]: On master: BEGIN
[0m17:38:51.919084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:51.920084 [debug] [MainThread]: On master: COMMIT
[0m17:38:51.920084 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:51.921084 [debug] [MainThread]: On master: COMMIT
[0m17:38:51.921084 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:38:51.922084 [debug] [MainThread]: On master: Close
[0m17:38:51.923084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:51.924096 [info ] [MainThread]: 
[0m17:38:51.929084 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:38:51.930086 [info ] [Thread-1  ]: 1 of 3 START sql table model staging_staging.my_first_dbt_model ................ [RUN]
[0m17:38:51.932085 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:38:51.932085 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:38:51.942123 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:38:51.943086 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:38:51.933084 => 17:38:51.943086
[0m17:38:51.944084 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:38:51.985084 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:38:51.987084 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:38:51.987084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:38:51.988084 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:38:52.025084 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:38:52.026084 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:38:52.027084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."staging_staging"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:38:52.032085 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:38:52.039083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:38:52.040083 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."staging_staging"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:38:52.041084 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:38:52.060083 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:38:52.061083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:38:52.062084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:38:52.064085 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:38:52.071083 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."staging_staging"."my_first_dbt_model__dbt_backup"
[0m17:38:52.076083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:38:52.077084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."staging_staging"."my_first_dbt_model__dbt_backup" cascade
[0m17:38:52.078084 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:38:52.080086 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:38:51.945100 => 17:38:52.080086
[0m17:38:52.081086 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:38:52.082095 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF65680D0>]}
[0m17:38:52.084098 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging_staging.my_first_dbt_model ........... [[32mSELECT 2[0m in 0.15s]
[0m17:38:52.085090 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:38:52.086093 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:38:52.087115 [info ] [Thread-1  ]: 2 of 3 START sql view model staging_bronze_layer.postgress__customers_as_c ..... [RUN]
[0m17:38:52.088085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:38:52.089084 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:38:52.092121 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:38:52.094094 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:38:52.089084 => 17:38:52.093097
[0m17:38:52.095086 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:38:52.117120 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:38:52.118137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:38:52.119084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:38:52.120116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:38:52.159084 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:38:52.160083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:38:52.160083 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."staging_bronze_layer"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final
union all
select '1', '22:22:22', 'f', 3, 4
  );
[0m17:38:52.167084 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:38:52.170123 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:38:52.171120 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."staging_bronze_layer"."postgress__customers_as_c__dbt_tmp" rename to "postgress__customers_as_c"
[0m17:38:52.172104 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:38:52.174121 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:38:52.175120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:38:52.176092 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:38:52.177084 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:38:52.181123 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."staging_bronze_layer"."postgress__customers_as_c__dbt_backup"
[0m17:38:52.184122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:38:52.185121 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
drop view if exists "Cafe_rewards_offers"."staging_bronze_layer"."postgress__customers_as_c__dbt_backup" cascade
[0m17:38:52.186092 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:38:52.188121 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:38:52.095086 => 17:38:52.187092
[0m17:38:52.188121 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:38:52.190085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF6835AF0>]}
[0m17:38:52.191089 [info ] [Thread-1  ]: 2 of 3 OK created sql view model staging_bronze_layer.postgress__customers_as_c  [[32mCREATE VIEW[0m in 0.10s]
[0m17:38:52.193085 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:38:52.193085 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:38:52.194092 [info ] [Thread-1  ]: 3 of 3 START sql view model staging_staging.my_second_dbt_model ................ [RUN]
[0m17:38:52.196085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:38:52.196085 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:38:52.200084 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:38:52.201090 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:38:52.197086 => 17:38:52.201090
[0m17:38:52.202084 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:38:52.207084 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:38:52.208084 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:38:52.209085 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:38:52.210085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:38:52.247086 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:38:52.248085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:38:52.248085 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."staging_staging"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."staging_staging"."my_first_dbt_model"
where id = 1
  );
[0m17:38:52.253092 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:38:52.257121 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:38:52.257121 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."staging_staging"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:38:52.258119 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:38:52.260120 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:38:52.261119 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:38:52.262084 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:38:52.264086 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:38:52.267120 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."staging_staging"."my_second_dbt_model__dbt_backup"
[0m17:38:52.268134 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:38:52.269119 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."staging_staging"."my_second_dbt_model__dbt_backup" cascade
[0m17:38:52.270085 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:38:52.272122 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:38:52.202084 => 17:38:52.271091
[0m17:38:52.272122 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:38:52.274085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ccf9929-02fa-4907-ac3a-c595625d9c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF65D81F0>]}
[0m17:38:52.275098 [info ] [Thread-1  ]: 3 of 3 OK created sql view model staging_staging.my_second_dbt_model ........... [[32mCREATE VIEW[0m in 0.08s]
[0m17:38:52.276084 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:38:52.278085 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:52.279084 [debug] [MainThread]: On master: BEGIN
[0m17:38:52.280086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:52.317086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:52.317086 [debug] [MainThread]: On master: COMMIT
[0m17:38:52.318084 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:52.318084 [debug] [MainThread]: On master: COMMIT
[0m17:38:52.319084 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:38:52.320105 [debug] [MainThread]: On master: Close
[0m17:38:52.321085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:52.322085 [debug] [MainThread]: Connection 'create_Cafe_rewards_offers_staging_staging' was properly closed.
[0m17:38:52.322085 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_staging_staging' was properly closed.
[0m17:38:52.323088 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:38:52.323088 [info ] [MainThread]: 
[0m17:38:52.324121 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m17:38:52.326122 [debug] [MainThread]: Command end result
[0m17:38:52.337085 [info ] [MainThread]: 
[0m17:38:52.338085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:52.339085 [info ] [MainThread]: 
[0m17:38:52.340085 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:38:52.341085 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:52.341085 after 2.40 seconds
[0m17:38:52.342085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF34922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF5B1C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF5F722E0>]}
[0m17:38:52.342085 [debug] [MainThread]: Flushing usage events
[0m17:40:07.408650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64649FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6489A4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C648992940>]}


============================== 17:40:07.412680 | 005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8 ==============================
[0m17:40:07.412680 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:40:07.413652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:07.590048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6489A46A0>]}
[0m17:40:07.659070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6481644F0>]}
[0m17:40:07.660049 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:40:07.669081 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:40:07.686107 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:40:07.687420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C648BD26A0>]}
[0m17:40:08.903435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64955D0D0>]}
[0m17:40:08.917430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C648BDE670>]}
[0m17:40:08.918446 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:40:08.919440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6490EBF40>]}
[0m17:40:08.921466 [info ] [MainThread]: 
[0m17:40:08.922428 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:08.924436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:40:08.936464 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:40:08.937428 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:40:08.937428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:08.981465 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:40:08.983438 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:40:08.987465 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:40:08.988427 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:40:08.989440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:09.028464 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:40:09.030464 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:40:09.032431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers, now create_Cafe_rewards_offers_public_staging)
[0m17:40:09.033430 [debug] [ThreadPool]: Creating schema "database: "Cafe_rewards_offers"
schema: "public_staging"
"
[0m17:40:09.039464 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_public_staging"
[0m17:40:09.040434 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_staging: BEGIN
[0m17:40:09.040434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:09.078465 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.079464 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_public_staging"
[0m17:40:09.080435 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_Cafe_rewards_offers_public_staging"} */
create schema if not exists "public_staging"
[0m17:40:09.081467 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:40:09.083461 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_staging: COMMIT
[0m17:40:09.084446 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_public_staging"
[0m17:40:09.084446 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_staging: COMMIT
[0m17:40:09.085440 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:40:09.086464 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_staging: Close
[0m17:40:09.088430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_Cafe_rewards_offers_public_staging, now create_Cafe_rewards_offers_public_bronze_layer)
[0m17:40:09.089444 [debug] [ThreadPool]: Creating schema "database: "Cafe_rewards_offers"
schema: "public_bronze_layer"
"
[0m17:40:09.092427 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_public_bronze_layer"
[0m17:40:09.093428 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_bronze_layer: BEGIN
[0m17:40:09.094428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:09.129464 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.130465 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_public_bronze_layer"
[0m17:40:09.131450 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_Cafe_rewards_offers_public_bronze_layer"} */
create schema if not exists "public_bronze_layer"
[0m17:40:09.133460 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:40:09.134462 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_bronze_layer: COMMIT
[0m17:40:09.135464 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_public_bronze_layer"
[0m17:40:09.136435 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_bronze_layer: COMMIT
[0m17:40:09.137428 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:40:09.138436 [debug] [ThreadPool]: On create_Cafe_rewards_offers_public_bronze_layer: Close
[0m17:40:09.141429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_public_staging'
[0m17:40:09.147464 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_public_staging"
[0m17:40:09.148462 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public_staging: BEGIN
[0m17:40:09.149431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:09.186441 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.186441 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_public_staging"
[0m17:40:09.187435 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_public_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m17:40:09.193465 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:40:09.194465 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public_staging: ROLLBACK
[0m17:40:09.195480 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public_staging: Close
[0m17:40:09.196428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_public_staging, now list_Cafe_rewards_offers_public_bronze_layer)
[0m17:40:09.200429 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_public_bronze_layer"
[0m17:40:09.200429 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public_bronze_layer: BEGIN
[0m17:40:09.201429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:09.236464 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.237465 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_public_bronze_layer"
[0m17:40:09.238435 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_public_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze_layer'
  
[0m17:40:09.243465 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:40:09.244435 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public_bronze_layer: ROLLBACK
[0m17:40:09.245464 [debug] [ThreadPool]: On list_Cafe_rewards_offers_public_bronze_layer: Close
[0m17:40:09.251428 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:09.252428 [debug] [MainThread]: On master: BEGIN
[0m17:40:09.252428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:09.300430 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.301471 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:09.302428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:40:09.315428 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:40:09.317428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6495440A0>]}
[0m17:40:09.317428 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:09.318427 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:09.319427 [debug] [MainThread]: On master: BEGIN
[0m17:40:09.319427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.320464 [debug] [MainThread]: On master: COMMIT
[0m17:40:09.321437 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:09.321437 [debug] [MainThread]: On master: COMMIT
[0m17:40:09.322435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:40:09.322435 [debug] [MainThread]: On master: Close
[0m17:40:09.324428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:09.325432 [info ] [MainThread]: 
[0m17:40:09.328432 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:40:09.329428 [info ] [Thread-1  ]: 1 of 3 START sql table model public_staging.my_first_dbt_model ................. [RUN]
[0m17:40:09.331465 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:40:09.331465 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:40:09.341463 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:40:09.342483 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:40:09.332429 => 17:40:09.342483
[0m17:40:09.343435 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:40:09.385465 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:40:09.386428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:40:09.386428 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:40:09.387428 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:40:09.425436 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.425436 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:40:09.426464 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."public_staging"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:40:09.431428 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:40:09.438431 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:40:09.439428 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."public_staging"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:40:09.440429 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:40:09.459428 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:40:09.460428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:40:09.461428 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:40:09.462712 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:40:09.469720 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."public_staging"."my_first_dbt_model__dbt_backup"
[0m17:40:09.475720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:40:09.475720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."public_staging"."my_first_dbt_model__dbt_backup" cascade
[0m17:40:09.476720 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:40:09.478721 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:40:09.344427 => 17:40:09.478721
[0m17:40:09.479720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:40:09.480720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6495176A0>]}
[0m17:40:09.481728 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public_staging.my_first_dbt_model ............ [[32mSELECT 2[0m in 0.15s]
[0m17:40:09.483727 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:40:09.484721 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:40:09.485753 [info ] [Thread-1  ]: 2 of 3 START sql view model public_bronze_layer.postgress__customers_as_c ...... [RUN]
[0m17:40:09.487761 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:40:09.487761 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:40:09.491756 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:40:09.492726 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:40:09.488758 => 17:40:09.492726
[0m17:40:09.493720 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:40:09.514747 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:40:09.515724 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:40:09.516723 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:40:09.517723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:09.554728 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.555720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:40:09.555720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."public_bronze_layer"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final
union all
select '1', '22:22:22', 'f', 3, 4
  );
[0m17:40:09.561756 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:40:09.567745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:40:09.568727 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."public_bronze_layer"."postgress__customers_as_c__dbt_tmp" rename to "postgress__customers_as_c"
[0m17:40:09.569720 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:40:09.571720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:40:09.571720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:40:09.572720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:40:09.574720 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:40:09.577720 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."public_bronze_layer"."postgress__customers_as_c__dbt_backup"
[0m17:40:09.580719 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:40:09.581719 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
drop view if exists "Cafe_rewards_offers"."public_bronze_layer"."postgress__customers_as_c__dbt_backup" cascade
[0m17:40:09.582721 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:40:09.584720 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:40:09.493720 => 17:40:09.584720
[0m17:40:09.585727 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:40:09.586722 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6495D1F10>]}
[0m17:40:09.587752 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public_bronze_layer.postgress__customers_as_c . [[32mCREATE VIEW[0m in 0.10s]
[0m17:40:09.589721 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:40:09.590729 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:40:09.590729 [info ] [Thread-1  ]: 3 of 3 START sql view model public_staging.my_second_dbt_model ................. [RUN]
[0m17:40:09.592720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:40:09.593720 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:40:09.596757 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:40:09.598721 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:40:09.594721 => 17:40:09.597757
[0m17:40:09.599732 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:40:09.604720 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:40:09.605720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:40:09.606720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:40:09.607719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:09.647727 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.648720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:40:09.649722 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."public_staging"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."public_staging"."my_first_dbt_model"
where id = 1
  );
[0m17:40:09.654719 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:40:09.658747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:40:09.659720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."public_staging"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:40:09.660755 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:40:09.662720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:40:09.663720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:40:09.664720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:40:09.666729 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:40:09.669720 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."public_staging"."my_second_dbt_model__dbt_backup"
[0m17:40:09.670726 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:40:09.671720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."public_staging"."my_second_dbt_model__dbt_backup" cascade
[0m17:40:09.672721 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:40:09.674720 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:40:09.599732 => 17:40:09.673720
[0m17:40:09.674720 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:40:09.676721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005fa1f4-63eb-459c-ae5f-4c6fd1fca8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C649599C70>]}
[0m17:40:09.677722 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public_staging.my_second_dbt_model ............ [[32mCREATE VIEW[0m in 0.08s]
[0m17:40:09.678725 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:40:09.680720 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:09.681748 [debug] [MainThread]: On master: BEGIN
[0m17:40:09.682727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:09.717720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:40:09.718721 [debug] [MainThread]: On master: COMMIT
[0m17:40:09.719721 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:09.720721 [debug] [MainThread]: On master: COMMIT
[0m17:40:09.720721 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:40:09.721720 [debug] [MainThread]: On master: Close
[0m17:40:09.722720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:09.723723 [debug] [MainThread]: Connection 'create_Cafe_rewards_offers_public_bronze_layer' was properly closed.
[0m17:40:09.723723 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_public_bronze_layer' was properly closed.
[0m17:40:09.724721 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:40:09.724721 [info ] [MainThread]: 
[0m17:40:09.725720 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m17:40:09.727721 [debug] [MainThread]: Command end result
[0m17:40:09.737721 [info ] [MainThread]: 
[0m17:40:09.738721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:09.739720 [info ] [MainThread]: 
[0m17:40:09.740720 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:40:09.741720 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:09.741720 after 2.41 seconds
[0m17:40:09.742719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C64649FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6481644F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6490C5BB0>]}
[0m17:40:09.742719 [debug] [MainThread]: Flushing usage events
[0m17:49:38.033876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC66E923A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC693A4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC693A4310>]}


============================== 17:49:38.039874 | 42319a77-c07e-4558-b1f4-40ca89f698c1 ==============================
[0m17:49:38.039874 [info ] [MainThread]: Running with dbt=1.7.18
[0m17:49:38.040876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:38.226904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC693C7820>]}
[0m17:49:38.298873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC6981F610>]}
[0m17:49:38.299873 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m17:49:38.309904 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m17:49:38.389356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:49:38.390326 [debug] [MainThread]: Partial parsing: added file: dbt_postgres_demo://macros\generate_schema_name.sql
[0m17:49:38.392325 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m17:49:39.614348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC6A2370D0>]}
[0m17:49:39.628348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC699AAAC0>]}
[0m17:49:39.629348 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m17:49:39.630348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC699AAB50>]}
[0m17:49:39.632378 [info ] [MainThread]: 
[0m17:49:39.633373 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:49:39.636350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m17:49:39.647378 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:49:39.648348 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:49:39.648348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:39.694379 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:49:39.695377 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:49:39.700355 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m17:49:39.701349 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m17:49:39.701349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:39.742349 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:49:39.744348 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m17:49:39.746348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers, now create_Cafe_rewards_offers_bronze_layer)
[0m17:49:39.747348 [debug] [ThreadPool]: Creating schema "database: "Cafe_rewards_offers"
schema: "bronze_layer"
"
[0m17:49:39.753349 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_bronze_layer"
[0m17:49:39.754349 [debug] [ThreadPool]: On create_Cafe_rewards_offers_bronze_layer: BEGIN
[0m17:49:39.755353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:39.791347 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:49:39.792349 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_bronze_layer"
[0m17:49:39.793349 [debug] [ThreadPool]: On create_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_Cafe_rewards_offers_bronze_layer"} */
create schema if not exists "bronze_layer"
[0m17:49:39.795349 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:49:39.796348 [debug] [ThreadPool]: On create_Cafe_rewards_offers_bronze_layer: COMMIT
[0m17:49:39.796348 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_bronze_layer"
[0m17:49:39.797347 [debug] [ThreadPool]: On create_Cafe_rewards_offers_bronze_layer: COMMIT
[0m17:49:39.798348 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:49:39.799349 [debug] [ThreadPool]: On create_Cafe_rewards_offers_bronze_layer: Close
[0m17:49:39.801349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_Cafe_rewards_offers_bronze_layer, now create_Cafe_rewards_offers_staging)
[0m17:49:39.803351 [debug] [ThreadPool]: Creating schema "database: "Cafe_rewards_offers"
schema: "staging"
"
[0m17:49:39.806348 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging"
[0m17:49:39.807348 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging: BEGIN
[0m17:49:39.807348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:39.847348 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:49:39.848349 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging"
[0m17:49:39.848349 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_Cafe_rewards_offers_staging"} */
create schema if not exists "staging"
[0m17:49:39.850349 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:49:39.851348 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging: COMMIT
[0m17:49:39.852349 [debug] [ThreadPool]: Using postgres connection "create_Cafe_rewards_offers_staging"
[0m17:49:39.853352 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging: COMMIT
[0m17:49:39.854350 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:49:39.855356 [debug] [ThreadPool]: On create_Cafe_rewards_offers_staging: Close
[0m17:49:39.858350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_bronze_layer'
[0m17:49:39.864349 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m17:49:39.865348 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: BEGIN
[0m17:49:39.866349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:39.904351 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:49:39.905350 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m17:49:39.905350 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_layer'
  
[0m17:49:39.911347 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:49:39.912360 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: ROLLBACK
[0m17:49:39.913348 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: Close
[0m17:49:39.915349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_bronze_layer, now list_Cafe_rewards_offers_staging)
[0m17:49:39.918348 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m17:49:39.918348 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: BEGIN
[0m17:49:39.919349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:39.957348 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:49:39.958348 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m17:49:39.958348 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:49:39.963348 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:49:39.965348 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: ROLLBACK
[0m17:49:39.966361 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: Close
[0m17:49:39.972347 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:39.973348 [debug] [MainThread]: On master: BEGIN
[0m17:49:39.974348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:40.010347 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:49:40.011348 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:40.011348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:49:40.025379 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:49:40.027378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC6983FD30>]}
[0m17:49:40.028349 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:40.028349 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:40.029349 [debug] [MainThread]: On master: BEGIN
[0m17:49:40.030363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:49:40.031349 [debug] [MainThread]: On master: COMMIT
[0m17:49:40.031349 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:40.032350 [debug] [MainThread]: On master: COMMIT
[0m17:49:40.032350 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:49:40.033378 [debug] [MainThread]: On master: Close
[0m17:49:40.034350 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:40.036351 [info ] [MainThread]: 
[0m17:49:40.040380 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:49:40.041381 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.my_first_dbt_model ........................ [RUN]
[0m17:49:40.043379 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m17:49:40.044348 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m17:49:40.053351 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:49:40.055484 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 17:49:40.044348 => 17:49:40.054524
[0m17:49:40.055484 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m17:49:40.098481 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:49:40.100486 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:49:40.100486 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m17:49:40.101482 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:49:40.140482 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:49:40.141483 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:49:40.141483 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."staging"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:49:40.146496 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m17:49:40.154494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:49:40.155482 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."staging"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:49:40.156482 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:40.177484 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:49:40.178483 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:49:40.179482 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m17:49:40.180486 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:49:40.189483 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."staging"."my_first_dbt_model__dbt_backup"
[0m17:49:40.194482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m17:49:40.195483 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."staging"."my_first_dbt_model__dbt_backup" cascade
[0m17:49:40.196483 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m17:49:40.198482 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 17:49:40.056514 => 17:49:40.197482
[0m17:49:40.198482 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m17:49:40.200483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC6A22D340>]}
[0m17:49:40.201483 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.16s]
[0m17:49:40.203487 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m17:49:40.204485 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:49:40.205485 [info ] [Thread-1  ]: 2 of 3 START sql view model bronze_layer.postgress__customers_as_c ............. [RUN]
[0m17:49:40.206483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m17:49:40.207483 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:49:40.210481 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:49:40.212482 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 17:49:40.207483 => 17:49:40.211481
[0m17:49:40.212482 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:49:40.234499 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:49:40.236505 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:49:40.237503 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m17:49:40.238499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:40.275499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:49:40.276499 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:49:40.276499 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final
union all
select '1', '22:22:22', 'f', 3, 4
  );
[0m17:49:40.281498 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:49:40.286502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:49:40.287500 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c__dbt_tmp" rename to "postgress__customers_as_c"
[0m17:49:40.288500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:40.290498 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:49:40.291498 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:49:40.291498 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m17:49:40.293499 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:49:40.296497 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c__dbt_backup"
[0m17:49:40.299497 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m17:49:40.300498 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
drop view if exists "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c__dbt_backup" cascade
[0m17:49:40.301498 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:49:40.304499 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 17:49:40.213482 => 17:49:40.303501
[0m17:49:40.304499 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m17:49:40.305499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC6996ECA0>]}
[0m17:49:40.307500 [info ] [Thread-1  ]: 2 of 3 OK created sql view model bronze_layer.postgress__customers_as_c ........ [[32mCREATE VIEW[0m in 0.10s]
[0m17:49:40.308501 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m17:49:40.309499 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:49:40.310505 [info ] [Thread-1  ]: 3 of 3 START sql view model staging.my_second_dbt_model ........................ [RUN]
[0m17:49:40.311499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m17:49:40.311499 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m17:49:40.315498 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:49:40.316499 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 17:49:40.312498 => 17:49:40.315498
[0m17:49:40.316499 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m17:49:40.322497 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:49:40.324500 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:49:40.324500 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m17:49:40.325498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:40.363499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:49:40.364522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:49:40.365528 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."staging"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id = 1
  );
[0m17:49:40.370499 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:49:40.374498 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:49:40.375498 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."staging"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:49:40.376497 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:49:40.378511 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:49:40.379541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:49:40.379541 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m17:49:40.381530 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:49:40.384527 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."staging"."my_second_dbt_model__dbt_backup"
[0m17:49:40.386502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m17:49:40.387499 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."staging"."my_second_dbt_model__dbt_backup" cascade
[0m17:49:40.388500 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:49:40.390529 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 17:49:40.317499 => 17:49:40.389528
[0m17:49:40.390529 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m17:49:40.392500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42319a77-c07e-4558-b1f4-40ca89f698c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC6A29BB80>]}
[0m17:49:40.393510 [info ] [Thread-1  ]: 3 of 3 OK created sql view model staging.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:49:40.394501 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m17:49:40.396508 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:40.397521 [debug] [MainThread]: On master: BEGIN
[0m17:49:40.397521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:40.437505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:49:40.438506 [debug] [MainThread]: On master: COMMIT
[0m17:49:40.439509 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:40.439509 [debug] [MainThread]: On master: COMMIT
[0m17:49:40.440499 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:49:40.440499 [debug] [MainThread]: On master: Close
[0m17:49:40.441499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:40.442498 [debug] [MainThread]: Connection 'create_Cafe_rewards_offers_staging' was properly closed.
[0m17:49:40.443499 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_staging' was properly closed.
[0m17:49:40.443499 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m17:49:40.444500 [info ] [MainThread]: 
[0m17:49:40.445500 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m17:49:40.446498 [debug] [MainThread]: Command end result
[0m17:49:40.457528 [info ] [MainThread]: 
[0m17:49:40.458499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:40.459530 [info ] [MainThread]: 
[0m17:49:40.460499 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:49:40.461499 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:40.461499 after 2.51 seconds
[0m17:49:40.462499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC66E923A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC69515760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC699AAA00>]}
[0m17:49:40.463499 [debug] [MainThread]: Flushing usage events
[0m18:06:26.102683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF4F8123A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF50191490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF51D08760>]}


============================== 18:06:26.108682 | 0bb9c9db-0bb9-42db-ab86-60a709bdf1a9 ==============================
[0m18:06:26.108682 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:06:26.109681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:06:26.295704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bb9c9db-0bb9-42db-ab86-60a709bdf1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF50191490>]}
[0m18:06:26.370681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bb9c9db-0bb9-42db-ab86-60a709bdf1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF51EB71F0>]}
[0m18:06:26.372682 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m18:06:26.381711 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m18:06:26.462681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:26.463718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:26.469678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bb9c9db-0bb9-42db-ab86-60a709bdf1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF5236A0D0>]}
[0m18:06:26.482680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bb9c9db-0bb9-42db-ab86-60a709bdf1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF5228C220>]}
[0m18:06:26.483681 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m18:06:26.484681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb9c9db-0bb9-42db-ab86-60a709bdf1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF5228C340>]}
[0m18:06:26.486718 [info ] [MainThread]: 
[0m18:06:26.488681 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:26.490693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_bronze_layer'
[0m18:06:26.501716 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:06:26.502721 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: BEGIN
[0m18:06:26.502721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:26.547687 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:06:26.547687 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:06:26.548716 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_layer'
  
[0m18:06:26.554717 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:06:26.556683 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: ROLLBACK
[0m18:06:26.557682 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: Close
[0m18:06:26.559680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_bronze_layer, now list_Cafe_rewards_offers_staging)
[0m18:06:26.562679 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:06:26.563679 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: BEGIN
[0m18:06:26.564679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:26.604687 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:06:26.605684 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:06:26.606681 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:06:26.612717 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:06:26.614680 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: ROLLBACK
[0m18:06:26.615679 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: Close
[0m18:06:26.622683 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.623682 [debug] [MainThread]: On master: BEGIN
[0m18:06:26.624681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:26.663722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:06:26.664718 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.665688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:26.679678 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:06:26.681716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb9c9db-0bb9-42db-ab86-60a709bdf1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF5236A2E0>]}
[0m18:06:26.682716 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:26.683691 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.683691 [debug] [MainThread]: On master: BEGIN
[0m18:06:26.684716 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:06:26.685689 [debug] [MainThread]: On master: COMMIT
[0m18:06:26.685689 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:26.686693 [debug] [MainThread]: On master: COMMIT
[0m18:06:26.687682 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:06:26.688682 [debug] [MainThread]: On master: Close
[0m18:06:26.690682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:26.691681 [info ] [MainThread]: 
[0m18:06:26.696680 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:06:26.696680 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:06:26.698679 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710'
[0m18:06:26.698679 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:06:26.719680 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:06:26.721680 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:06:26.699680 => 18:06:26.720715
[0m18:06:26.722687 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:06:26.739683 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:06:26.742682 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:06:26.742682 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:06:26.743680 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:06:26.784679 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:06:26.785680 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:06:26.786679 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:06:26.788682 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:06:26.791681 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:06:26.722687 => 18:06:26.791681
[0m18:06:26.792682 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:06:26.793682 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:06:26.794681 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.10s]
[0m18:06:26.796682 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:06:26.797680 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:06:26.798684 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:06:26.799689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778)
[0m18:06:26.800693 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:06:26.806682 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:06:26.808684 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:06:26.800693 => 18:06:26.807687
[0m18:06:26.809681 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:06:26.812680 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:06:26.813680 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:06:26.814696 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:06:26.814696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:26.990813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:06:26.991812 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:06:26.992811 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Cafe_rewards_offers"."staging"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:06:26.993811 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:06:26.995813 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:06:26.809681 => 18:06:26.995813
[0m18:06:26.996813 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:06:26.997812 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:06:26.998824 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.20s]
[0m18:06:27.000814 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:06:27.000814 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:06:27.001812 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:06:27.002812 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321)
[0m18:06:27.003812 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:06:27.011811 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:06:27.012813 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (compile): 18:06:27.003812 => 18:06:27.012813
[0m18:06:27.013812 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:06:27.017811 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:06:27.019812 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:06:27.019812 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:06:27.020812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:27.059813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:06:27.059813 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:06:27.060811 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:06:27.062812 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:06:27.064812 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (execute): 18:06:27.014814 => 18:06:27.064812
[0m18:06:27.065819 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:06:27.066812 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:06:27.067812 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
[0m18:06:27.068816 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:06:27.069813 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:06:27.070812 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:06:27.072814 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321, now test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:06:27.073813 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:06:27.077812 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:06:27.079811 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:06:27.073813 => 18:06:27.079811
[0m18:06:27.080812 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:06:27.083811 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:06:27.084812 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:06:27.085812 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:06:27.085812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:27.125812 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:06:27.126812 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:06:27.127811 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Cafe_rewards_offers"."staging"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:06:27.129811 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:06:27.131813 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:06:27.080812 => 18:06:27.130813
[0m18:06:27.131813 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:06:27.132812 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:06:27.133826 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m18:06:27.135815 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:06:27.137812 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:27.139815 [debug] [MainThread]: On master: BEGIN
[0m18:06:27.140827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:27.178812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:06:27.179811 [debug] [MainThread]: On master: COMMIT
[0m18:06:27.180812 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:27.180812 [debug] [MainThread]: On master: COMMIT
[0m18:06:27.181811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:06:27.181811 [debug] [MainThread]: On master: Close
[0m18:06:27.182811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:27.183812 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_staging' was properly closed.
[0m18:06:27.184822 [debug] [MainThread]: Connection 'test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:06:27.184822 [info ] [MainThread]: 
[0m18:06:27.186813 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m18:06:27.188814 [debug] [MainThread]: Command end result
[0m18:06:27.198813 [info ] [MainThread]: 
[0m18:06:27.199813 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:06:27.200812 [info ] [MainThread]: 
[0m18:06:27.200812 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m18:06:27.202813 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:06:27.203812 [info ] [MainThread]: 
[0m18:06:27.203812 [info ] [MainThread]:   compiled Code at target\compiled\dbt_postgres_demo\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m18:06:27.206814 [info ] [MainThread]: 
[0m18:06:27.207824 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:06:27.209813 [debug] [MainThread]: Command `dbt test` failed at 18:06:27.209813 after 1.19 seconds
[0m18:06:27.210812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF4F8123A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF5228C160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF5228C220>]}
[0m18:06:27.210812 [debug] [MainThread]: Flushing usage events
[0m18:07:29.199641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D62C123A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D635D1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D65148760>]}


============================== 18:07:29.203640 | 9346feb5-a5c7-41e0-8e48-eb68186745e9 ==============================
[0m18:07:29.203640 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:07:29.204640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:29.414187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9346feb5-a5c7-41e0-8e48-eb68186745e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D635D1490>]}
[0m18:07:29.509189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9346feb5-a5c7-41e0-8e48-eb68186745e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D652E81F0>]}
[0m18:07:29.511195 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m18:07:29.519225 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m18:07:29.595202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:29.596225 [debug] [MainThread]: Partial parsing: updated file: dbt_postgres_demo://models\example\my_first_dbt_model.sql
[0m18:07:30.098710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9346feb5-a5c7-41e0-8e48-eb68186745e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D65C220D0>]}
[0m18:07:30.112712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9346feb5-a5c7-41e0-8e48-eb68186745e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6568C160>]}
[0m18:07:30.112712 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m18:07:30.113711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9346feb5-a5c7-41e0-8e48-eb68186745e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D6568C340>]}
[0m18:07:30.116711 [info ] [MainThread]: 
[0m18:07:30.117712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:07:30.118711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_bronze_layer'
[0m18:07:30.131710 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:07:30.132711 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: BEGIN
[0m18:07:30.133711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:30.177974 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.178965 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:07:30.178965 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_layer'
  
[0m18:07:30.184964 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:07:30.185964 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: ROLLBACK
[0m18:07:30.186963 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: Close
[0m18:07:30.187964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_bronze_layer, now list_Cafe_rewards_offers_staging)
[0m18:07:30.192965 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:07:30.192965 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: BEGIN
[0m18:07:30.193964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:30.230964 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.231970 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:07:30.231970 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:07:30.237963 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:30.239964 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: ROLLBACK
[0m18:07:30.239964 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: Close
[0m18:07:30.247963 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:30.247963 [debug] [MainThread]: On master: BEGIN
[0m18:07:30.248964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:30.291965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.292965 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:30.292965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:30.305963 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:30.308969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9346feb5-a5c7-41e0-8e48-eb68186745e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D65C74BE0>]}
[0m18:07:30.309967 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:30.310973 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:30.310973 [debug] [MainThread]: On master: BEGIN
[0m18:07:30.311966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.312964 [debug] [MainThread]: On master: COMMIT
[0m18:07:30.312964 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:30.313964 [debug] [MainThread]: On master: COMMIT
[0m18:07:30.313964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:30.314963 [debug] [MainThread]: On master: Close
[0m18:07:30.315964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:30.316975 [info ] [MainThread]: 
[0m18:07:30.371964 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:07:30.371964 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:07:30.375967 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710'
[0m18:07:30.376967 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:07:30.398963 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:07:30.400965 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:07:30.377965 => 18:07:30.399963
[0m18:07:30.400965 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:07:30.419963 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:07:30.420963 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:07:30.421963 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:07:30.421963 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:07:30.464972 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.464972 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:07:30.465964 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:07:30.468001 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:07:30.470000 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:07:30.401965 => 18:07:30.470000
[0m18:07:30.471000 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:07:30.471969 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:07:30.472964 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.10s]
[0m18:07:30.477968 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:07:30.478970 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:07:30.479967 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:07:30.483967 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778)
[0m18:07:30.484967 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:07:30.493967 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:07:30.494970 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:07:30.484967 => 18:07:30.494970
[0m18:07:30.495966 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:07:30.498966 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:07:30.499966 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:07:30.500966 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:07:30.501965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:30.594964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.595977 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:07:30.596964 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Cafe_rewards_offers"."staging"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:07:30.598964 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:07:30.600963 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:07:30.496967 => 18:07:30.599964
[0m18:07:30.600963 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:07:30.601966 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:07:30.602965 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.12s]
[0m18:07:30.604965 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:07:30.605964 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:07:30.605964 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:07:30.608968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321)
[0m18:07:30.610967 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:07:30.617964 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:07:30.618964 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (compile): 18:07:30.610967 => 18:07:30.618964
[0m18:07:30.618964 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:07:30.621963 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:07:30.622964 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:07:30.624965 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:07:30.626965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:30.664964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.665964 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:07:30.666967 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:07:30.668964 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:07:30.671963 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (execute): 18:07:30.619964 => 18:07:30.670963
[0m18:07:30.671963 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:07:30.672964 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:07:30.675967 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
[0m18:07:30.678965 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:07:30.679965 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:07:30.680963 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:07:30.681964 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321, now test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:07:30.681964 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:07:30.686473 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:07:30.687474 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:07:30.682964 => 18:07:30.687474
[0m18:07:30.688474 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:07:30.694475 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:07:30.695474 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:07:30.696474 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:07:30.696474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:30.736473 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.737474 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:07:30.738473 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Cafe_rewards_offers"."staging"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:07:30.740474 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:07:30.743475 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:07:30.688474 => 18:07:30.743475
[0m18:07:30.744474 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:07:30.745474 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:07:30.746474 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m18:07:30.747480 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:07:30.749474 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:30.750473 [debug] [MainThread]: On master: BEGIN
[0m18:07:30.750473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:30.792997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:30.792997 [debug] [MainThread]: On master: COMMIT
[0m18:07:30.793995 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:30.793995 [debug] [MainThread]: On master: COMMIT
[0m18:07:30.794994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:30.795994 [debug] [MainThread]: On master: Close
[0m18:07:30.796994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:30.796994 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_staging' was properly closed.
[0m18:07:30.797996 [debug] [MainThread]: Connection 'test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:07:30.798994 [info ] [MainThread]: 
[0m18:07:30.798994 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m18:07:30.800994 [debug] [MainThread]: Command end result
[0m18:07:30.811994 [info ] [MainThread]: 
[0m18:07:30.812994 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:07:30.813995 [info ] [MainThread]: 
[0m18:07:30.814994 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m18:07:30.815994 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:07:30.815994 [info ] [MainThread]: 
[0m18:07:30.817994 [info ] [MainThread]:   compiled Code at target\compiled\dbt_postgres_demo\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m18:07:30.818994 [info ] [MainThread]: 
[0m18:07:30.818994 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:07:30.820994 [debug] [MainThread]: Command `dbt test` failed at 18:07:30.820994 after 1.72 seconds
[0m18:07:30.820994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D62C123A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D653622E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D65D55190>]}
[0m18:07:30.821993 [debug] [MainThread]: Flushing usage events
[0m18:08:36.774351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAE712D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB0E291F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB0E29C10>]}


============================== 18:08:36.779353 | 8004ed96-538f-4ca7-aa71-030881a0d426 ==============================
[0m18:08:36.779353 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:08:36.780352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:08:36.966382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8004ed96-538f-4ca7-aa71-030881a0d426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAE048880>]}
[0m18:08:37.039381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8004ed96-538f-4ca7-aa71-030881a0d426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB0E590A0>]}
[0m18:08:37.040382 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m18:08:37.050381 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m18:08:37.128352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:37.129352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:37.135351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8004ed96-538f-4ca7-aa71-030881a0d426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB146A0D0>]}
[0m18:08:37.148351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8004ed96-538f-4ca7-aa71-030881a0d426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB118C040>]}
[0m18:08:37.149351 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m18:08:37.150351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8004ed96-538f-4ca7-aa71-030881a0d426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB118C280>]}
[0m18:08:37.152383 [info ] [MainThread]: 
[0m18:08:37.153335 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:37.155356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_staging'
[0m18:08:37.167380 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:08:37.168380 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: BEGIN
[0m18:08:37.168380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:37.213803 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.213803 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:08:37.214798 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:08:37.221050 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:08:37.222049 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: ROLLBACK
[0m18:08:37.223086 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: Close
[0m18:08:37.225050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_staging, now list_Cafe_rewards_offers_bronze_layer)
[0m18:08:37.230087 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:08:37.231090 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: BEGIN
[0m18:08:37.231090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:37.270282 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.271312 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:08:37.271312 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_layer'
  
[0m18:08:37.279310 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:08:37.280280 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: ROLLBACK
[0m18:08:37.281309 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: Close
[0m18:08:37.287310 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:37.288275 [debug] [MainThread]: On master: BEGIN
[0m18:08:37.288275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:37.327279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.328278 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:37.329275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:37.343274 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:08:37.345274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8004ed96-538f-4ca7-aa71-030881a0d426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB146A4C0>]}
[0m18:08:37.346309 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:37.347274 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:37.347274 [debug] [MainThread]: On master: BEGIN
[0m18:08:37.348275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.349311 [debug] [MainThread]: On master: COMMIT
[0m18:08:37.350275 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:37.350275 [debug] [MainThread]: On master: COMMIT
[0m18:08:37.351274 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:37.351274 [debug] [MainThread]: On master: Close
[0m18:08:37.353285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:37.354278 [info ] [MainThread]: 
[0m18:08:37.358274 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:08:37.359273 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:08:37.362274 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710'
[0m18:08:37.362274 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:08:37.383308 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:08:37.384274 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:08:37.363309 => 18:08:37.383308
[0m18:08:37.385281 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:08:37.400869 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:08:37.401870 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:08:37.402834 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:08:37.403834 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:08:37.442834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.444842 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:08:37.444842 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:08:37.446871 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:08:37.448870 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:08:37.385281 => 18:08:37.448870
[0m18:08:37.449870 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:08:37.450840 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:08:37.451852 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.09s]
[0m18:08:37.453836 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:08:37.454835 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:08:37.455841 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:08:37.456835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778)
[0m18:08:37.457834 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:08:37.463834 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:08:37.464834 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:08:37.457834 => 18:08:37.464834
[0m18:08:37.465835 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:08:37.468834 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:08:37.469834 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:08:37.469834 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:08:37.470834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:37.510836 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.511837 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:08:37.512846 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Cafe_rewards_offers"."staging"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:08:37.514834 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:08:37.516833 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:08:37.465835 => 18:08:37.515834
[0m18:08:37.516833 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:08:37.517834 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:08:37.518834 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
[0m18:08:37.520836 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:08:37.521841 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:08:37.522834 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:08:37.523834 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321)
[0m18:08:37.523834 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:08:37.531833 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:08:37.533848 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (compile): 18:08:37.524834 => 18:08:37.532834
[0m18:08:37.534834 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:08:37.537833 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:08:37.538833 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:08:37.539834 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:08:37.540836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:37.579835 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.580834 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:08:37.581834 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:08:37.583834 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:08:37.585834 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (execute): 18:08:37.534834 => 18:08:37.585834
[0m18:08:37.586834 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:08:37.586834 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:08:37.588836 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m18:08:37.589840 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:08:37.590835 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:08:37.591843 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:08:37.593838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321, now test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:08:37.594836 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:08:37.599833 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:08:37.600834 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:08:37.595836 => 18:08:37.599833
[0m18:08:37.601835 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:08:37.604833 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:08:37.605834 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:08:37.606835 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:08:37.606835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:37.768819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.769820 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:08:37.769820 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Cafe_rewards_offers"."staging"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:08:37.772820 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:08:37.774820 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:08:37.601835 => 18:08:37.773820
[0m18:08:37.774820 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:08:37.775820 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:08:37.778825 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.19s]
[0m18:08:37.780824 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:08:37.781823 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:37.782820 [debug] [MainThread]: On master: BEGIN
[0m18:08:37.783819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:37.822852 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:37.823821 [debug] [MainThread]: On master: COMMIT
[0m18:08:37.824820 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:37.824820 [debug] [MainThread]: On master: COMMIT
[0m18:08:37.825820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:37.826822 [debug] [MainThread]: On master: Close
[0m18:08:37.828822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:37.829823 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_bronze_layer' was properly closed.
[0m18:08:37.829823 [debug] [MainThread]: Connection 'test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:08:37.830821 [info ] [MainThread]: 
[0m18:08:37.831822 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m18:08:37.833821 [debug] [MainThread]: Command end result
[0m18:08:37.842820 [info ] [MainThread]: 
[0m18:08:37.843823 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:08:37.845823 [info ] [MainThread]: 
[0m18:08:37.846820 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m18:08:37.846820 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:08:37.847820 [info ] [MainThread]: 
[0m18:08:37.848820 [info ] [MainThread]:   compiled Code at target\compiled\dbt_postgres_demo\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m18:08:37.849820 [info ] [MainThread]: 
[0m18:08:37.849820 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:08:37.852820 [debug] [MainThread]: Command `dbt test` failed at 18:08:37.852820 after 1.16 seconds
[0m18:08:37.852820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAE712D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB0EC6E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CB118C3A0>]}
[0m18:08:37.853819 [debug] [MainThread]: Flushing usage events
[0m18:08:53.188520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088373DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020885E358E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020885E35B50>]}


============================== 18:08:53.192519 | 22ee0bd8-a688-48ab-897d-00b239ebcc80 ==============================
[0m18:08:53.192519 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:08:53.193520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'debug': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:08:53.380518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088064EE50>]}
[0m18:08:53.452518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208855E4520>]}
[0m18:08:53.454519 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m18:08:53.464518 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m18:08:53.533519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:53.534519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:53.540519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208864AB0D0>]}
[0m18:08:53.569520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088619B040>]}
[0m18:08:53.569520 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m18:08:53.570520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088619B2E0>]}
[0m18:08:53.572520 [info ] [MainThread]: 
[0m18:08:53.574520 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:53.576520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers'
[0m18:08:53.588548 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m18:08:53.588548 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m18:08:53.589551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:53.635550 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:08:53.637520 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m18:08:53.641519 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers"
[0m18:08:53.642520 [debug] [ThreadPool]: On list_Cafe_rewards_offers: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers"} */

    select distinct nspname from pg_namespace
  
[0m18:08:53.642520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:53.683562 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:08:53.684550 [debug] [ThreadPool]: On list_Cafe_rewards_offers: Close
[0m18:08:53.687520 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_bronze_layer'
[0m18:08:53.695522 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:08:53.696550 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: BEGIN
[0m18:08:53.697535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:53.734551 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:08:53.735520 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:08:53.736530 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_layer'
  
[0m18:08:53.741550 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:08:53.744521 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: ROLLBACK
[0m18:08:53.745520 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: Close
[0m18:08:53.747520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_bronze_layer, now list_Cafe_rewards_offers_staging)
[0m18:08:53.750549 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:08:53.750549 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: BEGIN
[0m18:08:53.751552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:53.790521 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:08:53.791520 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:08:53.791520 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:08:53.798550 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:08:53.800520 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: ROLLBACK
[0m18:08:53.801529 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: Close
[0m18:08:53.807549 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:53.807549 [debug] [MainThread]: On master: BEGIN
[0m18:08:53.808551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:53.845525 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:53.846519 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:53.846519 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:53.860532 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:08:53.862521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208864AB3D0>]}
[0m18:08:53.863522 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:53.864520 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:53.864520 [debug] [MainThread]: On master: BEGIN
[0m18:08:53.865551 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:53.866533 [debug] [MainThread]: On master: COMMIT
[0m18:08:53.866533 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:53.867519 [debug] [MainThread]: On master: COMMIT
[0m18:08:53.867519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:53.868519 [debug] [MainThread]: On master: Close
[0m18:08:53.869530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:53.871522 [info ] [MainThread]: 
[0m18:08:53.874519 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m18:08:53.875521 [info ] [Thread-1  ]: 1 of 3 START sql table model staging.my_first_dbt_model ........................ [RUN]
[0m18:08:53.877522 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m18:08:53.878522 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m18:08:53.887550 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:08:53.888532 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 18:08:53.879535 => 18:08:53.887550
[0m18:08:53.889522 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m18:08:53.932549 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:08:53.933539 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:08:53.934520 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: BEGIN
[0m18:08:53.935520 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:08:53.972550 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:53.973551 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:08:53.974543 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */

  
    

  create  table "Cafe_rewards_offers"."staging"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select 2 as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:08:53.979522 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m18:08:53.987519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:08:53.988520 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."staging"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:08:53.989521 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:53.993553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:08:53.994523 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
alter table "Cafe_rewards_offers"."staging"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:08:53.996521 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:54.017550 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m18:08:54.018533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:08:54.018533 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: COMMIT
[0m18:08:54.020550 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:08:54.028522 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."staging"."my_first_dbt_model__dbt_backup"
[0m18:08:54.033550 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:08:54.034524 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_first_dbt_model"} */
drop table if exists "Cafe_rewards_offers"."staging"."my_first_dbt_model__dbt_backup" cascade
[0m18:08:54.037552 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:08:54.039550 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 18:08:53.889522 => 18:08:54.038521
[0m18:08:54.039550 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_first_dbt_model: Close
[0m18:08:54.041520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088651CB20>]}
[0m18:08:54.042536 [info ] [Thread-1  ]: 1 of 3 OK created sql table model staging.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.16s]
[0m18:08:54.044523 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m18:08:54.045525 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:08:54.047521 [info ] [Thread-1  ]: 2 of 3 START sql view model bronze_layer.postgress__customers_as_c ............. [RUN]
[0m18:08:54.048520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m18:08:54.049527 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:08:54.052519 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:08:54.053520 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 18:08:54.049527 => 18:08:54.053520
[0m18:08:54.054520 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:08:54.074550 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:08:54.075554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:08:54.077523 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: BEGIN
[0m18:08:54.078524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:54.117558 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:54.118522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:08:54.118522 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */

  create view "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c__dbt_tmp"
    
    
  as (
    WITH source_customer AS (
    SELECT * FROM "Cafe_rewards_offers"."public"."customers"
)
, final AS (
    SELECT * FROM source_customer
    limit 10
)

SELECT * FROM final
union all
select '1', '22:22:22', 'f', 3, 4
  );
[0m18:08:54.124550 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:08:54.129519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:08:54.130519 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c" rename to "postgress__customers_as_c__dbt_backup"
[0m18:08:54.131532 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:54.136550 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:08:54.136550 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
alter table "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c__dbt_tmp" rename to "postgress__customers_as_c"
[0m18:08:54.137549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:54.139550 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m18:08:54.140549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:08:54.141533 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: COMMIT
[0m18:08:54.142552 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:08:54.147549 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c__dbt_backup"
[0m18:08:54.150549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:08:54.151521 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.postgress__customers_as_c"} */
drop view if exists "Cafe_rewards_offers"."bronze_layer"."postgress__customers_as_c__dbt_backup" cascade
[0m18:08:54.152550 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:08:54.154550 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 18:08:54.054520 => 18:08:54.154550
[0m18:08:54.155520 [debug] [Thread-1  ]: On model.dbt_postgres_demo.postgress__customers_as_c: Close
[0m18:08:54.156521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208865C78B0>]}
[0m18:08:54.157520 [info ] [Thread-1  ]: 2 of 3 OK created sql view model bronze_layer.postgress__customers_as_c ........ [[32mCREATE VIEW[0m in 0.11s]
[0m18:08:54.159521 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:08:54.161522 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m18:08:54.162522 [info ] [Thread-1  ]: 3 of 3 START sql view model staging.my_second_dbt_model ........................ [RUN]
[0m18:08:54.163520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m18:08:54.164521 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m18:08:54.167542 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:08:54.168520 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 18:08:54.164521 => 18:08:54.168520
[0m18:08:54.169519 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m18:08:54.173542 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:08:54.174545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:08:54.175520 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: BEGIN
[0m18:08:54.176519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:54.216552 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:54.216552 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:08:54.217551 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */

  create view "Cafe_rewards_offers"."staging"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id = 1
  );
[0m18:08:54.221542 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:08:54.225552 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:08:54.226528 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
alter table "Cafe_rewards_offers"."staging"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:08:54.228523 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:54.230550 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m18:08:54.231553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:08:54.231553 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: COMMIT
[0m18:08:54.233521 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:08:54.236519 [debug] [Thread-1  ]: Applying DROP to: "Cafe_rewards_offers"."staging"."my_second_dbt_model__dbt_backup"
[0m18:08:54.237534 [debug] [Thread-1  ]: Using postgres connection "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:08:54.238549 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbt_postgres_demo.my_second_dbt_model"} */
drop view if exists "Cafe_rewards_offers"."staging"."my_second_dbt_model__dbt_backup" cascade
[0m18:08:54.239521 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:08:54.240549 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 18:08:54.169519 => 18:08:54.240549
[0m18:08:54.241551 [debug] [Thread-1  ]: On model.dbt_postgres_demo.my_second_dbt_model: Close
[0m18:08:54.243521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ee0bd8-a688-48ab-897d-00b239ebcc80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208865D43A0>]}
[0m18:08:54.245521 [info ] [Thread-1  ]: 3 of 3 OK created sql view model staging.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:08:54.246534 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m18:08:54.248519 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:54.249549 [debug] [MainThread]: On master: BEGIN
[0m18:08:54.249549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:54.289520 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:54.289520 [debug] [MainThread]: On master: COMMIT
[0m18:08:54.290521 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:54.290521 [debug] [MainThread]: On master: COMMIT
[0m18:08:54.291520 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:54.292520 [debug] [MainThread]: On master: Close
[0m18:08:54.293521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:54.294524 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers' was properly closed.
[0m18:08:54.295523 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_staging' was properly closed.
[0m18:08:54.295523 [debug] [MainThread]: Connection 'model.dbt_postgres_demo.my_second_dbt_model' was properly closed.
[0m18:08:54.296524 [info ] [MainThread]: 
[0m18:08:54.297519 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m18:08:54.299543 [debug] [MainThread]: Command end result
[0m18:08:54.308542 [info ] [MainThread]: 
[0m18:08:54.310522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:54.311523 [info ] [MainThread]: 
[0m18:08:54.312523 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:08:54.313544 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:54.313544 after 1.20 seconds
[0m18:08:54.314521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088373DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208855E4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208865F0F40>]}
[0m18:08:54.315521 [debug] [MainThread]: Flushing usage events
[0m18:09:02.855280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019DB922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019E5BF580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A02C8730>]}


============================== 18:09:02.859277 | 05ebd945-2603-418e-8bc4-4760bc010808 ==============================
[0m18:09:02.859277 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:09:02.861279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:09:03.050829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05ebd945-2603-418e-8bc4-4760bc010808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019E5BF580>]}
[0m18:09:03.123829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05ebd945-2603-418e-8bc4-4760bc010808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A0346850>]}
[0m18:09:03.124829 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m18:09:03.134829 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m18:09:03.205829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:03.205829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:03.213834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05ebd945-2603-418e-8bc4-4760bc010808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A08EA0D0>]}
[0m18:09:03.225793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05ebd945-2603-418e-8bc4-4760bc010808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A080C160>]}
[0m18:09:03.226793 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m18:09:03.228797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ebd945-2603-418e-8bc4-4760bc010808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A080C2E0>]}
[0m18:09:03.230801 [info ] [MainThread]: 
[0m18:09:03.232801 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:03.233801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_bronze_layer'
[0m18:09:03.246830 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:09:03.247796 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: BEGIN
[0m18:09:03.247796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:03.297794 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.297794 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:09:03.298793 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_layer'
  
[0m18:09:03.304793 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:09:03.305801 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: ROLLBACK
[0m18:09:03.306834 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: Close
[0m18:09:03.308794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_bronze_layer, now list_Cafe_rewards_offers_staging)
[0m18:09:03.312806 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:09:03.313793 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: BEGIN
[0m18:09:03.313793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:03.352793 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.352793 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:09:03.353800 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:09:03.359828 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:09:03.362830 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: ROLLBACK
[0m18:09:03.363794 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: Close
[0m18:09:03.369831 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:03.369831 [debug] [MainThread]: On master: BEGIN
[0m18:09:03.370829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:03.409792 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.410794 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:03.411796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:03.425835 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:09:03.428795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ebd945-2603-418e-8bc4-4760bc010808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A08EA2E0>]}
[0m18:09:03.429807 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:03.430793 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:03.430793 [debug] [MainThread]: On master: BEGIN
[0m18:09:03.431793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.432796 [debug] [MainThread]: On master: COMMIT
[0m18:09:03.432796 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:03.433831 [debug] [MainThread]: On master: COMMIT
[0m18:09:03.433831 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:03.434793 [debug] [MainThread]: On master: Close
[0m18:09:03.435793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:03.436806 [info ] [MainThread]: 
[0m18:09:03.440793 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:09:03.441829 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:09:03.442799 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710'
[0m18:09:03.444797 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:09:03.463793 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:09:03.464793 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:09:03.445795 => 18:09:03.464793
[0m18:09:03.465794 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:09:03.481823 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:09:03.483793 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:09:03.483793 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:09:03.484808 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:09:03.524793 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.525794 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:09:03.525794 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:09:03.528802 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:09:03.531828 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:09:03.466793 => 18:09:03.530829
[0m18:09:03.531828 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:09:03.532828 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:09:03.534795 [info ] [Thread-1  ]: 1 of 4 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.09s]
[0m18:09:03.536794 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:09:03.536794 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:09:03.537829 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:09:03.538793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778)
[0m18:09:03.539819 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:09:03.545799 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:09:03.547152 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:09:03.539819 => 18:09:03.546814
[0m18:09:03.547801 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:09:03.550816 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:09:03.551832 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:09:03.552808 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:09:03.553794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:09:03.592792 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.593800 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:09:03.594796 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Cafe_rewards_offers"."staging"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:09:03.596794 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:09:03.598829 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:09:03.547801 => 18:09:03.598829
[0m18:09:03.599828 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:09:03.600793 [debug] [Thread-1  ]: On test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:09:03.601793 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
[0m18:09:03.603802 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:09:03.604793 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:09:03.604793 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:09:03.605800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321)
[0m18:09:03.606832 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:09:03.615793 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:09:03.616793 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (compile): 18:09:03.607804 => 18:09:03.616793
[0m18:09:03.617793 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:09:03.620793 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:09:03.621793 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:09:03.622794 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:09:03.623793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:09:03.662796 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.663794 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:09:03.664793 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Cafe_rewards_offers"."staging"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:09:03.666793 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:09:03.668792 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (execute): 18:09:03.617793 => 18:09:03.667793
[0m18:09:03.668792 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:09:03.669793 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:09:03.670793 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m18:09:03.672794 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:09:03.673793 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:09:03.673793 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:09:03.675793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321, now test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:09:03.675793 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:09:03.681793 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:09:03.682793 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:09:03.676793 => 18:09:03.682793
[0m18:09:03.683793 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:09:03.686792 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:09:03.687793 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:09:03.687793 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:09:03.688802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:09:03.728796 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.729797 [debug] [Thread-1  ]: Using postgres connection "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:09:03.730795 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Cafe_rewards_offers"."staging"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:09:03.733798 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m18:09:03.735794 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:09:03.683793 => 18:09:03.735794
[0m18:09:03.736793 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:09:03.737800 [debug] [Thread-1  ]: On test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:09:03.738793 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m18:09:03.740794 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:09:03.741794 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:03.742793 [debug] [MainThread]: On master: BEGIN
[0m18:09:03.743793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:03.783793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:03.784793 [debug] [MainThread]: On master: COMMIT
[0m18:09:03.785793 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:03.785793 [debug] [MainThread]: On master: COMMIT
[0m18:09:03.786813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:03.786813 [debug] [MainThread]: On master: Close
[0m18:09:03.788794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:03.788794 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_staging' was properly closed.
[0m18:09:03.789795 [debug] [MainThread]: Connection 'test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:09:03.790806 [info ] [MainThread]: 
[0m18:09:03.791793 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m18:09:03.792793 [debug] [MainThread]: Command end result
[0m18:09:03.803807 [info ] [MainThread]: 
[0m18:09:03.804793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:03.804793 [info ] [MainThread]: 
[0m18:09:03.805792 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:09:03.806793 [debug] [MainThread]: Command `dbt test` succeeded at 18:09:03.806793 after 1.03 seconds
[0m18:09:03.807793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019DB922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A03F1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201A027E790>]}
[0m18:09:03.808804 [debug] [MainThread]: Flushing usage events
[0m18:21:07.432153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228653922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022865DBD400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867AB7D00>]}


============================== 18:21:07.436152 | 4efa95e3-7029-4e15-8d3c-863739bfaccb ==============================
[0m18:21:07.436152 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:21:07.440157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:21:07.596701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4efa95e3-7029-4e15-8d3c-863739bfaccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228622EEF10>]}
[0m18:21:07.598700 [debug] [MainThread]: Set downloads directory='C:\Users\PNam\AppData\Local\Temp\dbt-downloads-pq72abnj'
[0m18:21:07.599700 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:21:07.836707 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:21:07.839708 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:21:08.181700 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:21:08.192700 [info ] [MainThread]: Updating lock file in file path: E:\ChuyenMon\Nam_learn_dbt\dbt_postgres/package-lock.yml
[0m18:21:08.201700 [debug] [MainThread]: Set downloads directory='C:\Users\PNam\AppData\Local\Temp\dbt-downloads-7wv3e2l9'
[0m18:21:08.207703 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:21:09.191899 [info ] [MainThread]: Installed from version 1.2.0
[0m18:21:09.192900 [info ] [MainThread]: Up to date!
[0m18:21:09.193902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4efa95e3-7029-4e15-8d3c-863739bfaccb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867A905E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867AE5340>]}
[0m18:21:09.195900 [debug] [MainThread]: Command `dbt deps` succeeded at 18:21:09.195900 after 1.86 seconds
[0m18:21:09.196903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228653922E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867BB3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022867A7DA30>]}
[0m18:21:09.197902 [debug] [MainThread]: Flushing usage events
[0m18:24:32.563724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53EEDF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5413A4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5413A4B50>]}


============================== 18:24:32.567687 | dbbfbe44-639e-4f95-9351-c4f2ad2b19c0 ==============================
[0m18:24:32.567687 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:24:32.568696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'fail_fast': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:32.762728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbbfbe44-639e-4f95-9351-c4f2ad2b19c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53E3D8970>]}
[0m18:24:32.836724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbbfbe44-639e-4f95-9351-c4f2ad2b19c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A541597700>]}
[0m18:24:32.837699 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m18:24:32.843687 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found more than one package with the name "dbt_postgres" included in this project. Package names must be unique in a project. Please rename one of these packages.
[0m18:24:32.846688 [debug] [MainThread]: Command `dbt docs generate` failed at 18:24:32.846688 after 0.36 seconds
[0m18:24:32.847688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A53EEDF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54160FAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5415F0550>]}
[0m18:24:32.848687 [debug] [MainThread]: Flushing usage events
[0m18:25:58.950014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2292123A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22B910400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22B910C10>]}


============================== 18:25:58.954015 | d70b2a58-1b8d-4748-ac22-35c9360baaba ==============================
[0m18:25:58.954015 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:25:58.955016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m18:25:59.131017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd70b2a58-1b8d-4748-ac22-35c9360baaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22B938580>]}
[0m18:25:59.200052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd70b2a58-1b8d-4748-ac22-35c9360baaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22BAEBEB0>]}
[0m18:25:59.201051 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m18:25:59.222270 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m18:25:59.232271 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:25:59.233251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd70b2a58-1b8d-4748-ac22-35c9360baaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22BB60280>]}
[0m18:26:01.019605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd70b2a58-1b8d-4748-ac22-35c9360baaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22C59B0D0>]}
[0m18:26:01.021576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd70b2a58-1b8d-4748-ac22-35c9360baaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22C1BD5B0>]}
[0m18:26:01.022596 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 518 macros, 0 groups, 0 semantic models
[0m18:26:01.023578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd70b2a58-1b8d-4748-ac22-35c9360baaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22BE5BCD0>]}
[0m18:26:01.025605 [info ] [MainThread]: 
[0m18:26:01.026577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:26:01.028606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_bronze_layer'
[0m18:26:01.039614 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:26:01.040613 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: BEGIN
[0m18:26:01.041586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:01.083823 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:01.084824 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:26:01.084824 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_layer'
  
[0m18:26:01.091412 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:01.093414 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: ROLLBACK
[0m18:26:01.094421 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: Close
[0m18:26:01.095414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_bronze_layer, now list_Cafe_rewards_offers_staging)
[0m18:26:01.099449 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:26:01.100425 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: BEGIN
[0m18:26:01.101413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:01.137228 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:01.138221 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:26:01.138221 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:26:01.144668 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:26:01.145671 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: ROLLBACK
[0m18:26:01.146719 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: Close
[0m18:26:01.153702 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:01.154667 [debug] [MainThread]: On master: BEGIN
[0m18:26:01.154667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:01.192668 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:01.193703 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:01.194698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:26:01.208666 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:26:01.210694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd70b2a58-1b8d-4748-ac22-35c9360baaba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22BB7EBE0>]}
[0m18:26:01.211667 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:01.212667 [debug] [MainThread]: On master: Close
[0m18:26:01.213669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:26:01.214670 [info ] [MainThread]: 
[0m18:26:01.219674 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m18:26:01.220674 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m18:26:01.220674 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m18:26:01.229702 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:26:01.231670 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 18:26:01.221674 => 18:26:01.230702
[0m18:26:01.232669 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m18:26:01.233678 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 18:26:01.232669 => 18:26:01.232669
[0m18:26:01.234674 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m18:26:01.235668 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:26:01.236674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m18:26:01.237668 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:26:01.241702 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:26:01.242667 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 18:26:01.237668 => 18:26:01.242667
[0m18:26:01.243674 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:26:01.244674 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 18:26:01.243674 => 18:26:01.243674
[0m18:26:01.245703 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:26:01.246671 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m18:26:01.247672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m18:26:01.248676 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m18:26:01.251703 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:26:01.253667 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 18:26:01.249669 => 18:26:01.252702
[0m18:26:01.253667 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m18:26:01.254702 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 18:26:01.254702 => 18:26:01.254702
[0m18:26:01.255667 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m18:26:01.256700 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:26:01.257673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_second_dbt_model, now test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:26:01.258682 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:26:01.270702 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:26:01.271703 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:26:01.258682 => 18:26:01.271703
[0m18:26:01.272667 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:26:01.273705 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:26:01.273705 => 18:26:01.273705
[0m18:26:01.274674 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:26:01.275668 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:26:01.276675 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321)
[0m18:26:01.277666 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:26:01.284705 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:26:01.285671 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (compile): 18:26:01.277666 => 18:26:01.285671
[0m18:26:01.286667 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:26:01.287706 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (execute): 18:26:01.287706 => 18:26:01.287706
[0m18:26:01.288667 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:26:01.289705 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:26:01.290667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321, now test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778)
[0m18:26:01.291667 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:26:01.296697 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:26:01.298668 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:26:01.291667 => 18:26:01.297669
[0m18:26:01.298668 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:26:01.299667 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:26:01.299667 => 18:26:01.299667
[0m18:26:01.300667 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:26:01.301667 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:26:01.302674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:26:01.302674 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:26:01.307704 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:26:01.308694 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:26:01.303675 => 18:26:01.308694
[0m18:26:01.309667 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:26:01.310679 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:26:01.310679 => 18:26:01.310679
[0m18:26:01.311666 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:26:01.313668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:01.314669 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_staging' was properly closed.
[0m18:26:01.314669 [debug] [MainThread]: Connection 'test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:26:01.316704 [debug] [MainThread]: Command end result
[0m18:26:01.584668 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:26:01.585668 [info ] [MainThread]: Building catalog
[0m18:26:01.588471 [debug] [ThreadPool]: Acquiring new postgres connection 'Cafe_rewards_offers.information_schema'
[0m18:26:01.596478 [debug] [ThreadPool]: Using postgres connection "Cafe_rewards_offers.information_schema"
[0m18:26:01.597484 [debug] [ThreadPool]: On Cafe_rewards_offers.information_schema: BEGIN
[0m18:26:01.598480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:01.634246 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:01.635254 [debug] [ThreadPool]: Using postgres connection "Cafe_rewards_offers.information_schema"
[0m18:26:01.636216 [debug] [ThreadPool]: On Cafe_rewards_offers.information_schema: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "Cafe_rewards_offers.information_schema"} */

    
    

    select
        'Cafe_rewards_offers' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('my_second_dbt_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('bronze_layer') and
           upper(tbl.relname) = upper('postgress__customers_as_c')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('my_first_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:26:01.644915 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m18:26:01.649917 [debug] [ThreadPool]: On Cafe_rewards_offers.information_schema: ROLLBACK
[0m18:26:01.650925 [debug] [ThreadPool]: On Cafe_rewards_offers.information_schema: Close
[0m18:26:01.667917 [info ] [MainThread]: Catalog written to E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\target\catalog.json
[0m18:26:01.669915 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:26:01.669915 after 2.80 seconds
[0m18:26:01.670916 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:26:01.671916 [debug] [MainThread]: Connection 'Cafe_rewards_offers.information_schema' was properly closed.
[0m18:26:01.671916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2292123A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22BAEBEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22C1BD5B0>]}
[0m18:26:01.672946 [debug] [MainThread]: Flushing usage events
[0m18:50:17.721951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094C812D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094ECD2EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094ECD26D0>]}


============================== 18:50:17.724981 | c07ac26c-c9c2-410d-ad94-141cacea51e9 ==============================
[0m18:50:17.724981 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:50:17.726945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'version_check': 'True', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:50:17.902289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c07ac26c-c9c2-410d-ad94-141cacea51e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094ECE40D0>]}
[0m18:50:17.971289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c07ac26c-c9c2-410d-ad94-141cacea51e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094ED287F0>]}
[0m18:50:17.973251 [info ] [MainThread]: Registered adapter: postgres=1.7.18
[0m18:50:17.987289 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m18:50:18.083261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:18.084290 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:18.090288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c07ac26c-c9c2-410d-ad94-141cacea51e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F3DA0D0>]}
[0m18:50:18.092264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c07ac26c-c9c2-410d-ad94-141cacea51e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F2DF730>]}
[0m18:50:18.093252 [info ] [MainThread]: Found 3 models, 4 tests, 1 source, 0 exposures, 0 metrics, 518 macros, 0 groups, 0 semantic models
[0m18:50:18.094287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c07ac26c-c9c2-410d-ad94-141cacea51e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F2DF7C0>]}
[0m18:50:18.096288 [info ] [MainThread]: 
[0m18:50:18.097252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:18.099252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Cafe_rewards_offers_bronze_layer'
[0m18:50:18.111258 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:50:18.112308 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: BEGIN
[0m18:50:18.112308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:18.155283 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:18.156258 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_bronze_layer"
[0m18:50:18.157267 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_bronze_layer"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_layer'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_layer'
  
[0m18:50:18.163251 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:50:18.164259 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: ROLLBACK
[0m18:50:18.165250 [debug] [ThreadPool]: On list_Cafe_rewards_offers_bronze_layer: Close
[0m18:50:18.167256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Cafe_rewards_offers_bronze_layer, now list_Cafe_rewards_offers_staging)
[0m18:50:18.170251 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:50:18.171287 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: BEGIN
[0m18:50:18.172303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:18.209288 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:18.210288 [debug] [ThreadPool]: Using postgres connection "list_Cafe_rewards_offers_staging"
[0m18:50:18.211268 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_Cafe_rewards_offers_staging"} */
select
      'Cafe_rewards_offers' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'Cafe_rewards_offers' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m18:50:18.217253 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:50:18.219288 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: ROLLBACK
[0m18:50:18.220259 [debug] [ThreadPool]: On list_Cafe_rewards_offers_staging: Close
[0m18:50:18.226288 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:18.226288 [debug] [MainThread]: On master: BEGIN
[0m18:50:18.227258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:18.264293 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:18.265251 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:18.266256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:18.280265 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:50:18.282252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c07ac26c-c9c2-410d-ad94-141cacea51e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F2DF5E0>]}
[0m18:50:18.283253 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:18.284267 [debug] [MainThread]: On master: Close
[0m18:50:18.285252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:18.286254 [info ] [MainThread]: 
[0m18:50:18.290259 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_first_dbt_model
[0m18:50:18.291251 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_postgres_demo.my_first_dbt_model'
[0m18:50:18.292251 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_first_dbt_model
[0m18:50:18.301288 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_first_dbt_model"
[0m18:50:18.302305 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (compile): 18:50:18.292251 => 18:50:18.302305
[0m18:50:18.303251 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_first_dbt_model
[0m18:50:18.304251 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_first_dbt_model (execute): 18:50:18.304251 => 18:50:18.304251
[0m18:50:18.305268 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_first_dbt_model
[0m18:50:18.306278 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:50:18.307259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_first_dbt_model, now model.dbt_postgres_demo.postgress__customers_as_c)
[0m18:50:18.308250 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:50:18.311291 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.postgress__customers_as_c"
[0m18:50:18.312251 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (compile): 18:50:18.308250 => 18:50:18.312251
[0m18:50:18.313250 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:50:18.314251 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.postgress__customers_as_c (execute): 18:50:18.314251 => 18:50:18.314251
[0m18:50:18.316255 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.postgress__customers_as_c
[0m18:50:18.317252 [debug] [Thread-1  ]: Began running node model.dbt_postgres_demo.my_second_dbt_model
[0m18:50:18.318259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.postgress__customers_as_c, now model.dbt_postgres_demo.my_second_dbt_model)
[0m18:50:18.318259 [debug] [Thread-1  ]: Began compiling node model.dbt_postgres_demo.my_second_dbt_model
[0m18:50:18.322287 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_postgres_demo.my_second_dbt_model"
[0m18:50:18.323258 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (compile): 18:50:18.319261 => 18:50:18.323258
[0m18:50:18.324259 [debug] [Thread-1  ]: Began executing node model.dbt_postgres_demo.my_second_dbt_model
[0m18:50:18.324259 [debug] [Thread-1  ]: Timing info for model.dbt_postgres_demo.my_second_dbt_model (execute): 18:50:18.324259 => 18:50:18.324259
[0m18:50:18.326288 [debug] [Thread-1  ]: Finished running node model.dbt_postgres_demo.my_second_dbt_model
[0m18:50:18.327259 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:50:18.328283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_postgres_demo.my_second_dbt_model, now test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:50:18.328283 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:50:18.342287 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:50:18.343254 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:50:18.329283 => 18:50:18.343254
[0m18:50:18.344271 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:50:18.345251 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:50:18.344271 => 18:50:18.344271
[0m18:50:18.346288 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:50:18.346288 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:50:18.347288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321)
[0m18:50:18.348251 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:50:18.355289 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321"
[0m18:50:18.357252 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (compile): 18:50:18.349253 => 18:50:18.356287
[0m18:50:18.358252 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:50:18.359252 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321 (execute): 18:50:18.358252 => 18:50:18.358252
[0m18:50:18.360251 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321
[0m18:50:18.360251 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:50:18.362251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.unique_my_first_dbt_model_id.16e066b321, now test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778)
[0m18:50:18.362251 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:50:18.367285 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778"
[0m18:50:18.369252 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:50:18.363252 => 18:50:18.368288
[0m18:50:18.369252 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:50:18.370288 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:50:18.370288 => 18:50:18.370288
[0m18:50:18.371260 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778
[0m18:50:18.372288 [debug] [Thread-1  ]: Began running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:50:18.373250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_postgres_demo.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:50:18.374252 [debug] [Thread-1  ]: Began compiling node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:50:18.378262 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:50:18.380251 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:50:18.374252 => 18:50:18.379251
[0m18:50:18.380251 [debug] [Thread-1  ]: Began executing node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:50:18.381252 [debug] [Thread-1  ]: Timing info for test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:50:18.381252 => 18:50:18.381252
[0m18:50:18.383253 [debug] [Thread-1  ]: Finished running node test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493
[0m18:50:18.384265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:18.385289 [debug] [MainThread]: Connection 'list_Cafe_rewards_offers_staging' was properly closed.
[0m18:50:18.386258 [debug] [MainThread]: Connection 'test.dbt_postgres_demo.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:50:18.387288 [debug] [MainThread]: Command end result
[0m18:50:18.404289 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:50:18.404289 [info ] [MainThread]: Building catalog
[0m18:50:18.407250 [debug] [ThreadPool]: Acquiring new postgres connection 'Cafe_rewards_offers.information_schema'
[0m18:50:18.415258 [debug] [ThreadPool]: Using postgres connection "Cafe_rewards_offers.information_schema"
[0m18:50:18.416260 [debug] [ThreadPool]: On Cafe_rewards_offers.information_schema: BEGIN
[0m18:50:18.417259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:18.455258 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:18.456259 [debug] [ThreadPool]: Using postgres connection "Cafe_rewards_offers.information_schema"
[0m18:50:18.456259 [debug] [ThreadPool]: On Cafe_rewards_offers.information_schema: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "Cafe_rewards_offers.information_schema"} */

    
    

    select
        'Cafe_rewards_offers' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('bronze_layer') and
           upper(tbl.relname) = upper('postgress__customers_as_c')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('my_second_dbt_model')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('my_first_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:50:18.463258 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m18:50:18.467261 [debug] [ThreadPool]: On Cafe_rewards_offers.information_schema: ROLLBACK
[0m18:50:18.468257 [debug] [ThreadPool]: On Cafe_rewards_offers.information_schema: Close
[0m18:50:18.481265 [info ] [MainThread]: Catalog written to E:\ChuyenMon\Nam_learn_dbt\dbt_postgres\target\catalog.json
[0m18:50:18.483260 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:50:18.483260 after 0.84 seconds
[0m18:50:18.484260 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:50:18.484260 [debug] [MainThread]: Connection 'Cafe_rewards_offers.information_schema' was properly closed.
[0m18:50:18.485259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094C812D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094ECE40D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094EEFBD60>]}
[0m18:50:18.486257 [debug] [MainThread]: Flushing usage events
[0m18:51:22.389752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002536471DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025367063850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253670636D0>]}


============================== 18:51:22.393750 | 94dd2ca4-385e-4f03-8568-295099bbb15a ==============================
[0m18:51:22.393750 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:51:22.394715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\ChuyenMon\\Nam_learn_dbt\\dbt_postgres\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:22.581754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94dd2ca4-385e-4f03-8568-295099bbb15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253642688E0>]}
[0m18:51:22.654743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94dd2ca4-385e-4f03-8568-295099bbb15a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253671B4700>]}
